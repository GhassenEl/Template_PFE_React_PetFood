<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PetFood TN - Dashboard Client</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      :root {
        /* Nouvelle palette de couleurs - Mode Clair */
        --primary-color: #4361ee;
        --primary-dark: #3a56d4;
        --primary-light: #eef2ff;
        --secondary-color: #06d6a0;
        --accent-color: #ef476f;
        --dark-color: #1a1a2e;
        --light-color: #f8f9fa;
        --gray-color: #6c757d;
        --gray-light: #adb5bd;
        --success-color: #06d6a0;
        --danger-color: #ef476f;
        --warning-color: #ffd166;
        --info-color: #118ab2;
        --purple-color: #7209b7;

        /* Variables design */
        --shadow: 0 8px 24px rgba(67, 97, 238, 0.12);
        --shadow-hover: 0 12px 32px rgba(67, 97, 238, 0.18);
        --radius: 16px;
        --radius-sm: 8px;
        --radius-lg: 24px;
        --gradient: linear-gradient(135deg, #4361ee 0%, #7209b7 100%);
        --gradient-light: linear-gradient(135deg, #eef2ff 0%, #f5f3ff 100%);
        --bg-color: #f8fafc;
        --card-bg: rgba(255, 255, 255, 0.98);
        --text-color: #2d3748;
        --text-light: #718096;
        --sidebar-bg: rgba(255, 255, 255, 0.98);
        --border-color: #e2e8f0;
        --input-bg: #ffffff;
        --table-header-bg: #f1f5f9;
        --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .dark-mode {
        /* Nouvelle palette de couleurs - Mode Sombre */
        --primary-color: #6366f1;
        --primary-dark: #4f46e5;
        --primary-light: rgba(99, 102, 241, 0.15);
        --secondary-color: #10b981;
        --accent-color: #f43f5e;
        --dark-color: #f1f5f9;
        --light-color: #0f172a;
        --gray-color: #94a3b8;
        --gray-light: #475569;
        --success-color: #10b981;
        --danger-color: #f43f5e;
        --warning-color: #f59e0b;
        --info-color: #0ea5e9;
        --purple-color: #8b5cf6;

        /* Variables design mode sombre */
        --shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        --shadow-hover: 0 12px 32px rgba(0, 0, 0, 0.4);
        --gradient: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
        --gradient-light: linear-gradient(
          135deg,
          rgba(99, 102, 241, 0.1) 0%,
          rgba(139, 92, 246, 0.1) 100%
        );
        --bg-color: #0f172a;
        --card-bg: rgba(30, 41, 59, 0.95);
        --text-color: #f1f5f9;
        --text-light: #94a3b8;
        --sidebar-bg: rgba(15, 23, 42, 0.98);
        --border-color: #334155;
        --input-bg: #1e293b;
        --table-header-bg: rgba(99, 102, 241, 0.1);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family:
          "Inter",
          -apple-system,
          BlinkMacSystemFont,
          "Segoe UI",
          Roboto,
          sans-serif;
        transition: var(--transition);
      }

      body {
        background: var(--bg-color);
        color: var(--text-color);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        line-height: 1.6;
        font-weight: 400;
      }

      /* Background décoratif avec pattern moderne */
      .decorative-bg {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background:
          radial-gradient(
            circle at 20% 80%,
            rgba(67, 97, 238, 0.03) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 20%,
            rgba(6, 214, 160, 0.03) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 40% 40%,
            rgba(239, 71, 111, 0.02) 0%,
            transparent 50%
          );
        z-index: -1;
      }

      .dark-mode .decorative-bg {
        background:
          radial-gradient(
            circle at 20% 80%,
            rgba(99, 102, 241, 0.05) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 20%,
            rgba(16, 185, 129, 0.05) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 40% 40%,
            rgba(244, 63, 94, 0.03) 0%,
            transparent 50%
          );
      }

      /* Animation d'entrée */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .container {
        display: flex;
        min-height: 100vh;
        position: relative;
        flex: 1;
        animation: fadeInUp 0.6s ease-out;
      }

      /* ===== DARK MODE TOGGLE ===== */
      .dark-mode-toggle {
        position: fixed;
        top: 24px;
        right: 24px;
        z-index: 1000;
      }

      .toggle-btn {
        width: 64px;
        height: 32px;
        background: var(--gradient);
        border-radius: 16px;
        border: 2px solid var(--primary-light);
        cursor: pointer;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 8px;
        box-shadow: var(--shadow);
      }

      .toggle-btn:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-hover);
      }

      .toggle-btn i {
        color: white;
        font-size: 14px;
        z-index: 1;
        transition: var(--transition);
      }

      .toggle-slider {
        position: absolute;
        top: 4px;
        left: 4px;
        width: 24px;
        height: 24px;
        background: white;
        border-radius: 50%;
        transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      }

      .dark-mode .toggle-slider {
        transform: translateX(32px);
      }

      /* ===== SIDEBAR MODERNISÉ ===== */
      .sidebar {
        width: 280px;
        background: var(--sidebar-bg);
        backdrop-filter: blur(20px);
        padding: 24px;
        position: fixed;
        height: 100vh;
        overflow-y: auto;
        border-right: 1px solid var(--border-color);
        z-index: 100;
        box-shadow: var(--shadow);
      }

      .logo {
        display: flex;
        align-items: center;
        margin-bottom: 32px;
        padding-bottom: 20px;
        border-bottom: 2px solid var(--primary-light);
      }

      .logo-icon {
        width: 48px;
        height: 48px;
        background: var(--gradient);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
        margin-right: 12px;
        box-shadow: 0 4px 12px rgba(67, 97, 238, 0.3);
      }

      .logo-text h1 {
        color: var(--primary-color);
        font-size: 20px;
        font-weight: 700;
        letter-spacing: -0.5px;
      }

      .logo-text .tagline {
        color: var(--text-light);
        font-size: 12px;
        font-weight: 500;
        margin-top: 4px;
      }

      .nav-menu {
        list-style: none;
        margin-top: 16px;
      }

      .nav-item {
        margin-bottom: 8px;
      }

      .nav-link {
        display: flex;
        align-items: center;
        padding: 14px 16px;
        color: var(--text-light);
        text-decoration: none;
        border-radius: var(--radius-sm);
        transition: var(--transition);
        border: 2px solid transparent;
        font-weight: 500;
        position: relative;
      }

      .nav-link:hover {
        background: var(--primary-light);
        color: var(--primary-color);
        transform: translateX(4px);
      }

      .nav-link.active {
        background: var(--gradient);
        color: white;
        box-shadow: 0 4px 12px rgba(67, 97, 238, 0.3);
        border-color: var(--primary-color);
      }

      .nav-link.active::before {
        content: "";
        position: absolute;
        left: -8px;
        top: 50%;
        transform: translateY(-50%);
        width: 4px;
        height: 60%;
        background: var(--primary-color);
        border-radius: 4px;
      }

      .nav-link i {
        width: 20px;
        margin-right: 12px;
        text-align: center;
        font-size: 16px;
      }

      .badge {
        background: var(--accent-color);
        color: white;
        font-size: 11px;
        padding: 4px 8px;
        border-radius: 20px;
        margin-left: auto;
        font-weight: 600;
        min-width: 24px;
        text-align: center;
      }

      .back-to-site {
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--gradient);
        color: white;
        text-align: center;
        padding: 14px;
        border-radius: var(--radius-sm);
        text-decoration: none;
        margin-top: 32px;
        font-weight: 600;
        transition: var(--transition);
        border: 2px solid var(--primary-color);
        gap: 8px;
      }

      .back-to-site:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-hover);
        background: var(--primary-dark);
      }

      /* ===== MAIN CONTENT ===== */
      .main-content {
        flex: 1;
        margin-left: 280px;
        padding: 32px;
        z-index: 1;
        display: flex;
        flex-direction: column;
      }

      /* HEADER MODERNISÉ */
      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 32px;
        padding: 24px;
        background: var(--card-bg);
        backdrop-filter: blur(20px);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        border: 1px solid var(--border-color);
        animation: fadeInUp 0.4s ease-out;
      }

      .welcome h2 {
        color: var(--primary-color);
        font-size: 24px;
        font-weight: 700;
        margin-bottom: 8px;
        background: var(--gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .welcome p {
        color: var(--text-light);
        font-size: 14px;
      }

      .header-actions {
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .user-info {
        display: flex;
        align-items: center;
        background: var(--gradient-light);
        padding: 8px 16px;
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        border: 1px solid var(--border-color);
        transition: var(--transition);
      }

      .user-info:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-hover);
      }

      .user-avatar {
        width: 48px;
        height: 48px;
        border-radius: 12px;
        margin-right: 12px;
        background: var(--gradient);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 20px;
        box-shadow: 0 4px 12px rgba(67, 97, 238, 0.3);
      }

      .user-details {
        display: flex;
        flex-direction: column;
      }

      .user-name {
        color: var(--primary-color);
        font-weight: 600;
        font-size: 14px;
      }

      .user-role {
        color: var(--text-light);
        font-size: 12px;
        font-weight: 500;
      }

      /* ===== COMPTEUR EN TEMPS RÉEL ===== */
      .counter-container {
        background: var(--card-bg);
        backdrop-filter: blur(20px);
        border-radius: var(--radius);
        padding: 24px;
        margin-bottom: 32px;
        box-shadow: var(--shadow);
        border: 1px solid var(--border-color);
        animation: fadeInUp 0.5s ease-out;
      }

      .counter-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 24px;
        padding-bottom: 16px;
        border-bottom: 2px solid var(--primary-light);
      }

      .counter-title {
        font-size: 18px;
        color: var(--primary-color);
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .counter-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 20px;
      }

      .counter-stat {
        text-align: center;
        padding: 20px;
        background: var(--gradient-light);
        border-radius: var(--radius);
        transition: var(--transition);
        border: 1px solid var(--border-color);
        position: relative;
        overflow: hidden;
      }

      .counter-stat:hover {
        transform: translateY(-4px);
        box-shadow: var(--shadow-hover);
        border-color: var(--primary-color);
      }

      .counter-stat::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 4px;
        background: var(--gradient);
      }

      .counter-number {
        font-size: 32px;
        font-weight: 800;
        color: var(--primary-color);
        margin-bottom: 8px;
        font-family:
          "SF Pro Display",
          -apple-system,
          sans-serif;
      }

      .counter-label {
        font-size: 12px;
        color: var(--text-light);
        text-transform: uppercase;
        letter-spacing: 1px;
        font-weight: 600;
        background: transparent;
      }

      /* ===== DASHBOARD CARDS MODERNISÉES ===== */
      .dashboard-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
        gap: 24px;
        margin-bottom: 32px;
      }

      .card {
        background: var(--card-bg);
        backdrop-filter: blur(20px);
        border-radius: var(--radius);
        padding: 24px;
        box-shadow: var(--shadow);
        border: 1px solid var(--border-color);
        transition: var(--transition);
        position: relative;
        overflow: hidden;
        animation: fadeInUp 0.6s ease-out;
      }

      .card:hover {
        transform: translateY(-6px);
        box-shadow: var(--shadow-hover);
        border-color: var(--primary-color);
      }

      .card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 4px;
        background: var(--gradient);
      }

      .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .card-title {
        font-size: 16px;
        color: var(--text-color);
        font-weight: 600;
      }

      .card-icon {
        width: 56px;
        height: 56px;
        border-radius: 12px;
        background: var(--gradient-light);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--primary-color);
        font-size: 24px;
        border: 1px solid var(--border-color);
      }

      .card-value {
        font-size: 36px;
        font-weight: 800;
        color: var(--primary-color);
        margin-bottom: 8px;
        font-family:
          "SF Pro Display",
          -apple-system,
          sans-serif;
      }

      .card-change {
        display: flex;
        align-items: center;
        color: var(--success-color);
        font-weight: 600;
        font-size: 14px;
        gap: 4px;
      }

      .card-change.negative {
        color: var(--danger-color);
      }

      .progress-bar {
        height: 8px;
        background: var(--primary-light);
        border-radius: 4px;
        overflow: hidden;
        margin: 16px 0;
      }

      .progress-fill {
        height: 100%;
        background: var(--gradient);
        border-radius: 4px;
        position: relative;
        overflow: hidden;
      }

      .progress-fill::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.4),
          transparent
        );
        animation: shimmer 2s infinite;
      }

      @keyframes shimmer {
        0% {
          transform: translateX(-100%);
        }
        100% {
          transform: translateX(100%);
        }
      }

      /* ===== SECTIONS MODERNISÉES ===== */
      .section {
        background: var(--card-bg);
        backdrop-filter: blur(20px);
        border-radius: var(--radius);
        padding: 24px;
        box-shadow: var(--shadow);
        margin-bottom: 32px;
        border: 1px solid var(--border-color);
        animation: fadeInUp 0.7s ease-out;
      }

      .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 24px;
        padding-bottom: 16px;
        border-bottom: 2px solid var(--primary-light);
      }

      .section-title {
        font-size: 18px;
        color: var(--text-color);
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .btn {
        padding: 12px 24px;
        border: none;
        border-radius: var(--radius-sm);
        cursor: pointer;
        font-weight: 600;
        transition: var(--transition);
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 14px;
      }

      .btn-primary {
        background: var(--gradient);
        color: white;
        border: 2px solid transparent;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-hover);
        background: var(--primary-dark);
      }

      .btn-secondary {
        background: var(--primary-light);
        color: var(--primary-color);
        border: 2px solid var(--primary-light);
      }

      .btn-secondary:hover {
        background: var(--primary-color);
        color: white;
        border-color: var(--primary-color);
      }

      /* ===== BARRE DE RECHERCHE MODERNISÉE ===== */
      .search-container {
        margin-bottom: 24px;
        display: flex;
        gap: 16px;
        align-items: center;
      }

      .search-box {
        flex: 1;
        position: relative;
      }

      .search-input {
        width: 100%;
        padding: 14px 20px 14px 48px;
        background: var(--input-bg);
        border: 2px solid var(--border-color);
        border-radius: var(--radius-sm);
        font-size: 14px;
        color: var(--text-color);
        transition: var(--transition);
      }

      .search-input:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 4px rgba(67, 97, 238, 0.1);
      }

      .search-icon {
        position: absolute;
        left: 16px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--primary-color);
        z-index: 1;
      }

      .search-options {
        display: flex;
        gap: 8px;
      }

      .search-filter {
        padding: 14px 20px;
        background: var(--input-bg);
        border: 2px solid var(--border-color);
        border-radius: var(--radius-sm);
        color: var(--text-color);
        font-size: 14px;
        cursor: pointer;
        transition: var(--transition);
        font-weight: 500;
      }

      .search-filter:hover {
        border-color: var(--primary-color);
      }

      .search-filter.active {
        background: var(--primary-color);
        color: white;
        border-color: var(--primary-color);
      }

      .clear-search {
        padding: 14px 20px;
        background: var(--primary-light);
        border: 2px solid var(--primary-light);
        border-radius: var(--radius-sm);
        color: var(--primary-color);
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 14px;
      }

      .clear-search:hover {
        background: var(--primary-color);
        color: white;
      }

      .search-results-info {
        margin-bottom: 16px;
        padding: 16px;
        background: var(--gradient-light);
        border-radius: var(--radius-sm);
        display: flex;
        justify-content: space-between;
        align-items: center;
        border: 1px solid var(--border-color);
      }

      .no-results {
        text-align: center;
        padding: 48px 24px;
        color: var(--text-light);
        background: var(--gradient-light);
        border-radius: var(--radius);
        margin-top: 16px;
        border: 2px dashed var(--border-color);
      }

      .no-results i {
        font-size: 48px;
        margin-bottom: 16px;
        color: var(--primary-color);
        opacity: 0.5;
      }

      .no-results h3 {
        color: var(--text-color);
        margin-bottom: 8px;
        font-weight: 600;
      }

      /* ===== TABLES MODERNISÉES ===== */
      .table-container {
        overflow-x: auto;
        border-radius: var(--radius-sm);
        border: 1px solid var(--border-color);
        background: var(--card-bg);
      }

      table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
        min-width: 800px;
      }

      th {
        background: var(--table-header-bg);
        color: var(--primary-color);
        padding: 16px;
        text-align: left;
        font-weight: 600;
        font-size: 14px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        border-bottom: 2px solid var(--primary-light);
      }

      td {
        padding: 16px;
        border-bottom: 1px solid var(--border-color);
        font-size: 14px;
      }

      tr:last-child td {
        border-bottom: none;
      }

      tr:hover {
        background: var(--primary-light);
      }

      /* Status badges modernisés */
      .status {
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        gap: 4px;
        border: 1px solid;
      }

      .status-delivered {
        background: rgba(6, 214, 160, 0.1);
        color: var(--success-color);
        border-color: rgba(6, 214, 160, 0.3);
      }

      .status-pending {
        background: rgba(255, 209, 102, 0.1);
        color: var(--warning-color);
        border-color: rgba(255, 209, 102, 0.3);
      }

      .status-processing {
        background: rgba(67, 97, 238, 0.1);
        color: var(--primary-color);
        border-color: rgba(67, 97, 238, 0.3);
      }

      .action-btn {
        background: var(--primary-light);
        border: none;
        width: 36px;
        height: 36px;
        border-radius: 10px;
        cursor: pointer;
        color: var(--primary-color);
        margin: 0 4px;
        transition: var(--transition);
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }

      .action-btn:hover {
        background: var(--primary-color);
        color: white;
        transform: translateY(-2px);
      }

      /* ===== PAYMENT METHODS ===== */
      .payment-methods-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 20px;
        margin-top: 24px;
      }

      .payment-method-card {
        background: var(--card-bg);
        border-radius: var(--radius);
        padding: 24px;
        text-align: center;
        border: 1px solid var(--border-color);
        transition: var(--transition);
        position: relative;
        overflow: hidden;
      }

      .payment-method-card:hover {
        transform: translateY(-4px);
        border-color: var(--primary-color);
        box-shadow: var(--shadow);
      }

      .payment-method-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 4px;
        background: var(--gradient);
      }

      .payment-icon {
        font-size: 40px;
        margin-bottom: 16px;
        color: var(--primary-color);
      }

      .payment-name {
        font-size: 16px;
        font-weight: 600;
        color: var(--text-color);
        margin-bottom: 8px;
      }

      .payment-desc {
        font-size: 13px;
        color: var(--text-light);
        margin-bottom: 8px;
        line-height: 1.5;
      }

      .payment-method-status {
        font-size: 12px;
        color: var(--success-color);
        margin-top: 8px;
        font-weight: 500;
      }

      /* ===== STARS RATING ===== */
      .rating-stars {
        color: #ffd166;
        font-size: 14px;
      }

      .rating-stars .far {
        color: var(--gray-light);
      }

      .star-rating-input {
        display: flex;
        gap: 8px;
        margin-top: 8px;
      }

      .star-rating-input .star {
        font-size: 28px;
        color: var(--gray-light);
        cursor: pointer;
        transition: var(--transition);
      }

      .star-rating-input .star:hover,
      .star-rating-input .star.active {
        color: #ffd166;
        transform: scale(1.1);
      }

      /* ===== MODALS MODERNISÉS ===== */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(15, 23, 42, 0.8);
        backdrop-filter: blur(10px);
        z-index: 2000;
        align-items: center;
        justify-content: center;
        animation: fadeIn 0.3s;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          backdrop-filter: blur(0);
        }
        to {
          opacity: 1;
          backdrop-filter: blur(10px);
        }
      }

      .modal-content {
        background: var(--card-bg);
        border-radius: var(--radius);
        padding: 32px;
        width: 90%;
        max-width: 600px;
        max-height: 80vh;
        overflow-y: auto;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        border: 1px solid var(--border-color);
        animation: fadeInUp 0.3s;
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 24px;
        padding-bottom: 16px;
        border-bottom: 2px solid var(--primary-light);
      }

      .modal-title {
        color: var(--primary-color);
        font-size: 20px;
        font-weight: 600;
      }

      .close-modal {
        background: none;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: var(--text-light);
        transition: var(--transition);
        width: 40px;
        height: 40px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .close-modal:hover {
        color: var(--primary-color);
        background: var(--primary-light);
      }

      .form-group {
        margin-bottom: 20px;
      }

      label {
        display: block;
        margin-bottom: 8px;
        color: var(--text-color);
        font-weight: 600;
        font-size: 14px;
      }

      input,
      select,
      textarea {
        width: 100%;
        padding: 12px 16px;
        background: var(--input-bg);
        border: 2px solid var(--border-color);
        border-radius: var(--radius-sm);
        font-size: 14px;
        transition: var(--transition);
        color: var(--text-color);
      }

      input:focus,
      select:focus,
      textarea:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 4px rgba(67, 97, 238, 0.1);
      }

      .form-actions {
        display: flex;
        gap: 12px;
        justify-content: flex-end;
        margin-top: 32px;
        padding-top: 20px;
        border-top: 2px solid var(--border-color);
      }

      /* ===== TABS ===== */
      .tabs {
        display: flex;
        border-bottom: 2px solid var(--border-color);
        margin-bottom: 24px;
        overflow-x: auto;
      }

      .tab-btn {
        padding: 12px 24px;
        background: none;
        border: none;
        cursor: pointer;
        color: var(--text-light);
        font-weight: 600;
        position: relative;
        transition: var(--transition);
        white-space: nowrap;
        font-size: 14px;
      }

      .tab-btn:hover {
        color: var(--primary-color);
      }

      .tab-btn.active {
        color: var(--primary-color);
      }

      .tab-btn.active::after {
        content: "";
        position: absolute;
        bottom: -2px;
        left: 0;
        width: 100%;
        height: 3px;
        background: var(--gradient);
        border-radius: 3px 3px 0 0;
      }

      .tab-content {
        display: none;
        animation: fadeIn 0.5s;
      }

      .tab-content.active {
        display: block;
      }

      /* ===== ORDER ITEMS ===== */
      .order-items-container {
        max-height: 200px;
        overflow-y: auto;
        margin: 16px 0;
        border: 1px solid var(--border-color);
        border-radius: var(--radius-sm);
        padding: 16px;
        background: var(--input-bg);
      }

      .order-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px;
        border-bottom: 1px solid var(--border-color);
      }

      .order-item:last-child {
        border-bottom: none;
      }

      .item-controls {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .item-quantity {
        width: 70px;
        text-align: center;
        padding: 8px;
        border: 2px solid var(--border-color);
        border-radius: var(--radius-sm);
        background: var(--input-bg);
        color: var(--text-color);
      }

      .add-item-btn {
        margin-top: 16px;
        background: var(--primary-light);
        color: var(--primary-color);
        border: 2px dashed var(--primary-color);
        padding: 12px;
        width: 100%;
        border-radius: var(--radius-sm);
        cursor: pointer;
        transition: var(--transition);
        font-weight: 600;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
      }

      .add-item-btn:hover {
        background: var(--primary-color);
        color: white;
        border-style: solid;
      }

      /* ===== PRODUCT IMAGES ===== */
      .product-image {
        width: 56px;
        height: 56px;
        border-radius: 12px;
        object-fit: cover;
        border: 2px solid var(--border-color);
        transition: var(--transition);
      }

      .product-image:hover {
        transform: scale(1.8);
        box-shadow: var(--shadow-hover);
        z-index: 10;
        position: relative;
      }

      .product-card {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .review-content {
        max-height: 100px;
        overflow-y: auto;
        padding: 12px;
        background: var(--primary-light);
        border-radius: var(--radius-sm);
        margin-top: 8px;
        font-size: 13px;
        line-height: 1.5;
      }

      /* ===== RESPONSIVE DESIGN ===== */
      @media (max-width: 1200px) {
        .sidebar {
          width: 260px;
        }
        .main-content {
          margin-left: 260px;
        }
      }

      @media (max-width: 992px) {
        .dashboard-cards {
          grid-template-columns: repeat(2, 1fr);
        }
        .counter-stats {
          grid-template-columns: repeat(2, 1fr);
        }
        .payment-methods-grid {
          grid-template-columns: repeat(2, 1fr);
        }
      }

      @media (max-width: 768px) {
        .container {
          flex-direction: column;
        }
        .sidebar {
          position: relative;
          width: 100%;
          height: auto;
          margin-bottom: 16px;
        }
        .main-content {
          margin-left: 0;
          padding: 20px;
        }
        .dashboard-cards {
          grid-template-columns: 1fr;
        }
        .header {
          flex-direction: column;
          gap: 16px;
          text-align: center;
        }
        .header-actions {
          width: 100%;
          justify-content: center;
        }
        .search-container {
          flex-direction: column;
        }
        .search-options {
          width: 100%;
          flex-wrap: wrap;
        }
        .search-filter,
        .clear-search {
          flex: 1;
          min-width: 120px;
        }
        .modal-content {
          padding: 20px;
          width: 95%;
        }
      }

      @media (max-width: 480px) {
        .counter-stats {
          grid-template-columns: 1fr;
        }
        .payment-methods-grid {
          grid-template-columns: 1fr;
        }
        .tabs {
          flex-wrap: wrap;
        }
        .tab-btn {
          flex: 1;
          min-width: 120px;
          text-align: center;
        }
        .form-actions {
          flex-direction: column;
        }
        .btn {
          width: 100%;
          justify-content: center;
        }
      }

      /* Scrollbar personnalisée */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }

      ::-webkit-scrollbar-track {
        background: var(--primary-light);
        border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb {
        background: var(--primary-color);
        border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: var(--primary-dark);
      }
    </style>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- Background décoratif -->
    <div class="decorative-bg"></div>

    <!-- Dark Mode Toggle -->
    <div class="dark-mode-toggle">
      <div class="toggle-btn" id="darkModeToggle">
        <i class="fas fa-sun"></i>
        <i class="fas fa-moon"></i>
        <div class="toggle-slider"></div>
      </div>
    </div>

    <div class="container">
      <!-- SIDEBAR MODERNISÉ -->
      <aside class="sidebar">
        <div class="logo">
          <div class="logo-icon">
            <i class="fas fa-paw"></i>
          </div>
          <div class="logo-text">
            <h1>PetFood TN</h1>
            <div class="tagline">Le bonheur de vos animaux</div>
          </div>
        </div>

        <ul class="nav-menu">
          <li class="nav-item">
            <a href="#" class="nav-link active" data-tab="dashboard">
              <i class="fas fa-tachometer-alt"></i> Tableau de bord
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" data-tab="contact">
              <i class="fas fa-envelope"></i> Contact
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" data-tab="clients">
              <i class="fas fa-users"></i> Clients
              <span class="badge" id="clients-badge">3</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" data-tab="products">
              <i class="fas fa-box-open"></i> Produits
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" data-tab="orders">
              <i class="fas fa-shopping-cart"></i> Commandes
              <span class="badge" id="orders-badge">5</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" data-tab="reviews">
              <i class="fas fa-star"></i> Avis
              <span class="badge" id="reviews-badge">12</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" data-tab="payment">
              <i class="fas fa-credit-card"></i> Paiements
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" data-tab="history">
              <i class="fas fa-history"></i> Historique
            </a>
          </li>
        </ul>

        <a href="#" class="back-to-site">
          <i class="fas fa-arrow-left"></i> Retour au site
        </a>
      </aside>

      <!-- MAIN CONTENT -->
      <main class="main-content">
        <!-- HEADER MODERNISÉ -->
        <header class="header">
          <div class="welcome">
            <h2>Bienvenue, EL Jezi Ghassen !</h2>
            <p>
              Vous gérez
              <strong style="color: var(--primary-color)"
                >189 clients tunisiens</strong
              >
              et
              <strong style="color: var(--primary-color)"
                >48 commandes aujourd'hui</strong
              >
            </p>
          </div>

          <div class="header-actions">
            <div class="user-info">
              <div class="user-avatar">
                <i class="fas fa-user"></i>
              </div>
              <div class="user-details">
                <div class="user-name">EL Jezi Ghassen</div>
                <div class="user-role">Administrateur</div>
              </div>
            </div>
          </div>
        </header>

        <!-- DASHBOARD TAB -->
        <div id="dashboard" class="tab-content active">
          <!-- BARRE DE RECHERCHE -->
          <div class="search-container">
            <div class="search-box">
              <i class="fas fa-search search-icon"></i>
              <input
                type="text"
                class="search-input"
                id="dashboardSearch"
                placeholder="Rechercher dans les commandes récentes..."
                onkeyup="searchDashboard()"
              />
            </div>
            <div class="search-options">
              <select
                class="search-filter"
                id="dashboardFilter"
                onchange="searchDashboard()"
              >
                <option value="all">Tout</option>
                <option value="client">Client</option>
                <option value="product">Produit</option>
                <option value="status">Statut</option>
              </select>
              <button class="clear-search" onclick="clearDashboardSearch()">
                <i class="fas fa-times"></i> Effacer
              </button>
            </div>
          </div>

          <!-- COMPTEUR EN TEMPS RÉEL -->
          <div class="counter-container">
            <div class="counter-header">
              <h3 class="counter-title">
                <i class="fas fa-chart-bar"></i> Compteur en Temps Réel
              </h3>
              <div style="color: var(--primary-color); font-weight: 600">
                <i class="fas fa-sync-alt"></i> Mise à jour:
                <span id="last-update">Maintenant</span>
              </div>
            </div>

            <div class="counter-stats">
              <div class="counter-stat">
                <div class="counter-number" id="today-orders">48</div>
                <div class="counter-label">Commandes Aujourd'hui</div>
              </div>
              <div class="counter-stat">
                <div class="counter-number" id="pending-orders">5</div>
                <div class="counter-label">En Attente</div>
              </div>
              <div class="counter-stat">
                <div class="counter-number" id="total-clients">189</div>
                <div class="counter-label">Clients Actifs</div>
              </div>
              <div class="counter-stat">
                <div class="counter-number" id="month-revenue">2.845</div>
                <div class="counter-label">Revenus (DT)</div>
              </div>
            </div>
          </div>

          <!-- STATS CARDS -->
          <div class="dashboard-cards">
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">Clients Actifs</h3>
                <div class="card-icon">
                  <i class="fas fa-users"></i>
                </div>
              </div>
              <div class="card-value">189</div>
              <div class="card-change">
                <i class="fas fa-arrow-up"></i> +15 ce mois
              </div>
              <div
                style="
                  color: var(--text-light);
                  font-size: 13px;
                  margin-top: 8px;
                "
              >
                Clients tunisiens
              </div>
            </div>

            <div class="card">
              <div class="card-header">
                <h3 class="card-title">Commandes Aujourd'hui</h3>
                <div class="card-icon">
                  <i class="fas fa-shopping-cart"></i>
                </div>
              </div>
              <div class="card-value">48</div>
              <div class="card-change">
                <i class="fas fa-arrow-up"></i> +12% vs hier
              </div>
              <div
                style="
                  color: var(--text-light);
                  font-size: 13px;
                  margin-top: 8px;
                "
              >
                Commandes traitées
              </div>
            </div>

            <div class="card">
              <div class="card-header">
                <h3 class="card-title">Chiffre d'Affaires</h3>
                <div class="card-icon">
                  <i class="fas fa-chart-line"></i>
                </div>
              </div>
              <div class="card-value">2.845 DT</div>
              <div class="progress-bar">
                <div class="progress-fill" style="width: 75%"></div>
              </div>
              <div class="card-change">
                <i class="fas fa-arrow-up"></i> +8.5% ce mois
              </div>
              <div
                style="
                  color: var(--text-light);
                  font-size: 13px;
                  margin-top: 8px;
                "
              >
                Objectif: 3.800 DT
              </div>
            </div>
          </div>

          <!-- RECENT ACTIVITY -->
          <div class="section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-bolt"></i> Activité Récente
              </h3>
              <button class="btn btn-primary" onclick="location.reload()">
                <i class="fas fa-sync-alt"></i> Actualiser
              </button>
            </div>

            <div
              id="dashboardResultsInfo"
              class="search-results-info"
              style="display: none"
            >
              <div id="dashboardResultsCount"></div>
              <button class="clear-search" onclick="clearDashboardSearch()">
                <i class="fas fa-times"></i> Effacer la recherche
              </button>
            </div>

            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>Client</th>
                    <th>Produit</th>
                    <th>Date</th>
                    <th>Montant</th>
                    <th>Statut</th>
                  </tr>
                </thead>
                <tbody id="recent-activity">
                  <!-- Recent activity will be loaded here -->
                </tbody>
              </table>
            </div>
            <div
              id="dashboardNoResults"
              class="no-results"
              style="display: none"
            >
              <i class="fas fa-search"></i>
              <h3>Aucun résultat trouvé</h3>
              <p>Aucune commande ne correspond à votre recherche.</p>
            </div>
          </div>
        </div>

        <!-- CONTACT TAB -->
        <div id="contact" class="tab-content">
          <div class="section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-envelope"></i> Contact & Support
              </h3>
            </div>

            <div class="dashboard-cards">
              <div class="card">
                <div class="card-header">
                  <h3 class="card-title">Support Technique</h3>
                  <div class="card-icon">
                    <i class="fas fa-headset"></i>
                  </div>
                </div>
                <div class="card-value" style="font-size: 28px">
                  +216 70 123 456
                </div>
                <div class="card-change">
                  <i class="fas fa-clock"></i> 8h-22h 7j/7
                </div>
                <div
                  style="
                    color: var(--text-light);
                    font-size: 13px;
                    margin-top: 8px;
                  "
                >
                  Assistance téléphonique
                </div>
              </div>

              <div class="card">
                <div class="card-header">
                  <h3 class="card-title">Email Support</h3>
                  <div class="card-icon">
                    <i class="fas fa-envelope"></i>
                  </div>
                </div>
                <div class="card-value" style="font-size: 24px">
                  support@petfoodtn.tn
                </div>
                <div class="card-change">
                  <i class="fas fa-reply"></i> Réponse sous 24h
                </div>
                <div
                  style="
                    color: var(--text-light);
                    font-size: 13px;
                    margin-top: 8px;
                  "
                >
                  Support par email
                </div>
              </div>

              <div class="card">
                <div class="card-header">
                  <h3 class="card-title">Adresse</h3>
                  <div class="card-icon">
                    <i class="fas fa-map-marker-alt"></i>
                  </div>
                </div>
                <div class="card-value" style="font-size: 20px">
                  Rue de l'Agriculture
                </div>
                <div class="card-change">
                  <i class="fas fa-city"></i> Tunis 1002
                </div>
                <div
                  style="
                    color: var(--text-light);
                    font-size: 13px;
                    margin-top: 8px;
                  "
                >
                  Siège social
                </div>
              </div>
            </div>

            <!-- FORMULAIRE DE CONTACT -->
            <div class="section" style="margin-top: 32px">
              <div class="section-header">
                <h3 class="section-title">
                  <i class="fas fa-paper-plane"></i> Formulaire de Contact
                </h3>
              </div>

              <div
                style="
                  padding: 24px;
                  background: var(--gradient-light);
                  border-radius: var(--radius);
                  border: 1px solid var(--border-color);
                "
              >
                <div class="form-group">
                  <label for="contactName">Nom complet *</label>
                  <input
                    type="text"
                    id="contactName"
                    required
                    placeholder="Votre nom et prénom"
                  />
                </div>
                <div class="form-group">
                  <label for="contactEmail">Email *</label>
                  <input
                    type="email"
                    id="contactEmail"
                    required
                    placeholder="votre@email.com"
                  />
                </div>
                <div class="form-group">
                  <label for="contactSubject">Sujet *</label>
                  <select id="contactSubject" required>
                    <option value="">Sélectionner un sujet</option>
                    <option value="support">Support technique</option>
                    <option value="billing">Facturation</option>
                    <option value="product">Question sur les produits</option>
                    <option value="delivery">Livraison</option>
                    <option value="other">Autre</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="contactMessage">Message *</label>
                  <textarea
                    id="contactMessage"
                    rows="6"
                    required
                    placeholder="Décrivez votre demande en détail..."
                  ></textarea>
                </div>
                <div class="form-group">
                  <label for="contactPhone">Téléphone (optionnel)</label>
                  <input
                    type="tel"
                    id="contactPhone"
                    placeholder="XX XXX XXX"
                  />
                </div>
                <div style="display: flex; gap: 12px; margin-top: 24px">
                  <button class="btn btn-primary" onclick="sendContactForm()">
                    <i class="fas fa-paper-plane"></i> Envoyer le message
                  </button>
                  <button
                    class="btn btn-secondary"
                    onclick="clearContactForm()"
                  >
                    <i class="fas fa-times"></i> Effacer
                  </button>
                </div>
              </div>
            </div>

            <!-- RÉSEAUX SOCIAUX -->
            <div class="section" style="margin-top: 32px">
              <div class="section-header">
                <h3 class="section-title">
                  <i class="fas fa-share-alt"></i> Suivez-nous
                </h3>
              </div>

              <div
                style="
                  padding: 24px;
                  background: var(--gradient-light);
                  border-radius: var(--radius);
                  border: 1px solid var(--border-color);
                  text-align: center;
                "
              >
                <div
                  style="
                    display: flex;
                    justify-content: center;
                    gap: 16px;
                    flex-wrap: wrap;
                    margin-top: 16px;
                  "
                >
                  <a
                    href="#"
                    class="social-btn"
                    style="
                      background: #1877f2;
                      color: white;
                      padding: 16px 24px;
                      border-radius: var(--radius-sm);
                      text-decoration: none;
                      display: flex;
                      align-items: center;
                      gap: 8px;
                      font-weight: 600;
                      transition: var(--transition);
                    "
                  >
                    <i class="fab fa-facebook-f"></i> Facebook
                  </a>
                  <a
                    href="#"
                    class="social-btn"
                    style="
                      background: #e4405f;
                      color: white;
                      padding: 16px 24px;
                      border-radius: var(--radius-sm);
                      text-decoration: none;
                      display: flex;
                      align-items: center;
                      gap: 8px;
                      font-weight: 600;
                      transition: var(--transition);
                    "
                  >
                    <i class="fab fa-instagram"></i> Instagram
                  </a>
                  <a
                    href="#"
                    class="social-btn"
                    style="
                      background: #1da1f2;
                      color: white;
                      padding: 16px 24px;
                      border-radius: var(--radius-sm);
                      text-decoration: none;
                      display: flex;
                      align-items: center;
                      gap: 8px;
                      font-weight: 600;
                      transition: var(--transition);
                    "
                  >
                    <i class="fab fa-twitter"></i> Twitter
                  </a>
                  <a
                    href="#"
                    class="social-btn"
                    style="
                      background: #25d366;
                      color: white;
                      padding: 16px 24px;
                      border-radius: var(--radius-sm);
                      text-decoration: none;
                      display: flex;
                      align-items: center;
                      gap: 8px;
                      font-weight: 600;
                      transition: var(--transition);
                    "
                  >
                    <i class="fab fa-whatsapp"></i> WhatsApp
                  </a>
                </div>
                <p
                  style="
                    margin-top: 24px;
                    color: var(--text-light);
                    font-size: 14px;
                  "
                >
                  Rejoignez notre communauté pour les dernières actualités et
                  promotions
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- CLIENTS TAB -->
        <div id="clients" class="tab-content">
          <div class="section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-users"></i> Gestion des Clients
              </h3>
              <button class="btn btn-primary" id="addClientBtn">
                <i class="fas fa-plus"></i> Ajouter un client
              </button>
            </div>

            <!-- BARRE DE RECHERCHE CLIENTS -->
            <div class="search-container">
              <div class="search-box">
                <i class="fas fa-search search-icon"></i>
                <input
                  type="text"
                  class="search-input"
                  id="clientsSearch"
                  placeholder="Rechercher un client par nom, email, ville..."
                  onkeyup="searchClients()"
                />
              </div>
              <div class="search-options">
                <select
                  class="search-filter"
                  id="clientsFilter"
                  onchange="searchClients()"
                >
                  <option value="all">Tout</option>
                  <option value="name">Nom</option>
                  <option value="email">Email</option>
                  <option value="city">Ville</option>
                  <option value="phone">Téléphone</option>
                </select>
                <button class="clear-search" onclick="clearClientsSearch()">
                  <i class="fas fa-times"></i> Effacer
                </button>
              </div>
            </div>

            <div
              id="clientsResultsInfo"
              class="search-results-info"
              style="display: none"
            >
              <div id="clientsResultsCount"></div>
              <button class="clear-search" onclick="clearClientsSearch()">
                <i class="fas fa-times"></i> Effacer la recherche
              </button>
            </div>

            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Nom</th>
                    <th>Email</th>
                    <th>Téléphone</th>
                    <th>Ville</th>
                    <th>Commandes</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="clients-table">
                  <!-- Clients will be loaded here -->
                </tbody>
              </table>
            </div>
            <div id="clientsNoResults" class="no-results" style="display: none">
              <i class="fas fa-user-slash"></i>
              <h3>Aucun client trouvé</h3>
              <p>Aucun client ne correspond à votre recherche.</p>
            </div>
          </div>
        </div>

        <!-- PRODUCTS TAB -->
        <div id="products" class="tab-content">
          <div class="section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-box-open"></i> Gestion des Produits
              </h3>
              <button class="btn btn-primary" id="addProductBtn">
                <i class="fas fa-plus"></i> Ajouter un produit
              </button>
            </div>

            <!-- BARRE DE RECHERCHE PRODUITS -->
            <div class="search-container">
              <div class="search-box">
                <i class="fas fa-search search-icon"></i>
                <input
                  type="text"
                  class="search-input"
                  id="productsSearch"
                  placeholder="Rechercher un produit par nom, catégorie, description..."
                  onkeyup="searchProducts()"
                />
              </div>
              <div class="search-options">
                <select
                  class="search-filter"
                  id="productsFilter"
                  onchange="searchProducts()"
                >
                  <option value="all">Tout</option>
                  <option value="name">Nom</option>
                  <option value="category">Catégorie</option>
                  <option value="description">Description</option>
                </select>
                <button class="clear-search" onclick="clearProductsSearch()">
                  <i class="fas fa-times"></i> Effacer
                </button>
              </div>
            </div>

            <div
              id="productsResultsInfo"
              class="search-results-info"
              style="display: none"
            >
              <div id="productsResultsCount"></div>
              <button class="clear-search" onclick="clearProductsSearch()">
                <i class="fas fa-times"></i> Effacer la recherche
              </button>
            </div>

            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>Image</th>
                    <th>Nom</th>
                    <th>Catégorie</th>
                    <th>Prix (DT)</th>
                    <th>Stock</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="products-table">
                  <!-- Products will be loaded here -->
                </tbody>
              </table>
            </div>
            <div
              id="productsNoResults"
              class="no-results"
              style="display: none"
            >
              <i class="fas fa-box-open"></i>
              <h3>Aucun produit trouvé</h3>
              <p>Aucun produit ne correspond à votre recherche.</p>
            </div>
          </div>
        </div>

        <!-- ORDERS TAB -->
        <div id="orders" class="tab-content">
          <div class="section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-shopping-cart"></i> Gestion des Commandes
              </h3>
              <button class="btn btn-primary" id="addOrderBtn">
                <i class="fas fa-plus"></i> Nouvelle commande
              </button>
            </div>

            <!-- BARRE DE RECHERCHE COMMANDES -->
            <div class="search-container">
              <div class="search-box">
                <i class="fas fa-search search-icon"></i>
                <input
                  type="text"
                  class="search-input"
                  id="ordersSearch"
                  placeholder="Rechercher une commande par ID, client, statut..."
                  onkeyup="searchOrders()"
                />
              </div>
              <div class="search-options">
                <select
                  class="search-filter"
                  id="ordersFilter"
                  onchange="searchOrders()"
                >
                  <option value="all">Tout</option>
                  <option value="id">ID Commande</option>
                  <option value="client">Client</option>
                  <option value="status">Statut</option>
                  <option value="date">Date</option>
                </select>
                <button class="clear-search" onclick="clearOrdersSearch()">
                  <i class="fas fa-times"></i> Effacer
                </button>
              </div>
            </div>

            <div
              id="ordersResultsInfo"
              class="search-results-info"
              style="display: none"
            >
              <div id="ordersResultsCount"></div>
              <button class="clear-search" onclick="clearOrdersSearch()">
                <i class="fas fa-times"></i> Effacer la recherche
              </button>
            </div>

            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>N° Commande</th>
                    <th>Client</th>
                    <th>Date</th>
                    <th>Total (DT)</th>
                    <th>Statut</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="orders-table">
                  <!-- Orders will be loaded here -->
                </tbody>
              </table>
            </div>
            <div id="ordersNoResults" class="no-results" style="display: none">
              <i class="fas fa-shopping-cart"></i>
              <h3>Aucune commande trouvée</h3>
              <p>Aucune commande ne correspond à votre recherche.</p>
            </div>
          </div>
        </div>

        <!-- AVIS TAB -->
        <div id="reviews" class="tab-content">
          <div class="section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-star"></i> Gestion des Avis Clients
              </h3>
              <button class="btn btn-primary" id="addReviewBtn">
                <i class="fas fa-plus"></i> Ajouter un avis
              </button>
            </div>

            <!-- BARRE DE RECHERCHE AVIS -->
            <div class="search-container">
              <div class="search-box">
                <i class="fas fa-search search-icon"></i>
                <input
                  type="text"
                  class="search-input"
                  id="reviewsSearch"
                  placeholder="Rechercher un avis par client, produit, note, commentaire..."
                  onkeyup="searchReviews()"
                />
              </div>
              <div class="search-options">
                <select
                  class="search-filter"
                  id="reviewsFilter"
                  onchange="searchReviews()"
                >
                  <option value="all">Tout</option>
                  <option value="client">Client</option>
                  <option value="product">Produit</option>
                  <option value="rating">Note</option>
                  <option value="comment">Commentaire</option>
                  <option value="verified">Vérification</option>
                </select>
                <button class="clear-search" onclick="clearReviewsSearch()">
                  <i class="fas fa-times"></i> Effacer
                </button>
              </div>
            </div>

            <div
              id="reviewsResultsInfo"
              class="search-results-info"
              style="display: none"
            >
              <div id="reviewsResultsCount"></div>
              <button class="clear-search" onclick="clearReviewsSearch()">
                <i class="fas fa-times"></i> Effacer la recherche
              </button>
            </div>

            <!-- STATISTIQUES DES AVIS -->
            <div class="dashboard-cards">
              <div class="card">
                <div class="card-header">
                  <h3 class="card-title">Note Moyenne</h3>
                  <div class="card-icon">
                    <i class="fas fa-star"></i>
                  </div>
                </div>
                <div class="card-value" id="average-rating">4.5/5</div>
                <div class="card-change">
                  <i class="fas fa-arrow-up"></i> +0.2 ce mois
                </div>
              </div>

              <div class="card">
                <div class="card-header">
                  <h3 class="card-title">Total Avis</h3>
                  <div class="card-icon">
                    <i class="fas fa-comments"></i>
                  </div>
                </div>
                <div class="card-value" id="total-reviews">12</div>
                <div class="card-change">
                  <i class="fas fa-arrow-up"></i> +3 ce mois
                </div>
              </div>

              <div class="card">
                <div class="card-header">
                  <h3 class="card-title">Avis Positifs</h3>
                  <div class="card-icon">
                    <i class="fas fa-thumbs-up"></i>
                  </div>
                </div>
                <div class="card-value" id="positive-reviews">85%</div>
                <div class="progress-bar">
                  <div class="progress-fill" style="width: 85%"></div>
                </div>
                <div class="card-change">
                  <i class="fas fa-arrow-up"></i> +5% vs dernier mois
                </div>
              </div>
            </div>

            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Client</th>
                    <th>Produit</th>
                    <th>Note</th>
                    <th>Commentaire</th>
                    <th>Date</th>
                    <th>Vérifié</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="reviews-table">
                  <!-- Reviews will be loaded here -->
                </tbody>
              </table>
            </div>
            <div id="reviewsNoResults" class="no-results" style="display: none">
              <i class="fas fa-star"></i>
              <h3>Aucun avis trouvé</h3>
              <p>Aucun avis ne correspond à votre recherche.</p>
            </div>
          </div>
        </div>

        <!-- PAYMENT TAB -->
        <div id="payment" class="tab-content">
          <!-- Section des moyens de paiement -->
          <div class="section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-credit-card"></i> Moyens de Paiement Acceptés
              </h3>
              <span style="color: var(--success-color); font-weight: 600">
                <i class="fas fa-check-circle"></i> Sécurisé & Rapide
              </span>
            </div>

            <div class="payment-methods-grid">
              <div class="payment-method-card">
                <div class="payment-icon">
                  <i class="fas fa-credit-card"></i>
                </div>
                <div class="payment-name">Carte Bancaire</div>
                <div class="payment-desc">Visa, Mastercard, Carte Bleue</div>
                <div class="payment-method-status">
                  <span style="color: var(--success-color)">✓</span> 3D Secure
                </div>
              </div>

              <div class="payment-method-card">
                <div class="payment-icon">
                  <i class="fas fa-money-bill-wave"></i>
                </div>
                <div class="payment-name">Espèces</div>
                <div class="payment-desc">Paiement en main propre</div>
                <div class="payment-method-status">
                  <span style="color: var(--success-color)">✓</span> À la
                  livraison
                </div>
              </div>

              <div class="payment-method-card">
                <div class="payment-icon">
                  <i class="fas fa-university"></i>
                </div>
                <div class="payment-name">Virement Bancaire</div>
                <div class="payment-desc">Transfert bancaire national</div>
                <div class="payment-method-status">
                  <span style="color: var(--success-color)">✓</span> Sous 48h
                </div>
              </div>

              <div class="payment-method-card">
                <div class="payment-icon">
                  <i class="fas fa-mobile-alt"></i>
                </div>
                <div class="payment-name">Paiement Mobile</div>
                <div class="payment-desc">Via applications mobiles</div>
                <div class="payment-method-status">
                  <span style="color: var(--success-color)">✓</span> Instantané
                </div>
              </div>

              <div class="payment-method-card">
                <div class="payment-icon">
                  <i class="fas fa-file-invoice-dollar"></i>
                </div>
                <div class="payment-name">Chèque</div>
                <div class="payment-desc">Chèques bancaires tunisiens</div>
                <div class="payment-method-status">
                  <span style="color: var(--success-color)">✓</span>
                  Encaissement 5 jours
                </div>
              </div>
            </div>

            <div
              style="
                margin-top: 32px;
                padding: 24px;
                background: var(--gradient-light);
                border-radius: var(--radius);
                border: 1px solid var(--border-color);
              "
            >
              <h4
                style="
                  color: var(--primary-color);
                  margin-bottom: 16px;
                  display: flex;
                  align-items: center;
                  gap: 8px;
                "
              >
                <i class="fas fa-info-circle"></i> Informations importantes
              </h4>
              <ul
                style="
                  color: var(--text-color);
                  padding-left: 20px;
                  list-style-type: none;
                "
              >
                <li
                  style="
                    margin-bottom: 8px;
                    padding-left: 24px;
                    position: relative;
                  "
                >
                  <i
                    class="fas fa-check"
                    style="
                      position: absolute;
                      left: 0;
                      color: var(--success-color);
                    "
                  ></i>
                  Les paiements par carte sont sécurisés avec la technologie 3D
                  Secure
                </li>
                <li
                  style="
                    margin-bottom: 8px;
                    padding-left: 24px;
                    position: relative;
                  "
                >
                  <i
                    class="fas fa-check"
                    style="
                      position: absolute;
                      left: 0;
                      color: var(--success-color);
                    "
                  ></i>
                  Les paiements en espèces sont acceptés uniquement à la
                  livraison
                </li>
                <li
                  style="
                    margin-bottom: 8px;
                    padding-left: 24px;
                    position: relative;
                  "
                >
                  <i
                    class="fas fa-check"
                    style="
                      position: absolute;
                      left: 0;
                      color: var(--success-color);
                    "
                  ></i>
                  Les virements bancaires doivent être confirmés par email
                </li>
                <li style="padding-left: 24px; position: relative">
                  <i
                    class="fas fa-check"
                    style="
                      position: absolute;
                      left: 0;
                      color: var(--success-color);
                    "
                  ></i>
                  Les chèques doivent être émis à l'ordre de "PetFood TN"
                </li>
              </ul>
            </div>
          </div>

          <!-- Section création de facture -->
          <div class="section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-file-invoice"></i> Création de Facture
              </h3>
            </div>

            <div
              style="
                padding: 24px;
                background: var(--gradient-light);
                border-radius: var(--radius);
                border: 1px solid var(--border-color);
              "
            >
              <div class="form-group">
                <label for="simpleInvoiceClient">Nom du Client *</label>
                <input
                  type="text"
                  id="simpleInvoiceClient"
                  required
                  placeholder="Saisir le nom du client"
                />
              </div>
              <div class="form-group">
                <label for="simpleInvoiceAmount">Montant (DT) *</label>
                <input
                  type="number"
                  id="simpleInvoiceAmount"
                  step="0.01"
                  min="0"
                  required
                  placeholder="0.00"
                />
              </div>
              <div class="form-group">
                <label for="simpleInvoiceDescription">Description</label>
                <textarea
                  id="simpleInvoiceDescription"
                  rows="2"
                  placeholder="Description de la facture"
                ></textarea>
              </div>
              <div style="display: flex; gap: 12px; margin-top: 24px">
                <button class="btn btn-primary" onclick="createSimpleInvoice()">
                  <i class="fas fa-check"></i> Valider
                </button>
                <button
                  class="btn btn-secondary"
                  onclick="clearSimpleInvoice()"
                >
                  <i class="fas fa-times"></i> Annuler
                </button>
              </div>
            </div>
          </div>

          <!-- Section gestion des paiements -->
          <div class="section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-money-check-alt"></i> Gestion des Paiements
              </h3>
              <button class="btn btn-primary" id="addPaymentBtn">
                <i class="fas fa-plus"></i> Ajouter un paiement
              </button>
            </div>

            <!-- BARRE DE RECHERCHE PAIEMENTS -->
            <div class="search-container">
              <div class="search-box">
                <i class="fas fa-search search-icon"></i>
                <input
                  type="text"
                  class="search-input"
                  id="paymentsSearch"
                  placeholder="Rechercher un paiement par client, méthode, statut..."
                  onkeyup="searchPayments()"
                />
              </div>
              <div class="search-options">
                <select
                  class="search-filter"
                  id="paymentsFilter"
                  onchange="searchPayments()"
                >
                  <option value="all">Tout</option>
                  <option value="client">Client</option>
                  <option value="method">Méthode</option>
                  <option value="status">Statut</option>
                  <option value="reference">Référence</option>
                </select>
                <button class="clear-search" onclick="clearPaymentsSearch()">
                  <i class="fas fa-times"></i> Effacer
                </button>
              </div>
            </div>

            <div
              id="paymentsResultsInfo"
              class="search-results-info"
              style="display: none"
            >
              <div id="paymentsResultsCount"></div>
              <button class="clear-search" onclick="clearPaymentsSearch()">
                <i class="fas fa-times"></i> Effacer la recherche
              </button>
            </div>

            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Client</th>
                    <th>Montant (DT)</th>
                    <th>Méthode</th>
                    <th>Date</th>
                    <th>Statut</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="payments-table">
                  <!-- Payments will be loaded here -->
                </tbody>
              </table>
            </div>
            <div
              id="paymentsNoResults"
              class="no-results"
              style="display: none"
            >
              <i class="fas fa-credit-card"></i>
              <h3>Aucun paiement trouvé</h3>
              <p>Aucun paiement ne correspond à votre recherche.</p>
            </div>
          </div>

          <!-- Section factures -->
          <div class="section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-history"></i> Historique des Factures
              </h3>
            </div>

            <!-- BARRE DE RECHERCHE FACTURES -->
            <div class="search-container">
              <div class="search-box">
                <i class="fas fa-search search-icon"></i>
                <input
                  type="text"
                  class="search-input"
                  id="invoicesSearch"
                  placeholder="Rechercher une facture par client, montant, description..."
                  onkeyup="searchInvoices()"
                />
              </div>
              <div class="search-options">
                <select
                  class="search-filter"
                  id="invoicesFilter"
                  onchange="searchInvoices()"
                >
                  <option value="all">Tout</option>
                  <option value="client">Client</option>
                  <option value="amount">Montant</option>
                  <option value="description">Description</option>
                  <option value="status">Statut</option>
                </select>
                <button class="clear-search" onclick="clearInvoicesSearch()">
                  <i class="fas fa-times"></i> Effacer
                </button>
              </div>
            </div>

            <div
              id="invoicesResultsInfo"
              class="search-results-info"
              style="display: none"
            >
              <div id="invoicesResultsCount"></div>
              <button class="clear-search" onclick="clearInvoicesSearch()">
                <i class="fas fa-times"></i> Effacer la recherche
              </button>
            </div>

            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>N° Facture</th>
                    <th>Date</th>
                    <th>Client</th>
                    <th>Montant (DT)</th>
                    <th>Description</th>
                    <th>Statut</th>
                  </tr>
                </thead>
                <tbody id="invoices-table">
                  <!-- Invoices will be loaded here -->
                </tbody>
              </table>
            </div>
            <div
              id="invoicesNoResults"
              class="no-results"
              style="display: none"
            >
              <i class="fas fa-file-invoice"></i>
              <h3>Aucune facture trouvée</h3>
              <p>Aucune facture ne correspond à votre recherche.</p>
            </div>
          </div>
        </div>

        <!-- HISTORY TAB -->
        <div id="history" class="tab-content">
          <div class="section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-history"></i> Historique des Activités
              </h3>
              <div>
                <button class="btn btn-secondary" id="filterToday">
                  <i class="fas fa-calendar-day"></i> Aujourd'hui
                </button>
                <button class="btn btn-secondary" id="filterWeek">
                  <i class="fas fa-calendar-week"></i> Cette semaine
                </button>
                <button class="btn btn-secondary" id="filterMonth">
                  <i class="fas fa-calendar-alt"></i> Ce mois
                </button>
              </div>
            </div>

            <!-- BARRE DE RECHERCHE HISTORIQUE -->
            <div class="search-container">
              <div class="search-box">
                <i class="fas fa-search search-icon"></i>
                <input
                  type="text"
                  class="search-input"
                  id="historySearch"
                  placeholder="Rechercher dans l'historique par utilisateur, action, détails..."
                  onkeyup="searchHistory()"
                />
              </div>
              <div class="search-options">
                <select
                  class="search-filter"
                  id="historyFilter"
                  onchange="searchHistory()"
                >
                  <option value="all">Tout</option>
                  <option value="user">Utilisateur</option>
                  <option value="action">Action</option>
                  <option value="details">Détails</option>
                  <option value="date">Date</option>
                </select>
                <button class="clear-search" onclick="clearHistorySearch()">
                  <i class="fas fa-times"></i> Effacer
                </button>
              </div>
            </div>

            <div
              id="historyResultsInfo"
              class="search-results-info"
              style="display: none"
            >
              <div id="historyResultsCount"></div>
              <button class="clear-search" onclick="clearHistorySearch()">
                <i class="fas fa-times"></i> Effacer la recherche
              </button>
            </div>

            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>Date</th>
                    <th>Utilisateur</th>
                    <th>Action</th>
                    <th>Détails</th>
                  </tr>
                </thead>
                <tbody id="history-table">
                  <!-- History will be loaded here -->
                </tbody>
              </table>
            </div>
            <div id="historyNoResults" class="no-results" style="display: none">
              <i class="fas fa-history"></i>
              <h3>Aucune activité trouvée</h3>
              <p>Aucune activité ne correspond à votre recherche.</p>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- MODALS -->
    <!-- MODAL CLIENT -->
    <div class="modal" id="clientModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title" id="clientModalTitle">Ajouter un client</h3>
          <button class="close-modal">&times;</button>
        </div>
        <form id="clientForm">
          <input type="hidden" id="clientId" />
          <div class="form-group">
            <label for="clientName">Nom complet *</label>
            <input
              type="text"
              id="clientName"
              required
              placeholder="Ex: Ali Ben Salah"
            />
          </div>
          <div class="form-group">
            <label for="clientEmail">Email *</label>
            <input
              type="email"
              id="clientEmail"
              required
              placeholder="exemple@email.com"
            />
          </div>
          <div class="form-group">
            <label for="clientPhone">Téléphone *</label>
            <input
              type="tel"
              id="clientPhone"
              required
              placeholder="XX XXX XXX"
            />
          </div>
          <div class="form-group">
            <label for="clientAddress">Adresse</label>
            <textarea
              id="clientAddress"
              rows="2"
              placeholder="Adresse complète"
            ></textarea>
          </div>
          <div class="form-group">
            <label for="clientCity">Ville</label>
            <select id="clientCity">
              <option value="Tunis">Tunis</option>
              <option value="Sfax">Sfax</option>
              <option value="Sousse">Sousse</option>
              <option value="Gabès">Gabès</option>
              <option value="Nabeul">Nabeul</option>
              <option value="Bizerte">Bizerte</option>
              <option value="Monastir">Monastir</option>
            </select>
          </div>
          <div class="form-actions">
            <button type="button" class="btn btn-secondary close-modal">
              Annuler
            </button>
            <button type="submit" class="btn btn-primary">Enregistrer</button>
          </div>
        </form>
      </div>
    </div>

    <!-- MODAL PRODUIT -->
    <div class="modal" id="productModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title" id="productModalTitle">Ajouter un produit</h3>
          <button class="close-modal">&times;</button>
        </div>
        <form id="productForm">
          <input type="hidden" id="productId" />
          <div class="form-group">
            <label for="productName">Nom du produit *</label>
            <input
              type="text"
              id="productName"
              required
              placeholder="Ex: Croquettes Premium"
            />
          </div>
          <div class="form-group">
            <label for="productImage">Image URL</label>
            <input
              type="url"
              id="productImage"
              placeholder="URL de l'image"
              value="https://images.unsplash.com/photo-1592924357228-91a4daadcfea?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80"
            />
          </div>
          <div class="form-group">
            <label for="productCategory">Catégorie *</label>
            <select id="productCategory" required>
              <option value="">Sélectionner</option>
              <option value="Chien">Chien</option>
              <option value="Chat">Chat</option>
              <option value="Oiseau">Oiseau</option>
              <option value="Rongeur">Rongeur</option>
              <option value="Poisson">Poisson</option>
              <option value="Autre">Autre</option>
            </select>
          </div>
          <div class="form-group">
            <label for="productPrice">Prix (DT) *</label>
            <input
              type="number"
              id="productPrice"
              step="0.01"
              min="0"
              required
              placeholder="0.00"
            />
          </div>
          <div class="form-group">
            <label for="productStock">Stock *</label>
            <input
              type="number"
              id="productStock"
              min="0"
              required
              placeholder="Quantité en stock"
            />
          </div>
          <div class="form-group">
            <label for="productDescription">Description</label>
            <textarea
              id="productDescription"
              rows="3"
              placeholder="Description du produit..."
            ></textarea>
          </div>
          <div class="form-actions">
            <button type="button" class="btn btn-secondary close-modal">
              Annuler
            </button>
            <button type="submit" class="btn btn-primary">Enregistrer</button>
          </div>
        </form>
      </div>
    </div>

    <!-- MODAL DE COMMANDE -->
    <div class="modal" id="orderModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title" id="orderModalTitle">Nouvelle Commande</h3>
          <button class="close-modal">&times;</button>
        </div>
        <form id="orderForm">
          <input type="hidden" id="orderId" />
          <div class="form-group">
            <label for="orderClient">Client *</label>
            <select id="orderClient" required>
              <option value="">Sélectionner un client</option>
            </select>
          </div>
          <div class="form-group">
            <label for="orderDate">Date de Commande *</label>
            <input type="date" id="orderDate" required />
          </div>

          <h4
            style="
              margin: 24px 0 16px;
              color: var(--primary-color);
              font-weight: 600;
            "
          >
            Articles de la Commande
          </h4>
          <div class="order-items-container" id="orderItemsContainer">
            <!-- Les articles seront ajoutés dynamiquement -->
          </div>

          <button type="button" class="add-item-btn" onclick="addOrderItem()">
            <i class="fas fa-plus"></i> Ajouter un article
          </button>

          <div class="form-group" style="margin-top: 24px">
            <label for="orderStatus">Statut de la Commande</label>
            <select id="orderStatus">
              <option value="pending">En attente</option>
              <option value="processing">En traitement</option>
              <option value="delivered">Livré</option>
              <option value="cancelled">Annulé</option>
            </select>
          </div>

          <div
            style="
              background: var(--primary-light);
              padding: 20px;
              border-radius: var(--radius-sm);
              margin-top: 24px;
              border: 1px solid var(--border-color);
            "
          >
            <div
              style="
                display: flex;
                justify-content: space-between;
                font-weight: 600;
                font-size: 18px;
              "
            >
              <span>Total:</span>
              <span id="orderTotal">0.00 DT</span>
            </div>
          </div>

          <div class="form-actions">
            <button type="button" class="btn btn-secondary close-modal">
              Annuler
            </button>
            <button type="submit" class="btn btn-primary">
              Enregistrer la Commande
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- MODAL D'AVIS -->
    <div class="modal" id="reviewModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title" id="reviewModalTitle">Ajouter un avis</h3>
          <button class="close-modal">&times;</button>
        </div>
        <form id="reviewForm">
          <input type="hidden" id="reviewId" />
          <div class="form-group">
            <label for="reviewClient">Client *</label>
            <select id="reviewClient" required>
              <option value="">Sélectionner un client</option>
            </select>
          </div>
          <div class="form-group">
            <label for="reviewProduct">Produit *</label>
            <select id="reviewProduct" required>
              <option value="">Sélectionner un produit</option>
            </select>
          </div>

          <div class="form-group">
            <label for="reviewRatingInput">Note *</label>
            <div class="star-rating-input" id="starRating">
              <span class="star" data-value="1"
                ><i class="far fa-star"></i
              ></span>
              <span class="star" data-value="2"
                ><i class="far fa-star"></i
              ></span>
              <span class="star" data-value="3"
                ><i class="far fa-star"></i
              ></span>
              <span class="star" data-value="4"
                ><i class="far fa-star"></i
              ></span>
              <span class="star" data-value="5"
                ><i class="far fa-star"></i
              ></span>
              <input
                type="hidden"
                id="reviewRating"
                name="reviewRating"
                value="0"
                required
              />
            </div>
            <div
              style="margin-top: 8px; font-size: 13px; color: var(--text-light)"
            >
              Cliquez sur les étoiles pour attribuer une note
            </div>
          </div>

          <div class="form-group">
            <label for="reviewComment">Commentaire *</label>
            <textarea
              id="reviewComment"
              rows="4"
              required
              placeholder="Partagez votre expérience avec ce produit..."
            ></textarea>
          </div>

          <div class="form-group">
            <label for="reviewDate">Date *</label>
            <input type="date" id="reviewDate" required />
          </div>

          <div class="form-group">
            <label for="reviewVerified">Statut de vérification</label>
            <select id="reviewVerified">
              <option value="true">Vérifié</option>
              <option value="false">Non vérifié</option>
            </select>
          </div>

          <div class="form-group">
            <label for="reviewResponse">Réponse (optionnel)</label>
            <textarea
              id="reviewResponse"
              rows="3"
              placeholder="Réponse de l'administration..."
            ></textarea>
          </div>

          <div class="form-actions">
            <button type="button" class="btn btn-secondary close-modal">
              Annuler
            </button>
            <button type="submit" class="btn btn-primary">Enregistrer</button>
          </div>
        </form>
      </div>
    </div>

    <!-- MODAL DE PAIEMENT -->
    <div class="modal" id="paymentModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title" id="paymentModalTitle">
            Ajouter un paiement
          </h3>
          <button class="close-modal">&times;</button>
        </div>
        <form id="paymentForm">
          <input type="hidden" id="paymentId" />
          <div class="form-group">
            <label for="paymentClient">Client *</label>
            <select id="paymentClient" required>
              <option value="">Sélectionner un client</option>
            </select>
          </div>
          <div class="form-group">
            <label for="paymentOrder">Commande associée</label>
            <select id="paymentOrder">
              <option value="">Sélectionner une commande (optionnel)</option>
            </select>
          </div>
          <div class="form-group">
            <label for="paymentAmount">Montant (DT) *</label>
            <input
              type="number"
              id="paymentAmount"
              step="0.01"
              min="0"
              required
              placeholder="0.00"
            />
          </div>
          <div class="form-group">
            <label for="paymentMethod">Méthode de paiement *</label>
            <select id="paymentMethod" required>
              <option value="">Sélectionner</option>
              <option value="Carte Bancaire">Carte Bancaire</option>
              <option value="Espèces">Espèces</option>
              <option value="Virement Bancaire">Virement Bancaire</option>
              <option value="Paiement Mobile">Paiement Mobile</option>
              <option value="Chèque">Chèque</option>
            </select>
          </div>
          <div class="form-group">
            <label for="paymentDate">Date du paiement *</label>
            <input type="date" id="paymentDate" required />
          </div>
          <div class="form-group">
            <label for="paymentStatus">Statut *</label>
            <select id="paymentStatus" required>
              <option value="completed">Complété</option>
              <option value="pending">En attente</option>
              <option value="failed">Échoué</option>
              <option value="refunded">Remboursé</option>
            </select>
          </div>
          <div class="form-group">
            <label for="paymentReference">Référence</label>
            <input
              type="text"
              id="paymentReference"
              placeholder="Référence du paiement"
            />
          </div>
          <div class="form-actions">
            <button type="button" class="btn btn-secondary close-modal">
              Annuler
            </button>
            <button type="submit" class="btn btn-primary">Enregistrer</button>
          </div>
        </form>
      </div>
    </div>

    <!-- MODAL DE DÉTAILS DE COMMANDE -->
    <div class="modal" id="orderDetailsModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title">
            Détails de la Commande #<span id="detailsOrderId"></span>
          </h3>
          <button class="close-modal">&times;</button>
        </div>
        <div style="margin-bottom: 24px">
          <div
            style="
              display: grid;
              grid-template-columns: 1fr 1fr;
              gap: 16px;
              margin-bottom: 20px;
            "
          >
            <div><strong>Client:</strong> <span id="detailsClient"></span></div>
            <div><strong>Date:</strong> <span id="detailsDate"></span></div>
            <div><strong>Statut:</strong> <span id="detailsStatus"></span></div>
            <div>
              <strong>Total:</strong> <span id="detailsTotal"></span> DT
            </div>
          </div>

          <h4
            style="
              margin: 20px 0 16px;
              color: var(--primary-color);
              font-weight: 600;
            "
          >
            Articles
          </h4>
          <div
            id="detailsItems"
            style="
              max-height: 300px;
              overflow-y: auto;
              background: var(--input-bg);
              border-radius: var(--radius-sm);
              padding: 16px;
              border: 1px solid var(--border-color);
            "
          >
            <!-- Les articles seront affichés ici -->
          </div>
        </div>

        <div class="form-actions">
          <button type="button" class="btn btn-secondary close-modal">
            Fermer
          </button>
        </div>
      </div>
    </div>

    <script>
      let clients = [
        {
          id: 1,
          name: "Ali Ben Salah",
          email: "ali@example.com",
          phone: "12345678",
          address: "Rue Habib Bourguiba, Tunis",
          city: "Tunis",
          orders: 5,
          createdAt: "2024-01-10",
        },
        {
          id: 2,
          name: "Fatma Trabelsi",
          email: "fatma@example.com",
          phone: "98765432",
          address: "Avenue Habib Thameur, Sfax",
          city: "Sfax",
          orders: 3,
          createdAt: "2024-01-12",
        },
        {
          id: 3,
          name: "Mohamed Amri",
          email: "mohamed@example.com",
          phone: "55667788",
          address: "Rue de la République, Sousse",
          city: "Sousse",
          orders: 7,
          createdAt: "2024-01-15",
        },
      ];

      let products = [
        {
          id: 1,
          name: "Croquettes Premium Chien",
          category: "Chien",
          price: 45.5,
          stock: 120,
          image:
            "https://images.unsplash.com/photo-1592924357228-91a4daadcfea?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
          description: "Croquettes premium pour chiens adultes - 10kg",
          createdAt: "2024-01-01",
        },
        {
          id: 2,
          name: "Pâtée Chat Adulte",
          category: "Chat",
          price: 12.9,
          stock: 80,
          image:
            "https://images.unsplash.com/photo-1574158622682-e40e69881006?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
          description: "Pâtée savoureuse pour chats adultes - Boîte de 12",
          createdAt: "2024-01-02",
        },
        {
          id: 3,
          name: "Graines pour Oiseaux",
          category: "Oiseau",
          price: 8.5,
          stock: 200,
          image:
            "https://images.unsplash.com/photo-1551085254-e96b210db58a?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
          description: "Mélange de graines pour oiseaux exotiques - 2kg",
          createdAt: "2024-01-03",
        },
        {
          id: 4,
          name: "Foin pour Rongeurs",
          category: "Rongeur",
          price: 6.9,
          stock: 150,
          image:
            "https://images.unsplash.com/photo-1597145128500-8c8489798a42?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
          description: "Foin frais pour lapins et rongeurs - 1kg",
          createdAt: "2024-01-04",
        },
        {
          id: 5,
          name: "Nourriture pour Poissons",
          category: "Poisson",
          price: 5.5,
          stock: 100,
          image:
            "https://images.unsplash.com/photo-1544551763-46a013bb70d5?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
          description: "Flocons pour poissons tropicaux - 200g",
          createdAt: "2024-01-05",
        },
      ];

      let orders = [
        {
          id: 1001,
          clientId: 1,
          clientName: "Ali Ben Salah",
          date: "2024-01-15",
          total: 89.5,
          status: "delivered",
          items: [
            {
              productId: 1,
              productName: "Croquettes Premium Chien",
              quantity: 2,
              price: 45.5,
              subtotal: 91,
            },
          ],
          createdAt: "2024-01-15",
        },
        {
          id: 1002,
          clientId: 2,
          clientName: "Fatma Trabelsi",
          date: "2024-01-16",
          total: 34.8,
          status: "processing",
          items: [
            {
              productId: 2,
              productName: "Pâtée Chat Adulte",
              quantity: 2,
              price: 12.9,
              subtotal: 25.8,
            },
            {
              productId: 3,
              productName: "Graines pour Oiseaux",
              quantity: 1,
              price: 8.5,
              subtotal: 8.5,
            },
          ],
          createdAt: "2024-01-16",
        },
        {
          id: 1003,
          clientId: 3,
          clientName: "Mohamed Amri",
          date: "2024-01-17",
          total: 156.2,
          status: "pending",
          items: [
            {
              productId: 1,
              productName: "Croquettes Premium Chien",
              quantity: 3,
              price: 45.5,
              subtotal: 136.5,
            },
            {
              productId: 4,
              productName: "Foin pour Rongeurs",
              quantity: 2,
              price: 6.9,
              subtotal: 13.8,
            },
          ],
          createdAt: "2024-01-17",
        },
      ];

      let reviews = [
        {
          id: 1,
          clientId: 1,
          clientName: "Ali Ben Salah",
          productId: 1,
          productName: "Croquettes Premium Chien",
          rating: 5,
          comment:
            "Excellent produit ! Mon chien adore ces croquettes. Livraison rapide et emballage soigné.",
          date: "2024-01-16",
          verified: true,
          response:
            "Merci pour votre confiance Ali ! Nous sommes ravis que votre compagnon apprécie nos produits.",
          createdAt: "2024-01-16",
        },
        {
          id: 2,
          clientId: 2,
          clientName: "Fatma Trabelsi",
          productId: 2,
          productName: "Pâtée Chat Adulte",
          rating: 4,
          comment:
            "Bonne qualité, mes chats aiment bien. Un peu cher mais la qualité est au rendez-vous.",
          date: "2024-01-17",
          verified: true,
          response: "",
          createdAt: "2024-01-17",
        },
        {
          id: 3,
          clientId: 3,
          clientName: "Mohamed Amri",
          productId: 1,
          productName: "Croquettes Premium Chien",
          rating: 5,
          comment:
            "Mon berger allemand est en pleine forme depuis que je lui donne ces croquettes. Recommandé !",
          date: "2024-01-18",
          verified: false,
          response: "",
          createdAt: "2024-01-18",
        },
        {
          id: 4,
          clientId: 1,
          clientName: "Ali Ben Salah",
          productId: 3,
          productName: "Graines pour Oiseaux",
          rating: 3,
          comment:
            "Les graines sont de bonne qualité mais l'emballage était un peu abîmé à l'arrivée.",
          date: "2024-01-19",
          verified: true,
          response:
            "Nous vous présentons nos excuses pour l'emballage. Nous avons pris des mesures pour améliorer notre processus d'emballage.",
          createdAt: "2024-01-19",
        },
      ];

      let payments = [
        {
          id: 1,
          clientId: 1,
          clientName: "Ali Ben Salah",
          orderId: 1001,
          amount: 89.5,
          method: "Carte Bancaire",
          date: "2024-01-15",
          status: "completed",
          reference: "PAY-001",
          createdAt: "2024-01-15",
        },
        {
          id: 2,
          clientId: 2,
          clientName: "Fatma Trabelsi",
          orderId: 1002,
          amount: 34.8,
          method: "Espèces",
          date: "2024-01-16",
          status: "completed",
          reference: "PAY-002",
          createdAt: "2024-01-16",
        },
        {
          id: 3,
          clientId: 3,
          clientName: "Mohamed Amri",
          orderId: 1003,
          amount: 156.2,
          method: "Virement Bancaire",
          date: "2024-01-17",
          status: "pending",
          reference: "PAY-003",
          createdAt: "2024-01-17",
        },
      ];

      let invoices = [
        {
          id: 1,
          date: "2024-01-15",
          client: "Ali Ben Salah",
          amount: 89.5,
          description: "Facture pour commande #1001",
          status: "payée",
        },
        {
          id: 2,
          date: "2024-01-16",
          client: "Fatma Trabelsi",
          amount: 34.8,
          description: "Facture pour commande #1002",
          status: "payée",
        },
      ];

      let history = [
        {
          date: "2024-01-17 10:30",
          user: "EL Jezi Ghassen",
          action: "Ajout client",
          details: "Nouveau client: Sami Khemiri",
        },
        {
          date: "2024-01-17 09:15",
          user: "EL Jezi Ghassen",
          action: "Commande",
          details: "Commande #1003 créée",
        },
        {
          date: "2024-01-16 16:45",
          user: "EL Jezi Ghassen",
          action: "Mise à jour produit",
          details: "Stock mis à jour pour Croquettes Premium",
        },
        {
          date: "2024-01-18 14:20",
          user: "EL Jezi Ghassen",
          action: "Ajout avis",
          details: "Nouvel avis de Ali Ben Salah",
        },
        {
          date: "2024-01-19 11:10",
          user: "EL Jezi Ghassen",
          action: "Réponse avis",
          details: "Réponse à l'avis de Mohamed Amri",
        },
      ];

      let currentOrderItems = [];
      let currentReviewRating = 0;

      let currentClients = [...clients];
      let currentProducts = [...products];
      let currentOrders = [...orders];
      let currentReviews = [...reviews];
      let currentPayments = [...payments];
      let currentInvoices = [...invoices];
      let currentHistory = [...history];

      function getStatusText(status) {
        const statusMap = {
          pending: "En attente",
          processing: "En traitement",
          delivered: "Livré",
          cancelled: "Annulé",
          completed: "Complété",
          failed: "Échoué",
          refunded: "Remboursé",
        };
        return statusMap[status] || status;
      }

      function getStatusClass(status) {
        const classMap = {
          pending: "status-pending",
          processing: "status-processing",
          delivered: "status-delivered",
          cancelled: "status-pending",
          completed: "status-delivered",
          failed: "status-pending",
          refunded: "status-processing",
        };
        return classMap[status] || "status-pending";
      }

      function getCategoryColor(category) {
        const colors = {
          Chien: "#4361ee",
          Chat: "#ef476f",
          Oiseau: "#ffd166",
          Rongeur: "#06d6a0",
          Poisson: "#7209b7",
          Autre: "#6c757d",
        };
        return colors[category] || "#4361ee";
      }

      function getPaymentMethodColor(method) {
        const colors = {
          "Carte Bancaire": "#4361ee",
          Espèces: "#06d6a0",
          "Virement Bancaire": "#7209b7",
          "Paiement Mobile": "#ffd166",
          Chèque: "#ef476f",
        };
        return colors[method] || "#4361ee";
      }

      function formatDate(dateString) {
        const date = new Date(dateString);
        return date.toLocaleDateString("fr-FR");
      }

      function formatDateTime(dateTimeString) {
        const date = new Date(dateTimeString);
        return date.toLocaleString("fr-FR");
      }

      function renderStars(rating) {
        let stars = "";
        for (let i = 1; i <= 5; i++) {
          if (i <= rating) {
            stars += '<i class="fas fa-star"></i>';
          } else {
            stars += '<i class="far fa-star"></i>';
          }
        }
        return `<span class="rating-stars">${stars}</span>`;
      }

      function searchDashboard() {
        const searchTerm = document
          .getElementById("dashboardSearch")
          .value.toLowerCase();
        const filterType = document.getElementById("dashboardFilter").value;

        if (!searchTerm.trim()) {
          clearDashboardSearch();
          return;
        }

        const filteredOrders = orders.filter((order) => {
          const orderText = {
            client: order.clientName.toLowerCase(),
            product: order.items
              .map((item) => item.productName.toLowerCase())
              .join(" "),
            status: getStatusText(order.status).toLowerCase(),
            all: `${order.clientName.toLowerCase()} ${order.items.map((item) => item.productName.toLowerCase()).join(" ")} ${getStatusText(order.status).toLowerCase()} ${order.total}`,
          };

          const textToSearch =
            filterType === "all" ? orderText.all : orderText[filterType];
          return textToSearch.includes(searchTerm);
        });

        displaySearchResults("dashboard", filteredOrders.length, orders.length);

        if (filteredOrders.length === 0) {
          document.getElementById("dashboardNoResults").style.display = "block";
          document.getElementById("recent-activity").innerHTML = "";
        } else {
          document.getElementById("dashboardNoResults").style.display = "none";
          renderFilteredOrders(filteredOrders);
        }
      }

      function renderFilteredOrders(filteredOrders) {
        const tbody = document.getElementById("recent-activity");
        tbody.innerHTML = "";

        filteredOrders.forEach((order) => {
          const statusClass = getStatusClass(order.status);
          const statusText = getStatusText(order.status);
          const firstItem =
            order.items.length > 0 ? order.items[0].productName : "N/A";

          const row = document.createElement("tr");
          row.innerHTML = `
            <td><strong>${order.clientName}</strong></td>
            <td>${firstItem}</td>
            <td>${formatDate(order.date)}</td>
            <td><strong style="color: var(--primary-color);">${order.total.toFixed(2)} DT</strong></td>
            <td><span class="status ${statusClass}">${statusText}</span></td>
          `;
          tbody.appendChild(row);
        });
      }

      function clearDashboardSearch() {
        document.getElementById("dashboardSearch").value = "";
        document.getElementById("dashboardFilter").value = "all";
        document.getElementById("dashboardResultsInfo").style.display = "none";
        document.getElementById("dashboardNoResults").style.display = "none";
        loadRecentActivity();
      }

      function searchClients() {
        const searchTerm = document
          .getElementById("clientsSearch")
          .value.toLowerCase();
        const filterType = document.getElementById("clientsFilter").value;

        if (!searchTerm.trim()) {
          clearClientsSearch();
          return;
        }

        const filteredClients = clients.filter((client) => {
          const clientText = {
            name: client.name.toLowerCase(),
            email: client.email.toLowerCase(),
            city: client.city.toLowerCase(),
            phone: client.phone.toLowerCase(),
            all: `${client.name.toLowerCase()} ${client.email.toLowerCase()} ${client.city.toLowerCase()} ${client.phone}`,
          };

          const textToSearch =
            filterType === "all" ? clientText.all : clientText[filterType];
          return textToSearch.includes(searchTerm);
        });

        currentClients = filteredClients;
        displaySearchResults("clients", filteredClients.length, clients.length);
        loadClients();
      }

      function clearClientsSearch() {
        document.getElementById("clientsSearch").value = "";
        document.getElementById("clientsFilter").value = "all";
        document.getElementById("clientsResultsInfo").style.display = "none";
        document.getElementById("clientsNoResults").style.display = "none";
        currentClients = [...clients];
        loadClients();
      }

      function searchProducts() {
        const searchTerm = document
          .getElementById("productsSearch")
          .value.toLowerCase();
        const filterType = document.getElementById("productsFilter").value;

        if (!searchTerm.trim()) {
          clearProductsSearch();
          return;
        }

        const filteredProducts = products.filter((product) => {
          const productText = {
            name: product.name.toLowerCase(),
            category: product.category.toLowerCase(),
            description: (product.description || "").toLowerCase(),
            all: `${product.name.toLowerCase()} ${product.category.toLowerCase()} ${(product.description || "").toLowerCase()}`,
          };

          const textToSearch =
            filterType === "all" ? productText.all : productText[filterType];
          return textToSearch.includes(searchTerm);
        });

        currentProducts = filteredProducts;
        displaySearchResults(
          "products",
          filteredProducts.length,
          products.length,
        );
        loadProducts();
      }

      function clearProductsSearch() {
        document.getElementById("productsSearch").value = "";
        document.getElementById("productsFilter").value = "all";
        document.getElementById("productsResultsInfo").style.display = "none";
        document.getElementById("productsNoResults").style.display = "none";
        currentProducts = [...products];
        loadProducts();
      }

      function searchOrders() {
        const searchTerm = document
          .getElementById("ordersSearch")
          .value.toLowerCase();
        const filterType = document.getElementById("ordersFilter").value;

        if (!searchTerm.trim()) {
          clearOrdersSearch();
          return;
        }

        const filteredOrders = orders.filter((order) => {
          const orderText = {
            id: order.id.toString(),
            client: order.clientName.toLowerCase(),
            status: getStatusText(order.status).toLowerCase(),
            date: order.date,
            all: `${order.id} ${order.clientName.toLowerCase()} ${getStatusText(order.status).toLowerCase()} ${order.date} ${order.total}`,
          };

          const textToSearch =
            filterType === "all" ? orderText.all : orderText[filterType];
          return textToSearch.toLowerCase().includes(searchTerm);
        });

        currentOrders = filteredOrders;
        displaySearchResults("orders", filteredOrders.length, orders.length);
        loadOrders();
      }

      function clearOrdersSearch() {
        document.getElementById("ordersSearch").value = "";
        document.getElementById("ordersFilter").value = "all";
        document.getElementById("ordersResultsInfo").style.display = "none";
        document.getElementById("ordersNoResults").style.display = "none";
        currentOrders = [...orders];
        loadOrders();
      }

      function searchReviews() {
        const searchTerm = document
          .getElementById("reviewsSearch")
          .value.toLowerCase();
        const filterType = document.getElementById("reviewsFilter").value;

        if (!searchTerm.trim()) {
          clearReviewsSearch();
          return;
        }

        const filteredReviews = reviews.filter((review) => {
          const reviewText = {
            client: review.clientName.toLowerCase(),
            product: review.productName.toLowerCase(),
            rating: review.rating.toString(),
            comment: review.comment.toLowerCase(),
            verified: review.verified ? "vérifié" : "non vérifié",
            all: `${review.clientName.toLowerCase()} ${review.productName.toLowerCase()} ${review.rating} ${review.comment.toLowerCase()} ${review.verified ? "vérifié" : "non vérifié"}`,
          };

          const textToSearch =
            filterType === "all" ? reviewText.all : reviewText[filterType];
          return textToSearch.includes(searchTerm);
        });

        currentReviews = filteredReviews;
        displaySearchResults("reviews", filteredReviews.length, reviews.length);
        loadReviews();
      }

      function clearReviewsSearch() {
        document.getElementById("reviewsSearch").value = "";
        document.getElementById("reviewsFilter").value = "all";
        document.getElementById("reviewsResultsInfo").style.display = "none";
        document.getElementById("reviewsNoResults").style.display = "none";
        currentReviews = [...reviews];
        loadReviews();
      }

      function searchPayments() {
        const searchTerm = document
          .getElementById("paymentsSearch")
          .value.toLowerCase();
        const filterType = document.getElementById("paymentsFilter").value;

        if (!searchTerm.trim()) {
          clearPaymentsSearch();
          return;
        }

        const filteredPayments = payments.filter((payment) => {
          const paymentText = {
            client: payment.clientName.toLowerCase(),
            method: payment.method.toLowerCase(),
            status: getStatusText(payment.status).toLowerCase(),
            reference: (payment.reference || "").toLowerCase(),
            all: `${payment.clientName.toLowerCase()} ${payment.method.toLowerCase()} ${getStatusText(payment.status).toLowerCase()} ${payment.reference || ""} ${payment.amount}`,
          };

          const textToSearch =
            filterType === "all" ? paymentText.all : paymentText[filterType];
          return textToSearch.includes(searchTerm);
        });

        currentPayments = filteredPayments;
        displaySearchResults(
          "payments",
          filteredPayments.length,
          payments.length,
        );
        loadPayments();
      }

      function clearPaymentsSearch() {
        document.getElementById("paymentsSearch").value = "";
        document.getElementById("paymentsFilter").value = "all";
        document.getElementById("paymentsResultsInfo").style.display = "none";
        document.getElementById("paymentsNoResults").style.display = "none";
        currentPayments = [...payments];
        loadPayments();
      }

      function searchInvoices() {
        const searchTerm = document
          .getElementById("invoicesSearch")
          .value.toLowerCase();
        const filterType = document.getElementById("invoicesFilter").value;

        if (!searchTerm.trim()) {
          clearInvoicesSearch();
          return;
        }

        const filteredInvoices = invoices.filter((invoice) => {
          const invoiceText = {
            client: invoice.client.toLowerCase(),
            amount: invoice.amount.toString(),
            description: (invoice.description || "").toLowerCase(),
            status: invoice.status.toLowerCase(),
            all: `${invoice.client.toLowerCase()} ${invoice.amount} ${invoice.description || ""} ${invoice.status.toLowerCase()}`,
          };

          const textToSearch =
            filterType === "all" ? invoiceText.all : invoiceText[filterType];
          return textToSearch.includes(searchTerm);
        });

        currentInvoices = filteredInvoices;
        displaySearchResults(
          "invoices",
          filteredInvoices.length,
          invoices.length,
        );
        loadInvoices();
      }

      function clearInvoicesSearch() {
        document.getElementById("invoicesSearch").value = "";
        document.getElementById("invoicesFilter").value = "all";
        document.getElementById("invoicesResultsInfo").style.display = "none";
        document.getElementById("invoicesNoResults").style.display = "none";
        currentInvoices = [...invoices];
        loadInvoices();
      }

      function searchHistory() {
        const searchTerm = document
          .getElementById("historySearch")
          .value.toLowerCase();
        const filterType = document.getElementById("historyFilter").value;

        if (!searchTerm.trim()) {
          clearHistorySearch();
          return;
        }

        const filteredHistory = history.filter((item) => {
          const historyText = {
            user: item.user.toLowerCase(),
            action: item.action.toLowerCase(),
            details: item.details.toLowerCase(),
            date: item.date.toLowerCase(),
            all: `${item.user.toLowerCase()} ${item.action.toLowerCase()} ${item.details.toLowerCase()} ${item.date.toLowerCase()}`,
          };

          const textToSearch =
            filterType === "all" ? historyText.all : historyText[filterType];
          return textToSearch.includes(searchTerm);
        });

        currentHistory = filteredHistory;
        displaySearchResults("history", filteredHistory.length, history.length);
        loadHistory();
      }

      function clearHistorySearch() {
        document.getElementById("historySearch").value = "";
        document.getElementById("historyFilter").value = "all";
        document.getElementById("historyResultsInfo").style.display = "none";
        document.getElementById("historyNoResults").style.display = "none";
        currentHistory = [...history];
        loadHistory();
      }

      function displaySearchResults(section, filteredCount, totalCount) {
        const resultsInfo = document.getElementById(`${section}ResultsInfo`);
        const resultsCount = document.getElementById(`${section}ResultsCount`);
        const noResults = document.getElementById(`${section}NoResults`);

        if (filteredCount === 0) {
          resultsInfo.style.display = "none";
          noResults.style.display = "block";
        } else {
          resultsInfo.style.display = "flex";
          noResults.style.display = "none";
          resultsCount.innerHTML = `
            <div>
              <strong>${filteredCount}</strong> résultat${filteredCount > 1 ? "s" : ""} sur ${totalCount}
            </div>
          `;
        }
      }

      function loadReviews() {
        const tbody = document.getElementById("reviews-table");
        tbody.innerHTML = "";

        if (currentReviews.length === 0) {
          tbody.innerHTML = `
            <tr>
              <td colspan="8" style="text-align: center; padding: 3rem; color: var(--text-light);">
                <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
                Aucun avis à afficher
              </td>
            </tr>
          `;
          return;
        }

        currentReviews.forEach((review) => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${review.id}</td>
            <td><strong>${review.clientName}</strong></td>
            <td>${review.productName}</td>
            <td>${renderStars(review.rating)}</td>
            <td>
              <div class="review-content">${review.comment}</div>
              ${
                review.response
                  ? `
                <div style="margin-top: 0.5rem; padding: 0.5rem; background: var(--primary-light); border-radius: var(--radius-sm); font-size: 0.9rem;">
                  <strong><i class="fas fa-reply"></i> Réponse:</strong> ${review.response}
                </div>
              `
                  : ""
              }
            </td>
            <td>${formatDate(review.date)}</td>
            <td>
              ${
                review.verified
                  ? '<span style="color: var(--success-color);"><i class="fas fa-check-circle"></i> Vérifié</span>'
                  : '<span style="color: var(--warning-color);"><i class="fas fa-clock"></i> En attente</span>'
              }
            </td>
            <td>
              <button class="action-btn" onclick="editReview(${review.id})" title="Modifier">
                <i class="fas fa-edit"></i>
              </button>
              <button class="action-btn" onclick="toggleReviewVerification(${review.id})" title="${review.verified ? "Désactiver" : "Vérifier"}">
                <i class="fas ${review.verified ? "fa-times" : "fa-check"}"></i>
              </button>
              <button class="action-btn" onclick="deleteReview(${review.id})" title="Supprimer">
                <i class="fas fa-trash"></i>
              </button>
            </td>
          `;
          tbody.appendChild(row);
        });

        updateReviewsStats();
        updateReviewsBadge();
      }

      function openReviewModal(reviewId = null) {
        const modal = document.getElementById("reviewModal");
        const title = document.getElementById("reviewModalTitle");
        const form = document.getElementById("reviewForm");

        const clientSelect = document.getElementById("reviewClient");
        clientSelect.innerHTML =
          '<option value="">Sélectionner un client</option>';
        clients.forEach((client) => {
          const option = document.createElement("option");
          option.value = client.id;
          option.textContent = client.name;
          clientSelect.appendChild(option);
        });

        const productSelect = document.getElementById("reviewProduct");
        productSelect.innerHTML =
          '<option value="">Sélectionner un produit</option>';
        products.forEach((product) => {
          const option = document.createElement("option");
          option.value = product.id;
          option.textContent = product.name;
          productSelect.appendChild(option);
        });

        initStarRating();

        if (reviewId) {
          title.textContent = "Modifier l'avis";
          const review = reviews.find((r) => r.id == reviewId);
          if (review) {
            document.getElementById("reviewId").value = review.id;
            document.getElementById("reviewClient").value = review.clientId;
            document.getElementById("reviewProduct").value = review.productId;
            document.getElementById("reviewRating").value = review.rating;
            document.getElementById("reviewComment").value = review.comment;
            document.getElementById("reviewDate").value = review.date;
            document.getElementById("reviewVerified").value = review.verified;
            document.getElementById("reviewResponse").value =
              review.response || "";

            currentReviewRating = review.rating;
            updateStarDisplay(review.rating);
          }
        } else {
          title.textContent = "Ajouter un avis";
          form.reset();
          document.getElementById("reviewId").value = "";
          document.getElementById("reviewDate").value = new Date()
            .toISOString()
            .split("T")[0];
          document.getElementById("reviewVerified").value = "true";
          document.getElementById("reviewRating").value = "0";

          currentReviewRating = 0;
          updateStarDisplay(0);
        }

        modal.style.display = "flex";
      }

      function initStarRating() {
        const stars = document.querySelectorAll("#starRating .star");
        stars.forEach((star) => {
          star.addEventListener("click", function () {
            const rating = parseInt(this.getAttribute("data-value"));
            currentReviewRating = rating;
            document.getElementById("reviewRating").value = rating;
            updateStarDisplay(rating);
          });

          star.addEventListener("mouseover", function () {
            const rating = parseInt(this.getAttribute("data-value"));
            updateStarDisplay(rating, true);
          });
        });

        document
          .getElementById("starRating")
          .addEventListener("mouseleave", function () {
            updateStarDisplay(currentReviewRating);
          });
      }

      function updateStarDisplay(rating, isHover = false) {
        const stars = document.querySelectorAll("#starRating .star");
        stars.forEach((star, index) => {
          const starValue = index + 1;
          if (
            isHover ? starValue <= rating : starValue <= currentReviewRating
          ) {
            star.innerHTML = '<i class="fas fa-star"></i>';
            star.classList.add("active");
          } else {
            star.innerHTML = '<i class="far fa-star"></i>';
            star.classList.remove("active");
          }
        });
      }

      function saveReview(e) {
        e.preventDefault();

        const id = document.getElementById("reviewId").value;
        const clientId = document.getElementById("reviewClient").value;
        const productId = document.getElementById("reviewProduct").value;
        const rating = parseInt(document.getElementById("reviewRating").value);
        const comment = document.getElementById("reviewComment").value;
        const date = document.getElementById("reviewDate").value;
        const verified =
          document.getElementById("reviewVerified").value === "true";
        const response = document.getElementById("reviewResponse").value;

        if (!clientId || !productId || !rating || !comment || !date) {
          alert("Veuillez remplir tous les champs obligatoires");
          return;
        }

        const client = clients.find((c) => c.id == clientId);
        const product = products.find((p) => p.id == productId);

        if (id) {
          const index = reviews.findIndex((r) => r.id == id);
          reviews[index] = {
            ...reviews[index],
            clientId,
            clientName: client.name,
            productId,
            productName: product.name,
            rating,
            comment,
            date,
            verified,
            response,
          };
          addToHistory("Modification avis", `Avis #${id} modifié`);
        } else {
          const newId =
            reviews.length > 0 ? Math.max(...reviews.map((r) => r.id)) + 1 : 1;
          reviews.push({
            id: newId,
            clientId,
            clientName: client.name,
            productId,
            productName: product.name,
            rating,
            comment,
            date,
            verified,
            response: response || "",
            createdAt: new Date().toISOString().split("T")[0],
          });
          addToHistory("Ajout avis", `Nouvel avis #${newId}`);
        }

        loadReviews();
        closeAllModals();
      }

      function editReview(id) {
        openReviewModal(id);
      }

      function toggleReviewVerification(id) {
        const review = reviews.find((r) => r.id == id);
        if (review) {
          review.verified = !review.verified;
          loadReviews();
          addToHistory(
            review.verified ? "Vérification avis" : "Désactivation avis",
            `Avis #${id} ${review.verified ? "vérifié" : "désactivé"}`,
          );
        }
      }

      function deleteReview(id) {
        if (confirm("Êtes-vous sûr de vouloir supprimer cet avis ?")) {
          const review = reviews.find((r) => r.id == id);
          reviews = reviews.filter((r) => r.id != id);
          currentReviews = currentReviews.filter((r) => r.id != id);
          loadReviews();
          addToHistory("Suppression avis", `Avis #${id} supprimé`);
        }
      }

      function updateReviewsStats() {
        if (reviews.length === 0) {
          document.getElementById("average-rating").textContent = "0/5";
          document.getElementById("total-reviews").textContent = "0";
          document.getElementById("positive-reviews").textContent = "0%";
          return;
        }

        const totalRating = reviews.reduce(
          (sum, review) => sum + review.rating,
          0,
        );
        const averageRating = (totalRating / reviews.length).toFixed(1);
        document.getElementById("average-rating").textContent =
          `${averageRating}/5`;

        document.getElementById("total-reviews").textContent = reviews.length;

        const positiveReviews = reviews.filter(
          (review) => review.rating >= 4,
        ).length;
        const positivePercentage = Math.round(
          (positiveReviews / reviews.length) * 100,
        );
        document.getElementById("positive-reviews").textContent =
          `${positivePercentage}%`;
        document.querySelector("#reviews .progress-fill").style.width =
          `${positivePercentage}%`;
      }

      function updateReviewsBadge() {
        const pendingReviews = reviews.filter((r) => !r.verified).length;
        document.getElementById("reviews-badge").textContent = pendingReviews;
        document.getElementById("reviews-badge").style.display =
          pendingReviews > 0 ? "flex" : "none";
      }

      function loadClients() {
        const tbody = document.getElementById("clients-table");
        tbody.innerHTML = "";

        if (currentClients.length === 0) {
          tbody.innerHTML = `
            <tr>
              <td colspan="7" style="text-align: center; padding: 3rem; color: var(--text-light);">
                <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
                Aucun client à afficher
              </td>
            </tr>
          `;
          return;
        }

        currentClients.forEach((client) => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${client.id}</td>
            <td><strong>${client.name}</strong></td>
            <td>${client.email}</td>
            <td>${client.phone}</td>
            <td><span style="background: var(--primary-light); padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: 500;">${client.city}</span></td>
            <td><span style="color: var(--primary-color); font-weight: bold; font-size: 16px;">${client.orders}</span></td>
            <td>
                <button class="action-btn" onclick="editClient(${client.id})" title="Modifier">
                    <i class="fas fa-edit"></i>
                </button>
                <button class="action-btn" onclick="deleteClient(${client.id})" title="Supprimer">
                    <i class="fas fa-trash"></i>
                </button>
            </td>
          `;
          tbody.appendChild(row);
        });

        updateClientsBadge();
        updateDashboardStats();
      }

      function openClientModal(clientId = null) {
        const modal = document.getElementById("clientModal");
        const title = document.getElementById("clientModalTitle");
        const form = document.getElementById("clientForm");

        if (clientId) {
          title.textContent = "Modifier le client";
          const client = clients.find((c) => c.id == clientId);
          if (client) {
            document.getElementById("clientId").value = client.id;
            document.getElementById("clientName").value = client.name;
            document.getElementById("clientEmail").value = client.email;
            document.getElementById("clientPhone").value = client.phone;
            document.getElementById("clientAddress").value =
              client.address || "";
            document.getElementById("clientCity").value = client.city;
          }
        } else {
          title.textContent = "Ajouter un client";
          form.reset();
          document.getElementById("clientId").value = "";
          document.getElementById("clientCity").value = "Tunis";
        }

        modal.style.display = "flex";
      }

      function saveClient(e) {
        e.preventDefault();

        const id = document.getElementById("clientId").value;
        const name = document.getElementById("clientName").value;
        const email = document.getElementById("clientEmail").value;
        const phone = document.getElementById("clientPhone").value;
        const address = document.getElementById("clientAddress").value;
        const city = document.getElementById("clientCity").value;

        if (id) {
          const index = clients.findIndex((c) => c.id == id);
          clients[index] = {
            ...clients[index],
            name,
            email,
            phone,
            address,
            city,
          };
          addToHistory("Modification client", `Client ${name} modifié`);
        } else {
          const newId =
            clients.length > 0 ? Math.max(...clients.map((c) => c.id)) + 1 : 1;
          clients.push({
            id: newId,
            name,
            email,
            phone,
            address,
            city,
            orders: 0,
            createdAt: new Date().toISOString().split("T")[0],
          });
          addToHistory("Ajout client", `Nouveau client: ${name}`);
        }

        currentClients = [...clients];
        loadClients();
        closeAllModals();
        populateClientSelects();
      }

      function editClient(id) {
        openClientModal(id);
      }

      function deleteClient(id) {
        if (confirm("Êtes-vous sûr de vouloir supprimer ce client ?")) {
          const client = clients.find((c) => c.id == id);
          clients = clients.filter((c) => c.id != id);
          currentClients = currentClients.filter((c) => c.id != id);
          loadClients();
          addToHistory("Suppression client", `Client ${client.name} supprimé`);
        }
      }

      function loadProducts() {
        const tbody = document.getElementById("products-table");
        tbody.innerHTML = "";

        if (currentProducts.length === 0) {
          tbody.innerHTML = `
            <tr>
              <td colspan="6" style="text-align: center; padding: 3rem; color: var(--text-light);">
                <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
                Aucun produit à afficher
              </td>
            </tr>
          `;
          return;
        }

        currentProducts.forEach((product) => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td>
                <img src="${product.image}" alt="${product.name}" class="product-image" 
                     onerror="this.src='https://images.unsplash.com/photo-1541364983171-a8ba01e95cfc?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80'">
            </td>
            <td>
                <div class="product-card">
                    <div>
                        <strong>${product.name}</strong>
                        <div style="font-size: 13px; color: var(--text-light); margin-top: 4px;">${product.description || ""}</div>
                    </div>
                </div>
            </td>
            <td>
                <span style="background: ${getCategoryColor(product.category)}; color: white; padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: 500;">
                    ${product.category}
                </span>
            </td>
            <td><strong style="color: var(--primary-color); font-size: 16px;">${product.price.toFixed(2)} DT</strong></td>
            <td>
                <span style="color: ${product.stock < 50 ? "var(--danger-color)" : "var(--success-color)"}; font-weight: bold;">
                    ${product.stock} unités
                </span>
            </td>
            <td>
                <button class="action-btn" onclick="editProduct(${product.id})" title="Modifier">
                    <i class="fas fa-edit"></i>
                </button>
                <button class="action-btn" onclick="deleteProduct(${product.id})" title="Supprimer">
                    <i class="fas fa-trash"></i>
                </button>
            </td>
          `;
          tbody.appendChild(row);
        });
      }

      function openProductModal(productId = null) {
        const modal = document.getElementById("productModal");
        const title = document.getElementById("productModalTitle");
        const form = document.getElementById("productForm");

        if (productId) {
          title.textContent = "Modifier le produit";
          const product = products.find((p) => p.id == productId);
          if (product) {
            document.getElementById("productId").value = product.id;
            document.getElementById("productName").value = product.name;
            document.getElementById("productImage").value = product.image;
            document.getElementById("productCategory").value = product.category;
            document.getElementById("productPrice").value = product.price;
            document.getElementById("productStock").value = product.stock;
            document.getElementById("productDescription").value =
              product.description || "";
          }
        } else {
          title.textContent = "Ajouter un produit";
          form.reset();
          document.getElementById("productId").value = "";
          document.getElementById("productCategory").value = "";
          document.getElementById("productImage").value =
            "https://images.unsplash.com/photo-1592924357228-91a4daadcfea?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80";
        }

        modal.style.display = "flex";
      }

      function saveProduct(e) {
        e.preventDefault();

        const id = document.getElementById("productId").value;
        const name = document.getElementById("productName").value;
        const image =
          document.getElementById("productImage").value ||
          "https://images.unsplash.com/photo-1541364983171-a8ba01e95cfc?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80";
        const category = document.getElementById("productCategory").value;
        const price = parseFloat(document.getElementById("productPrice").value);
        const stock = parseInt(document.getElementById("productStock").value);
        const description = document.getElementById("productDescription").value;

        if (id) {
          const index = products.findIndex((p) => p.id == id);
          products[index] = {
            ...products[index],
            name,
            image,
            category,
            price,
            stock,
            description,
          };
          addToHistory("Modification produit", `Produit ${name} modifié`);
        } else {
          const newId =
            products.length > 0
              ? Math.max(...products.map((p) => p.id)) + 1
              : 1;
          products.push({
            id: newId,
            name,
            image,
            category,
            price,
            stock,
            description,
            createdAt: new Date().toISOString().split("T")[0],
          });
          addToHistory("Ajout produit", `Nouveau produit: ${name}`);
        }

        currentProducts = [...products];
        loadProducts();
        closeAllModals();
      }

      function editProduct(id) {
        openProductModal(id);
      }

      function deleteProduct(id) {
        if (confirm("Êtes-vous sûr de vouloir supprimer ce produit ?")) {
          const product = products.find((p) => p.id == id);
          products = products.filter((p) => p.id != id);
          currentProducts = currentProducts.filter((p) => p.id != id);
          loadProducts();
          addToHistory(
            "Suppression produit",
            `Produit ${product.name} supprimé`,
          );
        }
      }

      function loadOrders() {
        const tbody = document.getElementById("orders-table");
        tbody.innerHTML = "";

        if (currentOrders.length === 0) {
          tbody.innerHTML = `
            <tr>
              <td colspan="6" style="text-align: center; padding: 3rem; color: var(--text-light);">
                <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
                Aucune commande à afficher
              </td>
            </tr>
          `;
          return;
        }

        currentOrders.forEach((order) => {
          const statusClass = getStatusClass(order.status);
          const statusText = getStatusText(order.status);

          const row = document.createElement("tr");
          row.innerHTML = `
            <td><strong style="color: var(--primary-color);">#${order.id}</strong></td>
            <td><strong>${order.clientName}</strong></td>
            <td>${formatDate(order.date)}</td>
            <td><strong style="color: var(--success-color); font-size: 16px;">${order.total.toFixed(2)} DT</strong></td>
            <td><span class="status ${statusClass}">${statusText}</span></td>
            <td>
                <button class="action-btn" onclick="viewOrderDetails(${order.id})" title="Voir détails">
                    <i class="fas fa-eye"></i>
                </button>
                <button class="action-btn" onclick="editOrder(${order.id})" title="Modifier">
                    <i class="fas fa-edit"></i>
                </button>
                <button class="action-btn" onclick="deleteOrder(${order.id})" title="Supprimer">
                    <i class="fas fa-trash"></i>
                </button>
            </td>
          `;
          tbody.appendChild(row);
        });

        updateOrdersBadge();
        updateDashboardStats();
      }

      function openOrderModal(orderId = null) {
        const modal = document.getElementById("orderModal");
        const title = document.getElementById("orderModalTitle");
        const form = document.getElementById("orderForm");

        const clientSelect = document.getElementById("orderClient");
        clientSelect.innerHTML =
          '<option value="">Sélectionner un client</option>';
        clients.forEach((client) => {
          const option = document.createElement("option");
          option.value = client.id;
          option.textContent = client.name;
          clientSelect.appendChild(option);
        });

        if (orderId) {
          title.textContent = "Modifier la commande";
          const order = orders.find((o) => o.id == orderId);
          if (order) {
            document.getElementById("orderId").value = order.id;
            document.getElementById("orderClient").value = order.clientId;
            document.getElementById("orderDate").value = order.date;
            document.getElementById("orderStatus").value = order.status;

            currentOrderItems = [...order.items];
            renderOrderItems();
            updateOrderTotal();
          }
        } else {
          title.textContent = "Nouvelle commande";
          form.reset();
          document.getElementById("orderId").value = "";
          document.getElementById("orderDate").value = new Date()
            .toISOString()
            .split("T")[0];
          document.getElementById("orderStatus").value = "pending";

          currentOrderItems = [];
          document.getElementById("orderItemsContainer").innerHTML = "";
          document.getElementById("orderTotal").textContent = "0.00 DT";
        }

        modal.style.display = "flex";
      }

      function addOrderItem() {
        const item = {
          id: Date.now(),
          productId: "",
          productName: "",
          quantity: 1,
          price: 0,
          subtotal: 0,
        };

        currentOrderItems.push(item);
        renderOrderItems();
        updateOrderTotal();
      }

      function removeOrderItem(itemId) {
        currentOrderItems = currentOrderItems.filter(
          (item) => item.id !== itemId,
        );
        renderOrderItems();
        updateOrderTotal();
      }

      function updateOrderItem(itemId, field, value) {
        const item = currentOrderItems.find((item) => item.id === itemId);
        if (item) {
          item[field] = value;

          if (field === "productId") {
            const product = products.find((p) => p.id == value);
            if (product) {
              item.productName = product.name;
              item.price = product.price;
              item.subtotal = item.quantity * product.price;
            }
          } else if (field === "quantity") {
            item.quantity = parseInt(value) || 1;
            item.subtotal = item.quantity * item.price;
          }

          updateOrderTotal();
        }
      }

      function renderOrderItems() {
        const container = document.getElementById("orderItemsContainer");
        container.innerHTML = "";

        currentOrderItems.forEach((item) => {
          const itemDiv = document.createElement("div");
          itemDiv.className = "order-item";
          itemDiv.innerHTML = `
            <div style="flex: 1;">
                <select onchange="updateOrderItem(${item.id}, 'productId', this.value)" style="width: 100%; padding: 8px 12px; border: 2px solid var(--border-color); border-radius: var(--radius-sm); background: var(--input-bg); color: var(--text-color);">
                    <option value="">Sélectionner un produit</option>
                    ${products
                      .map(
                        (p) => `
                        <option value="${p.id}" ${p.id == item.productId ? "selected" : ""}>
                            ${p.name} - ${p.price.toFixed(2)} DT
                        </option>
                    `,
                      )
                      .join("")}
                </select>
            </div>
            <div class="item-controls">
                <input type="number" 
                       class="item-quantity" 
                       value="${item.quantity}" 
                       min="1" 
                       onchange="updateOrderItem(${item.id}, 'quantity', this.value)">
                <span style="font-weight: 600; color: var(--primary-color);">${item.subtotal.toFixed(2)} DT</span>
                <button class="action-btn" onclick="removeOrderItem(${item.id})" title="Supprimer">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
          `;
          container.appendChild(itemDiv);
        });
      }

      function updateOrderTotal() {
        const total = currentOrderItems.reduce(
          (sum, item) => sum + item.subtotal,
          0,
        );
        document.getElementById("orderTotal").textContent =
          total.toFixed(2) + " DT";
      }

      function saveOrder(e) {
        e.preventDefault();

        const orderId = document.getElementById("orderId").value;
        const clientId = document.getElementById("orderClient").value;
        const date = document.getElementById("orderDate").value;
        const status = document.getElementById("orderStatus").value;

        if (!clientId) {
          alert("Veuillez sélectionner un client");
          return;
        }

        if (currentOrderItems.length === 0) {
          alert("Veuillez ajouter au moins un article à la commande");
          return;
        }

        const client = clients.find((c) => c.id == clientId);
        const total = currentOrderItems.reduce(
          (sum, item) => sum + item.subtotal,
          0,
        );

        if (orderId) {
          const index = orders.findIndex((o) => o.id == orderId);
          orders[index] = {
            ...orders[index],
            clientId,
            clientName: client.name,
            date,
            total,
            status,
            items: [...currentOrderItems],
          };
          addToHistory(
            "Modification commande",
            `Commande #${orderId} modifiée`,
          );
        } else {
          const newId =
            orders.length > 0 ? Math.max(...orders.map((o) => o.id)) + 1 : 1001;
          orders.push({
            id: newId,
            clientId,
            clientName: client.name,
            date,
            total,
            status,
            items: [...currentOrderItems],
            createdAt: new Date().toISOString().split("T")[0],
          });
          addToHistory("Ajout commande", `Nouvelle commande #${newId} créée`);
        }

        currentOrders = [...orders];
        loadOrders();
        loadRecentActivity();
        closeAllModals();
        updateDashboardStats();
      }

      function editOrder(orderId) {
        openOrderModal(orderId);
      }

      function deleteOrder(orderId) {
        if (confirm("Êtes-vous sûr de vouloir supprimer cette commande ?")) {
          const order = orders.find((o) => o.id == orderId);
          orders = orders.filter((o) => o.id != orderId);
          currentOrders = currentOrders.filter((o) => o.id != orderId);
          loadOrders();
          addToHistory(
            "Suppression commande",
            `Commande #${orderId} supprimée`,
          );
        }
      }

      function viewOrderDetails(orderId) {
        const order = orders.find((o) => o.id == orderId);
        if (!order) return;

        document.getElementById("detailsOrderId").textContent = order.id;
        document.getElementById("detailsClient").textContent = order.clientName;
        document.getElementById("detailsDate").textContent = formatDate(
          order.date,
        );
        document.getElementById("detailsStatus").innerHTML =
          `<span class="status ${getStatusClass(order.status)}">${getStatusText(order.status)}</span>`;
        document.getElementById("detailsTotal").textContent =
          order.total.toFixed(2);

        const itemsContainer = document.getElementById("detailsItems");
        itemsContainer.innerHTML = "";

        order.items.forEach((item) => {
          const itemDiv = document.createElement("div");
          itemDiv.className = "order-item";
          itemDiv.innerHTML = `
            <div style="flex: 1;">
                <strong>${item.productName}</strong>
            </div>
            <div style="font-weight: 600; color: var(--primary-color);">
                ${item.quantity} × ${item.price.toFixed(2)} DT = ${item.subtotal.toFixed(2)} DT
            </div>
          `;
          itemsContainer.appendChild(itemDiv);
        });

        document.getElementById("orderDetailsModal").style.display = "flex";
      }

      function loadPayments() {
        const tbody = document.getElementById("payments-table");
        tbody.innerHTML = "";

        if (currentPayments.length === 0) {
          tbody.innerHTML = `
            <tr>
              <td colspan="7" style="text-align: center; padding: 3rem; color: var(--text-light);">
                <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
                Aucun paiement à afficher
              </td>
            </tr>
          `;
          return;
        }

        currentPayments.forEach((payment) => {
          const statusClass = getStatusClass(payment.status);
          const statusText = getStatusText(payment.status);

          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${payment.id}</td>
            <td><strong>${payment.clientName}</strong></td>
            <td><strong style="color: var(--primary-color); font-size: 16px;">${payment.amount.toFixed(2)} DT</strong></td>
            <td>
                <span style="background: ${getPaymentMethodColor(payment.method)}; color: white; padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: 500;">
                    ${payment.method}
                </span>
            </td>
            <td>${formatDate(payment.date)}</td>
            <td><span class="status ${statusClass}">${statusText}</span></td>
            <td>
                <button class="action-btn" onclick="editPayment(${payment.id})" title="Modifier">
                    <i class="fas fa-edit"></i>
                </button>
                <button class="action-btn" onclick="deletePayment(${payment.id})" title="Supprimer">
                    <i class="fas fa-trash"></i>
                </button>
            </td>
          `;
          tbody.appendChild(row);
        });
      }

      function openPaymentModal(paymentId = null) {
        const modal = document.getElementById("paymentModal");
        const title = document.getElementById("paymentModalTitle");
        const form = document.getElementById("paymentForm");

        const clientSelect = document.getElementById("paymentClient");
        clientSelect.innerHTML =
          '<option value="">Sélectionner un client</option>';
        clients.forEach((client) => {
          const option = document.createElement("option");
          option.value = client.id;
          option.textContent = client.name;
          clientSelect.appendChild(option);
        });

        const orderSelect = document.getElementById("paymentOrder");
        orderSelect.innerHTML =
          '<option value="">Sélectionner une commande (optionnel)</option>';
        orders.forEach((order) => {
          const option = document.createElement("option");
          option.value = order.id;
          option.textContent = `Commande #${order.id} - ${order.clientName} - ${order.total.toFixed(2)} DT`;
          orderSelect.appendChild(option);
        });

        if (paymentId) {
          title.textContent = "Modifier le paiement";
          const payment = payments.find((p) => p.id == paymentId);
          if (payment) {
            document.getElementById("paymentId").value = payment.id;
            document.getElementById("paymentClient").value = payment.clientId;
            document.getElementById("paymentOrder").value =
              payment.orderId || "";
            document.getElementById("paymentAmount").value = payment.amount;
            document.getElementById("paymentMethod").value = payment.method;
            document.getElementById("paymentDate").value = payment.date;
            document.getElementById("paymentStatus").value = payment.status;
            document.getElementById("paymentReference").value =
              payment.reference || "";
          }
        } else {
          title.textContent = "Ajouter un paiement";
          form.reset();
          document.getElementById("paymentId").value = "";
          document.getElementById("paymentDate").value = new Date()
            .toISOString()
            .split("T")[0];
          document.getElementById("paymentStatus").value = "completed";
          document.getElementById("paymentMethod").value = "";
        }

        modal.style.display = "flex";
      }

      function savePayment(e) {
        e.preventDefault();

        const id = document.getElementById("paymentId").value;
        const clientId = document.getElementById("paymentClient").value;
        const orderId = document.getElementById("paymentOrder").value;
        const amount = parseFloat(
          document.getElementById("paymentAmount").value,
        );
        const method = document.getElementById("paymentMethod").value;
        const date = document.getElementById("paymentDate").value;
        const status = document.getElementById("paymentStatus").value;
        const reference = document.getElementById("paymentReference").value;

        if (!clientId) {
          alert("Veuillez sélectionner un client");
          return;
        }

        const client = clients.find((c) => c.id == clientId);

        if (id) {
          const index = payments.findIndex((p) => p.id == id);
          payments[index] = {
            ...payments[index],
            clientId,
            clientName: client.name,
            orderId: orderId || null,
            amount,
            method,
            date,
            status,
            reference,
          };
          addToHistory("Modification paiement", `Paiement #${id} modifié`);
        } else {
          const newId =
            payments.length > 0
              ? Math.max(...payments.map((p) => p.id)) + 1
              : 1;
          payments.push({
            id: newId,
            clientId,
            clientName: client.name,
            orderId: orderId || null,
            amount,
            method,
            date,
            status,
            reference: reference || `PAY-${newId.toString().padStart(3, "0")}`,
            createdAt: new Date().toISOString().split("T")[0],
          });
          addToHistory("Ajout paiement", `Nouveau paiement #${newId}`);
        }

        currentPayments = [...payments];
        loadPayments();
        closeAllModals();
      }

      function editPayment(id) {
        openPaymentModal(id);
      }

      function deletePayment(id) {
        if (confirm("Êtes-vous sûr de vouloir supprimer ce paiement ?")) {
          const payment = payments.find((p) => p.id == id);
          payments = payments.filter((p) => p.id != id);
          currentPayments = currentPayments.filter((p) => p.id != id);
          loadPayments();
          addToHistory("Suppression paiement", `Paiement #${id} supprimé`);
        }
      }

      function loadInvoices() {
        const tbody = document.getElementById("invoices-table");
        tbody.innerHTML = "";

        if (currentInvoices.length === 0) {
          tbody.innerHTML = `
            <tr>
              <td colspan="6" style="text-align: center; padding: 3rem; color: var(--text-light);">
                <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
                Aucune facture à afficher
              </td>
            </tr>
          `;
          return;
        }

        currentInvoices.forEach((invoice) => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td>#${invoice.id}</td>
            <td>${invoice.date}</td>
            <td><strong>${invoice.client}</strong></td>
            <td><strong style="color: var(--primary-color); font-size: 16px;">${invoice.amount.toFixed(2)} DT</strong></td>
            <td>${invoice.description || "-"}</td>
            <td><span style="color: var(--success-color); font-weight: 600;">${invoice.status}</span></td>
          `;
          tbody.appendChild(row);
        });
      }

      function createSimpleInvoice() {
        const client = document.getElementById("simpleInvoiceClient").value;
        const amount = document.getElementById("simpleInvoiceAmount").value;
        const description = document.getElementById(
          "simpleInvoiceDescription",
        ).value;

        if (!client || !amount) {
          alert("Veuillez saisir le nom du client et le montant");
          return;
        }

        const newId =
          invoices.length > 0 ? Math.max(...invoices.map((i) => i.id)) + 1 : 1;

        invoices.unshift({
          id: newId,
          date: new Date().toISOString().split("T")[0],
          client,
          amount: parseFloat(amount),
          description: description || "Facture simple",
          status: "créée",
        });

        currentInvoices = [...invoices];
        loadInvoices();

        clearSimpleInvoice();

        addToHistory("Création facture", `Facture #${newId} pour ${client}`);
      }

      function clearSimpleInvoice() {
        document.getElementById("simpleInvoiceClient").value = "";
        document.getElementById("simpleInvoiceAmount").value = "";
        document.getElementById("simpleInvoiceDescription").value = "";
      }

      function populateClientSelects() {
        const selects = document.querySelectorAll("select[id*='Client']");
        selects.forEach((select) => {
          const currentValue = select.value;
          select.innerHTML = '<option value="">Sélectionner un client</option>';
          clients.forEach((client) => {
            const option = document.createElement("option");
            option.value = client.id;
            option.textContent = client.name;
            select.appendChild(option);
          });
          select.value = currentValue;
        });
      }

      function loadRecentActivity() {
        const tbody = document.getElementById("recent-activity");
        tbody.innerHTML = "";

        const recentOrders = orders.slice(0, 5);

        recentOrders.forEach((order) => {
          const statusClass = getStatusClass(order.status);
          const statusText = getStatusText(order.status);
          const firstItem =
            order.items.length > 0 ? order.items[0].productName : "N/A";

          const row = document.createElement("tr");
          row.innerHTML = `
            <td><strong>${order.clientName}</strong></td>
            <td>${firstItem}</td>
            <td>${formatDate(order.date)}</td>
            <td><strong style="color: var(--primary-color);">${order.total.toFixed(2)} DT</strong></td>
            <td><span class="status ${statusClass}">${statusText}</span></td>
          `;
          tbody.appendChild(row);
        });
      }

      function loadHistory() {
        const tbody = document.getElementById("history-table");
        tbody.innerHTML = "";

        if (currentHistory.length === 0) {
          tbody.innerHTML = `
            <tr>
              <td colspan="4" style="text-align: center; padding: 3rem; color: var(--text-light);">
                <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
                Aucune activité à afficher
              </td>
            </tr>
          `;
          return;
        }

        currentHistory.forEach((item) => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td><span style="color: var(--primary-color); font-size: 13px;">${item.date}</span></td>
            <td><strong>${item.user}</strong></td>
            <td><span style="background: var(--primary-light); padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: 500;">${item.action}</span></td>
            <td>${item.details}</td>
          `;
          tbody.appendChild(row);
        });
      }

      function updateDashboardStats() {
        const todayOrders = orders.filter(
          (o) => o.date === new Date().toISOString().split("T")[0],
        ).length;
        const pendingOrders = orders.filter(
          (o) => o.status === "pending",
        ).length;
        const totalClients = clients.length;
        const monthRevenue = orders
          .filter((o) => {
            const orderDate = new Date(o.date);
            const now = new Date();
            return (
              orderDate.getMonth() === now.getMonth() &&
              orderDate.getFullYear() === now.getFullYear()
            );
          })
          .reduce((sum, o) => sum + o.total, 0);

        document.getElementById("today-orders").textContent = todayOrders;
        document.getElementById("pending-orders").textContent = pendingOrders;
        document.getElementById("total-clients").textContent = totalClients;
        document.getElementById("month-revenue").textContent =
          monthRevenue.toFixed(1);

        document.querySelector(".card:nth-child(1) .card-value").textContent =
          totalClients;
        document.querySelector(".card:nth-child(2) .card-value").textContent =
          todayOrders;
        document.querySelector(".card:nth-child(3) .card-value").textContent =
          monthRevenue.toFixed(1) + " DT";
      }

      function updateClientsBadge() {
        const newClients = clients.filter(
          (c) =>
            new Date(c.createdAt).toDateString() === new Date().toDateString(),
        ).length;
        document.getElementById("clients-badge").textContent = newClients;
        document.getElementById("clients-badge").style.display =
          newClients > 0 ? "flex" : "none";
      }

      function updateOrdersBadge() {
        const pendingOrders = orders.filter(
          (o) => o.status === "pending",
        ).length;
        document.getElementById("orders-badge").textContent = pendingOrders;
        document.getElementById("orders-badge").style.display =
          pendingOrders > 0 ? "flex" : "none";
      }

      function addToHistory(action, details) {
        const now = new Date();
        const date = now.toISOString().split("T")[0];
        const time = now.toLocaleTimeString("fr-FR", {
          hour: "2-digit",
          minute: "2-digit",
        });

        history.unshift({
          date: `${date} ${time}`,
          user: "EL Jezi Ghassen",
          action,
          details,
        });

        currentHistory = [...history];
        loadHistory();
      }

      document.addEventListener("DOMContentLoaded", function () {
        loadClients();
        loadProducts();
        loadOrders();
        loadReviews();
        loadPayments();
        loadInvoices();
        loadHistory();
        loadRecentActivity();
        updateDashboardStats();
        populateClientSelects();

        document.querySelectorAll(".nav-link").forEach((link) => {
          link.addEventListener("click", function (e) {
            e.preventDefault();
            const tabId = this.getAttribute("data-tab");

            document
              .querySelectorAll(".nav-link")
              .forEach((l) => l.classList.remove("active"));
            this.classList.add("active");

            document.querySelectorAll(".tab-content").forEach((tab) => {
              tab.classList.remove("active");
            });
            document.getElementById(tabId).classList.add("active");
          });
        });

        document
          .getElementById("addClientBtn")
          .addEventListener("click", () => openClientModal());
        document
          .getElementById("addProductBtn")
          .addEventListener("click", () => openProductModal());
        document
          .getElementById("addOrderBtn")
          .addEventListener("click", () => openOrderModal());
        document
          .getElementById("addPaymentBtn")
          .addEventListener("click", () => openPaymentModal());
        document
          .getElementById("addReviewBtn")
          .addEventListener("click", () => openReviewModal());

        document.querySelectorAll(".close-modal").forEach((btn) => {
          btn.addEventListener("click", closeAllModals);
        });

        document.querySelectorAll(".modal").forEach((modal) => {
          modal.addEventListener("click", function (e) {
            if (e.target === this) closeAllModals();
          });
        });

        document
          .getElementById("clientForm")
          .addEventListener("submit", saveClient);
        document
          .getElementById("productForm")
          .addEventListener("submit", saveProduct);
        document
          .getElementById("orderForm")
          .addEventListener("submit", saveOrder);
        document
          .getElementById("paymentForm")
          .addEventListener("submit", savePayment);
        document
          .getElementById("reviewForm")
          .addEventListener("submit", saveReview);

        const today = new Date().toISOString().split("T")[0];
        document.getElementById("orderDate").value = today;
        document.getElementById("paymentDate").value = today;

        const darkModeToggle = document.getElementById("darkModeToggle");
        darkModeToggle.addEventListener("click", toggleDarkMode);

        initStarRating();

        document
          .getElementById("filterToday")
          .addEventListener("click", filterTodayHistory);
        document
          .getElementById("filterWeek")
          .addEventListener("click", filterWeekHistory);
        document
          .getElementById("filterMonth")
          .addEventListener("click", filterMonthHistory);
      });

      function closeAllModals() {
        document.querySelectorAll(".modal").forEach((modal) => {
          modal.style.display = "none";
        });

        document.querySelectorAll("form").forEach((form) => form.reset());
        currentOrderItems = [];
        currentReviewRating = 0;
      }

      function toggleDarkMode() {
        document.body.classList.toggle("dark-mode");
        localStorage.setItem(
          "theme",
          document.body.classList.contains("dark-mode") ? "dark" : "light",
        );
      }

      if (localStorage.getItem("theme") === "dark") {
        document.body.classList.add("dark-mode");
      }

      function filterTodayHistory() {
        const today = new Date().toISOString().split("T")[0];
        currentHistory = history.filter((item) => item.date.startsWith(today));
        loadHistory();
      }

      function filterWeekHistory() {
        const now = new Date();
        const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
        currentHistory = history.filter((item) => {
          const itemDate = new Date(item.date.split(" ")[0]);
          return itemDate >= weekAgo;
        });
        loadHistory();
      }

      function filterMonthHistory() {
        const now = new Date();
        const monthAgo = new Date(
          now.getFullYear(),
          now.getMonth() - 1,
          now.getDate(),
        );
        currentHistory = history.filter((item) => {
          const itemDate = new Date(item.date.split(" ")[0]);
          return itemDate >= monthAgo;
        });
        loadHistory();
      }

      // Fonctions pour le formulaire de contact
      function sendContactForm() {
        const name = document.getElementById("contactName").value;
        const email = document.getElementById("contactEmail").value;
        const subject = document.getElementById("contactSubject").value;
        const message = document.getElementById("contactMessage").value;
        const phone = document.getElementById("contactPhone").value;

        if (!name || !email || !subject || !message) {
          alert("Veuillez remplir tous les champs obligatoires (*)");
          return;
        }

        // Simulation d'envoi de formulaire
        const subjectText =
          {
            support: "Support technique",
            billing: "Facturation",
            product: "Question sur les produits",
            delivery: "Livraison",
            other: "Autre",
          }[subject] || "Demande de contact";

        alert(
          `Merci ${name} ! Votre message a été envoyé avec succès.\n\nNous vous répondrons à ${email} dans les plus brefs délais.`,
        );

        // Ajouter à l'historique
        addToHistory(
          "Envoi message",
          `Nouveau message de ${name} (${subjectText})`,
        );

        // Effacer le formulaire
        clearContactForm();
      }

      function clearContactForm() {
        document.getElementById("contactName").value = "";
        document.getElementById("contactEmail").value = "";
        document.getElementById("contactSubject").value = "";
        document.getElementById("contactMessage").value = "";
        document.getElementById("contactPhone").value = "";
      }

      window.editClient = editClient;
      window.deleteClient = deleteClient;
      window.editProduct = editProduct;
      window.deleteProduct = deleteProduct;
      window.editOrder = editOrder;
      window.deleteOrder = deleteOrder;
      window.viewOrderDetails = viewOrderDetails;
      window.addOrderItem = addOrderItem;
      window.removeOrderItem = removeOrderItem;
      window.updateOrderItem = updateOrderItem;
      window.editPayment = editPayment;
      window.deletePayment = deletePayment;
      window.editReview = editReview;
      window.deleteReview = deleteReview;
      window.toggleReviewVerification = toggleReviewVerification;
      window.toggleDarkMode = toggleDarkMode;
      window.createSimpleInvoice = createSimpleInvoice;
      window.clearSimpleInvoice = clearSimpleInvoice;
      window.sendContactForm = sendContactForm;
      window.clearContactForm = clearContactForm;

      // Fonctions de recherche globales
      window.searchDashboard = searchDashboard;
      window.clearDashboardSearch = clearDashboardSearch;
      window.searchClients = searchClients;
      window.clearClientsSearch = clearClientsSearch;
      window.searchProducts = searchProducts;
      window.clearProductsSearch = clearProductsSearch;
      window.searchOrders = searchOrders;
      window.clearOrdersSearch = clearOrdersSearch;
      window.searchReviews = searchReviews;
      window.clearReviewsSearch = clearReviewsSearch;
      window.searchPayments = searchPayments;
      window.clearPaymentsSearch = clearPaymentsSearch;
      window.searchInvoices = searchInvoices;
      window.clearInvoicesSearch = clearInvoicesSearch;
      window.searchHistory = searchHistory;
      window.clearHistorySearch = clearHistorySearch;
    </script>
  </body>
</html>
