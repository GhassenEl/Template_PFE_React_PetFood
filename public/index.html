<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PetFood TN - Dashboard Client</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      :root {
        /* Light Mode Variables */
        --primary-color: #3498db;
        --primary-dark: #2980b9;
        --primary-light: #ebf5fb;
        --secondary-color: #2ecc71;
        --accent-color: #e74c3c;
        --dark-color: #2c3e50;
        --light-color: #ecf0f1;
        --gray-color: #95a5a6;
        --success-color: #27ae60;
        --danger-color: #e74c3c;
        --warning-color: #f39c12;
        --info-color: #3498db;
        --shadow: 0 4px 12px rgba(52, 152, 219, 0.15);
        --radius: 12px;
        --gradient: linear-gradient(135deg, #3498db, #2c3e50);
        --bg-color: #f5f7fa;
        --card-bg: rgba(255, 255, 255, 0.95);
        --text-color: #2c3e50;
        --sidebar-bg: rgba(255, 255, 255, 0.98);
        --border-color: #e2e8f0;
        --input-bg: white;
        --table-header-bg: #ebf5fb;
        --footer-bg: linear-gradient(135deg, #2c3e50, #3498db);
      }

      .dark-mode {
        /* Dark Mode Variables */
        --primary-color: #3498db;
        --primary-dark: #2980b9;
        --primary-light: rgba(52, 152, 219, 0.15);
        --secondary-color: #2ecc71;
        --accent-color: #e74c3c;
        --dark-color: #ecf0f1;
        --light-color: #1a1a2e;
        --gray-color: #95a5a6;
        --success-color: #27ae60;
        --danger-color: #e74c3c;
        --warning-color: #f39c12;
        --info-color: #3498db;
        --shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
        --radius: 12px;
        --gradient: linear-gradient(135deg, #3498db, #2c3e50);
        --bg-color: #121212;
        --card-bg: rgba(30, 30, 46, 0.95);
        --text-color: #ecf0f1;
        --sidebar-bg: rgba(26, 26, 46, 0.98);
        --border-color: #2c3e50;
        --input-bg: #1a1a2e;
        --table-header-bg: rgba(52, 152, 219, 0.25);
        --footer-bg: linear-gradient(135deg, #1a1a2e, #2c3e50);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        transition:
          background-color 0.3s,
          color 0.3s,
          border-color 0.3s;
      }

      body {
        background:
          linear-gradient(rgba(245, 247, 250, 0.92), rgba(245, 247, 250, 0.92)),
          url("https://images.unsplash.com/photo-1591946614720-90a587da4a36?ixlib=rb-4.0.3&auto=format&fit=crop&w=1600&q=80");
        background-size: cover;
        background-attachment: fixed;
        background-position: center;
        color: var(--text-color);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      .dark-mode body {
        background:
          linear-gradient(rgba(18, 18, 18, 0.92), rgba(18, 18, 18, 0.92)),
          url("https://images.unsplash.com/photo-1513360371669-4adf3dd7dff8?ixlib=rb-4.0.3&auto=format&fit=crop&w=1600&q=80");
      }

      .animal-bg {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background:
          radial-gradient(
            circle at 20% 80%,
            rgba(52, 152, 219, 0.05) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 20%,
            rgba(46, 204, 113, 0.05) 0%,
            transparent 50%
          ),
          url("https://images.unsplash.com/photo-1513360371669-4adf3dd7dff8?ixlib=rb-4.0.3&auto=format&fit=crop&w=1600&q=80");
        background-size: cover;
        background-position: center;
        opacity: 0.08;
        z-index: -1;
      }

      .dark-mode .animal-bg {
        opacity: 0.05;
        background:
          radial-gradient(
            circle at 20% 80%,
            rgba(52, 152, 219, 0.03) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 20%,
            rgba(46, 204, 113, 0.03) 0%,
            transparent 50%
          ),
          url("https://images.unsplash.com/photo-1514888286974-6d03bdeacba8?ixlib=rb-4.0.3&auto=format&fit=crop&w=1600&q=80");
      }

      .container {
        display: flex;
        min-height: 100vh;
        position: relative;
        flex: 1;
      }

      /* ===== DARK MODE TOGGLE ===== */
      .dark-mode-toggle {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
      }

      .toggle-btn {
        width: 60px;
        height: 30px;
        background: var(--primary-light);
        border-radius: 15px;
        border: 2px solid var(--primary-color);
        cursor: pointer;
        position: relative;
        transition: all 0.3s;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 5px;
      }

      .toggle-btn i {
        color: var(--primary-color);
        font-size: 14px;
        z-index: 1;
      }

      .toggle-slider {
        position: absolute;
        top: 2px;
        left: 2px;
        width: 24px;
        height: 24px;
        background: var(--primary-color);
        border-radius: 50%;
        transition: transform 0.3s;
      }

      .dark-mode .toggle-slider {
        transform: translateX(30px);
      }

      /* ===== SIDEBAR ===== */
      .sidebar {
        width: 280px;
        background: var(--sidebar-bg);
        backdrop-filter: blur(10px);
        box-shadow: var(--shadow);
        padding: 1.5rem;
        position: fixed;
        height: 100vh;
        overflow-y: auto;
        border-right: 3px solid var(--primary-color);
        z-index: 100;
      }

      .logo {
        display: flex;
        align-items: center;
        margin-bottom: 2rem;
        padding-bottom: 1rem;
        border-bottom: 2px solid var(--primary-light);
      }

      .logo h1 {
        color: var(--primary-color) !important;
        font-size: 1.8rem;
        margin-left: 0.5rem;
      }

      .logo i {
        color: var(--primary-color) !important;
        font-size: 2rem;
      }

      .tagline {
        color: var(--text-color);
        font-style: italic;
        text-align: center;
        margin-bottom: 2rem;
        padding: 0.8rem;
        background: var(--primary-light);
        border-radius: var(--radius);
        border-left: 4px solid var(--primary-color);
      }

      .nav-menu {
        list-style: none;
      }

      .nav-item {
        margin-bottom: 0.5rem;
      }

      .nav-link {
        display: flex;
        align-items: center;
        padding: 0.8rem 1rem;
        color: var(--text-color);
        text-decoration: none;
        border-radius: var(--radius);
        transition: all 0.3s;
        border: 2px solid transparent;
      }

      .nav-link:hover {
        background: var(--primary-light);
        color: var(--primary-color);
        transform: translateX(5px);
        border-color: var(--primary-light);
      }

      .nav-link.active {
        background: var(--primary-color);
        color: white;
        box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3);
      }

      .nav-link i {
        width: 24px;
        margin-right: 0.8rem;
        text-align: center;
      }

      .badge {
        background: var(--accent-color);
        color: white;
        font-size: 0.7rem;
        padding: 0.2rem 0.6rem;
        border-radius: 12px;
        margin-left: auto;
        font-weight: 600;
      }

      .back-to-site {
        display: block;
        background: var(--gradient);
        color: white;
        text-align: center;
        padding: 0.8rem;
        border-radius: var(--radius);
        text-decoration: none;
        margin-top: 2rem;
        font-weight: 600;
        transition: all 0.3s;
        border: 2px solid var(--primary-color);
      }

      .back-to-site:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 12px rgba(52, 152, 219, 0.3);
      }

      /* ===== MAIN CONTENT ===== */
      .main-content {
        flex: 1;
        margin-left: 280px;
        padding: 2rem;
        z-index: 1;
        display: flex;
        flex-direction: column;
      }

      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
        padding: 1.5rem;
        background: var(--card-bg);
        backdrop-filter: blur(10px);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        border: 1px solid var(--border-color);
      }

      .welcome h2 {
        color: var(--primary-color) !important;
        font-size: 1.8rem;
      }

      .welcome p {
        color: var(--gray-color);
      }

      .header-actions {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .notification-btn {
        position: relative;
        background: var(--card-bg);
        border: 2px solid var(--primary-light);
        width: 45px;
        height: 45px;
        border-radius: 50%;
        cursor: pointer;
        box-shadow: var(--shadow);
        color: var(--primary-color);
        transition: all 0.3s;
      }

      .notification-btn:hover {
        background: var(--primary-color);
        color: white;
        transform: rotate(15deg);
      }

      .notification-btn .badge {
        position: absolute;
        top: -5px;
        right: -5px;
        background: var(--accent-color);
        min-width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .user-info {
        display: flex;
        align-items: center;
        background: var(--card-bg);
        padding: 0.5rem 1rem;
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        border: 2px solid var(--border-color);
      }

      .user-avatar {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        margin-right: 0.8rem;
        background: var(--gradient);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 1.5rem;
      }

      .user-info > div > div:first-child {
        color: var(--primary-color) !important;
        font-weight: 600;
      }

      /* ===== COMPTEUR (CLOUEUR) ===== */
      .counter-container {
        background: var(--card-bg);
        backdrop-filter: blur(10px);
        border-radius: var(--radius);
        padding: 1.5rem;
        margin-bottom: 2rem;
        box-shadow: var(--shadow);
        border: 2px solid var(--primary-color);
      }

      .counter-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
      }

      .counter-title {
        font-size: 1.3rem;
        color: var(--primary-color);
        font-weight: 600;
      }

      .counter-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 1rem;
        margin-top: 1rem;
      }

      .counter-stat {
        text-align: center;
        padding: 1rem;
        background: var(--primary-light);
        border-radius: var(--radius);
        transition: all 0.3s;
      }

      .counter-stat:hover {
        transform: translateY(-3px);
        box-shadow: 0 4px 8px rgba(52, 152, 219, 0.2);
      }

      .counter-number {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--primary-color);
        margin-bottom: 0.5rem;
      }

      .counter-label {
        font-size: 0.9rem;
        color: var(--gray-color);
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      /* ===== DASHBOARD CARDS ===== */
      .dashboard-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
      }

      .card {
        background: var(--card-bg);
        backdrop-filter: blur(10px);
        border-radius: var(--radius);
        padding: 1.5rem;
        box-shadow: var(--shadow);
        border: 1px solid var(--border-color);
        transition: all 0.3s;
        position: relative;
        overflow: hidden;
      }

      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 20px rgba(52, 152, 219, 0.2);
      }

      .card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 4px;
        background: var(--gradient);
      }

      .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
      }

      .card-title {
        font-size: 1.2rem;
        color: var(--text-color);
        font-weight: 600;
      }

      .card-icon {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: var(--primary-light);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--primary-color);
        font-size: 1.5rem;
      }

      .card-value {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--primary-color);
        margin-bottom: 0.5rem;
      }

      .card-change {
        display: flex;
        align-items: center;
        color: var(--success-color);
        font-weight: 600;
      }

      .card-change i {
        margin-right: 0.3rem;
      }

      .progress-bar {
        height: 10px;
        background: var(--primary-light);
        border-radius: 5px;
        overflow: hidden;
        margin: 1rem 0;
      }

      .progress-fill {
        height: 100%;
        background: var(--gradient);
        width: 75%;
        border-radius: 5px;
      }

      /* ===== SECTION PAIEMENT ===== */
      .payment-section {
        background: var(--card-bg);
        backdrop-filter: blur(10px);
        border-radius: var(--radius);
        padding: 1.5rem;
        margin-bottom: 2rem;
        box-shadow: var(--shadow);
        border: 2px solid var(--secondary-color);
      }

      .payment-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 2px solid var(--border-color);
      }

      .payment-title {
        font-size: 1.3rem;
        color: var(--text-color);
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      /* ===== NOUVELLES CLASSES POUR MOYENS DE PAIEMENT ===== */
      .payment-methods-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
        margin-top: 1.5rem;
      }

      .payment-method-card {
        background: var(--card-bg);
        border-radius: var(--radius);
        padding: 1.5rem;
        text-align: center;
        border: 2px solid var(--border-color);
        transition: all 0.3s;
      }

      .payment-method-card:hover {
        transform: translateY(-5px);
        border-color: var(--primary-color);
        box-shadow: var(--shadow);
      }

      .payment-method-card .payment-icon {
        font-size: 2.5rem;
        margin-bottom: 1rem;
      }

      .payment-method-card .payment-name {
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--text-color);
        margin-bottom: 0.5rem;
      }

      .payment-method-card .payment-desc {
        font-size: 0.9rem;
        color: var(--gray-color);
        margin-bottom: 0.5rem;
      }

      .payment-method-status {
        font-size: 0.8rem;
        color: var(--success-color);
        margin-top: 0.5rem;
      }

      /* ===== SECTIONS ===== */
      .section {
        background: var(--card-bg);
        backdrop-filter: blur(10px);
        border-radius: var(--radius);
        padding: 1.5rem;
        box-shadow: var(--shadow);
        margin-bottom: 2rem;
        border: 1px solid var(--border-color);
      }

      .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 2px solid var(--border-color);
      }

      .section-title {
        font-size: 1.3rem;
        color: var(--text-color);
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .section-title i {
        color: var(--primary-color);
      }

      .btn {
        padding: 0.6rem 1.2rem;
        border: none;
        border-radius: var(--radius);
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .btn-primary {
        background: var(--gradient);
        color: white;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 12px rgba(52, 152, 219, 0.3);
      }

      .btn-secondary {
        background: var(--primary-light);
        color: var(--primary-color);
        border: 2px solid var(--primary-light);
      }

      .btn-secondary:hover {
        background: var(--primary-color);
        color: white;
      }

      /* ===== TABLE ===== */
      .table-container {
        overflow-x: auto;
        border-radius: var(--radius);
        border: 1px solid var(--border-color);
      }

      table {
        width: 100%;
        border-collapse: collapse;
        min-width: 600px;
      }

      th {
        background: var(--table-header-bg);
        color: var(--primary-color);
        padding: 1rem;
        text-align: left;
        font-weight: 600;
        border-bottom: 2px solid var(--primary-color);
      }

      td {
        padding: 1rem;
        border-bottom: 1px solid var(--border-color);
      }

      tr:hover {
        background: var(--primary-light);
      }

      .status {
        padding: 0.4rem 0.8rem;
        border-radius: 20px;
        font-size: 0.9rem;
        font-weight: 600;
        display: inline-block;
      }

      .status-delivered {
        background: #d4efdf;
        color: #27ae60;
        border: 1px solid #27ae60;
      }

      .dark-mode .status-delivered {
        background: rgba(39, 174, 96, 0.25);
        color: #27ae60;
        border: 1px solid #27ae60;
      }

      .status-pending {
        background: #fdebd0;
        color: #f39c12;
        border: 1px solid #f39c12;
      }

      .dark-mode .status-pending {
        background: rgba(243, 156, 18, 0.25);
        color: #f39c12;
        border: 1px solid #f39c12;
      }

      .status-processing {
        background: #d6eaf8;
        color: #3498db;
        border: 1px solid #3498db;
      }

      .dark-mode .status-processing {
        background: rgba(52, 152, 219, 0.25);
        color: #3498db;
        border: 1px solid #3498db;
      }

      .action-btn {
        background: var(--primary-light);
        border: none;
        width: 35px;
        height: 35px;
        border-radius: 50%;
        cursor: pointer;
        color: var(--primary-color);
        margin: 0 0.2rem;
        transition: all 0.3s;
      }

      .action-btn:hover {
        background: var(--primary-color);
        color: white;
        transform: scale(1.1);
      }

      /* ===== PRODUCT IMAGES ===== */
      .product-image {
        width: 50px;
        height: 50px;
        border-radius: 8px;
        object-fit: cover;
        border: 2px solid var(--border-color);
        transition: all 0.3s;
      }

      .product-image:hover {
        transform: scale(1.5);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      }

      .product-card {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      /* ===== FORM MODAL ===== */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(44, 62, 80, 0.8);
        backdrop-filter: blur(5px);
        z-index: 1000;
        align-items: center;
        justify-content: center;
        animation: fadeIn 0.3s;
      }

      .dark-mode .modal {
        background: rgba(0, 0, 0, 0.8);
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      .modal-content {
        background: var(--card-bg);
        border-radius: var(--radius);
        padding: 2rem;
        width: 90%;
        max-width: 800px;
        max-height: 80vh;
        overflow-y: auto;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        border: 3px solid var(--primary-color);
        animation: slideUp 0.3s;
      }

      @keyframes slideUp {
        from {
          transform: translateY(50px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 2px solid var(--border-color);
      }

      .modal-title {
        color: var(--primary-color);
        font-size: 1.5rem;
      }

      .close-modal {
        background: none;
        border: none;
        font-size: 1.5rem;
        cursor: pointer;
        color: var(--gray-color);
        transition: all 0.3s;
      }

      .close-modal:hover {
        color: var(--primary-color);
        transform: rotate(90deg);
      }

      .form-group {
        margin-bottom: 1.2rem;
      }

      label {
        display: block;
        margin-bottom: 0.5rem;
        color: var(--text-color);
        font-weight: 600;
      }

      input,
      select,
      textarea {
        width: 100%;
        padding: 0.8rem;
        background: var(--input-bg);
        border: 2px solid var(--border-color);
        border-radius: var(--radius);
        font-size: 1rem;
        transition: all 0.3s;
        color: var(--text-color);
      }

      input:focus,
      select:focus,
      textarea:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
      }

      .form-actions {
        display: flex;
        gap: 1rem;
        justify-content: flex-end;
        margin-top: 2rem;
        padding-top: 1rem;
        border-top: 2px solid var(--border-color);
      }

      /* ===== NOTIFICATIONS PANEL ===== */
      .notifications-panel {
        display: none;
        position: fixed;
        top: 100px;
        right: 2rem;
        width: 400px;
        background: var(--card-bg);
        border-radius: var(--radius);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        z-index: 100;
        border: 2px solid var(--primary-color);
        max-height: 500px;
        overflow-y: auto;
      }

      .notification-item {
        padding: 1rem;
        border-bottom: 1px solid var(--border-color);
        display: flex;
        align-items: flex-start;
        transition: all 0.3s;
      }

      .notification-item:hover {
        background: var(--primary-light);
      }

      .notification-item.unread {
        background: var(--primary-light);
        border-left: 4px solid var(--primary-color);
      }

      .notification-icon {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 1rem;
        color: white;
        flex-shrink: 0;
        font-size: 1.2rem;
      }

      .notification-icon.success {
        background: var(--success-color);
      }

      .notification-icon.warning {
        background: var(--warning-color);
      }

      .notification-icon.info {
        background: var(--info-color);
      }

      /* ===== FOOTER ===== */
      .footer {
        background: var(--footer-bg);
        color: white;
        padding: 3rem 2rem 1.5rem;
        margin-top: auto;
        margin-left: 280px;
      }

      .footer-content {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 2rem;
        margin-bottom: 2rem;
      }

      .footer-section h3 {
        color: white;
        font-size: 1.3rem;
        margin-bottom: 1.5rem;
        padding-bottom: 0.5rem;
        border-bottom: 2px solid rgba(255, 255, 255, 0.2);
      }

      .footer-section p {
        color: rgba(255, 255, 255, 0.8);
        line-height: 1.6;
        margin-bottom: 1rem;
      }

      .working-hours {
        list-style: none;
      }

      .working-hours li {
        display: flex;
        justify-content: space-between;
        padding: 0.5rem 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        color: rgba(255, 255, 255, 0.9);
      }

      .social-icons {
        display: flex;
        gap: 1rem;
        margin-top: 1.5rem;
      }

      .social-icon {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.1);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        text-decoration: none;
        transition: all 0.3s;
        font-size: 1.2rem;
      }

      .social-icon:hover {
        background: white;
        color: var(--primary-color);
        transform: translateY(-3px);
      }

      .footer-bottom {
        text-align: center;
        padding-top: 1.5rem;
        border-top: 1px solid rgba(255, 255, 255, 0.2);
        color: rgba(255, 255, 255, 0.7);
        font-size: 0.9rem;
      }

      /* ===== TABS ===== */
      .tabs {
        display: flex;
        border-bottom: 2px solid var(--border-color);
        margin-bottom: 1.5rem;
      }

      .tab-btn {
        padding: 0.8rem 1.5rem;
        background: none;
        border: none;
        cursor: pointer;
        color: var(--gray-color);
        font-weight: 600;
        position: relative;
        transition: all 0.3s;
      }

      .tab-btn:hover {
        color: var(--primary-color);
      }

      .tab-btn.active {
        color: var(--primary-color);
      }

      .tab-btn.active::after {
        content: "";
        position: absolute;
        bottom: -2px;
        left: 0;
        width: 100%;
        height: 3px;
        background: var(--gradient);
      }

      .tab-content {
        display: none;
        animation: fadeIn 0.5s;
      }

      .tab-content.active {
        display: block;
      }

      /* ===== PET BACKGROUND ELEMENTS ===== */
      .pet-decoration {
        position: fixed;
        z-index: -1;
        opacity: 0.08;
      }

      .pet-1 {
        top: 10%;
        right: 5%;
        font-size: 10rem;
        color: var(--primary-color);
      }

      .pet-2 {
        bottom: 10%;
        left: 5%;
        font-size: 8rem;
        color: var(--secondary-color);
      }

      /* ===== ORDER ITEMS ===== */
      .order-items-container {
        max-height: 200px;
        overflow-y: auto;
        margin: 1rem 0;
        border: 1px solid var(--border-color);
        border-radius: var(--radius);
        padding: 1rem;
      }

      .order-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.5rem;
        border-bottom: 1px solid var(--border-color);
      }

      .order-item:last-child {
        border-bottom: none;
      }

      .item-controls {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .item-quantity {
        width: 60px;
        text-align: center;
      }

      .add-item-btn {
        margin-top: 1rem;
        background: var(--primary-light);
        color: var(--primary-color);
        border: 2px dashed var(--primary-color);
        padding: 0.5rem;
        width: 100%;
        border-radius: var(--radius);
        cursor: pointer;
        transition: all 0.3s;
      }

      .add-item-btn:hover {
        background: var(--primary-color);
        color: white;
      }

      .invoice-preview {
        background: var(--primary-light);
        border-radius: var(--radius);
        padding: 1rem;
        margin-top: 1rem;
        display: none;
      }

      .invoice-preview.active {
        display: block;
      }

      .invoice-header {
        text-align: center;
        border-bottom: 2px solid var(--primary-color);
        padding-bottom: 1rem;
        margin-bottom: 1rem;
      }

      .invoice-details {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
        margin-bottom: 1rem;
      }

      /* ===== RESPONSIVE ===== */
      @media (max-width: 1024px) {
        .sidebar {
          width: 250px;
        }
        .main-content {
          margin-left: 250px;
        }
        .footer {
          margin-left: 250px;
        }
      }

      @media (max-width: 768px) {
        .container {
          flex-direction: column;
        }
        .sidebar {
          position: relative;
          width: 100%;
          height: auto;
          margin-bottom: 1rem;
        }
        .main-content {
          margin-left: 0;
          padding: 1rem;
        }
        .footer {
          margin-left: 0;
        }
        .dashboard-cards {
          grid-template-columns: 1fr;
        }
        .notifications-panel {
          width: 90%;
          right: 5%;
        }
        .counter-stats {
          grid-template-columns: repeat(2, 1fr);
        }
        .dark-mode-toggle {
          position: absolute;
          top: 15px;
          right: 15px;
        }
        .payment-methods-grid {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 480px) {
        .counter-stats {
          grid-template-columns: 1fr;
        }
        .payment-methods {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <!-- Animal Background -->
    <div class="animal-bg"></div>

    <!-- Pet Decorations -->
    <div class="pet-decoration pet-1">
      <i class="fas fa-paw"></i>
    </div>
    <div class="pet-decoration pet-2">
      <i class="fas fa-cat"></i>
    </div>

    <!-- Dark Mode Toggle -->
    <div class="dark-mode-toggle">
      <div class="toggle-btn" id="darkModeToggle">
        <i class="fas fa-sun"></i>
        <i class="fas fa-moon"></i>
        <div class="toggle-slider"></div>
      </div>
    </div>

    <div class="container">
      <!-- SIDEBAR -->
      <aside class="sidebar">
        <div class="logo">
          <i class="fas fa-paw"></i>
          <h1>PetFood TN</h1>
        </div>
        <p class="tagline">Le bonheur de vos animaux, notre priorité !</p>

        <ul class="nav-menu">
          <li class="nav-item">
            <a href="#" class="nav-link active" data-tab="dashboard">
              <i class="fas fa-tachometer-alt"></i> Tableau de bord
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" data-tab="clients">
              <i class="fas fa-users"></i> Clients
              <span class="badge" id="clients-badge">3</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" data-tab="products">
              <i class="fas fa-box-open"></i> Produits
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" data-tab="orders">
              <i class="fas fa-shopping-cart"></i> Commandes
              <span class="badge" id="orders-badge">5</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" data-tab="payment">
              <i class="fas fa-credit-card"></i> Paiements
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" data-tab="history">
              <i class="fas fa-history"></i> Historique
            </a>
          </li>
        </ul>

        <a href="#" class="back-to-site">
          <i class="fas fa-arrow-left"></i> Retour au site
        </a>
      </aside>

      <!-- MAIN CONTENT -->
      <main class="main-content">
        <!-- HEADER -->
        <header class="header">
          <div class="welcome">
            <h2>Bienvenue, EL Jezi Ghassen !</h2>
            <p>
              Vous gérez
              <strong style="color: var(--primary-color) !important"
                >189 clients tunisiens</strong
              >
              et
              <strong style="color: var(--primary-color) !important"
                >48 commandes aujourd'hui</strong
              >
            </p>
          </div>

          <div class="header-actions">
            <button class="notification-btn" id="notificationBtn">
              <i class="fas fa-bell"></i>
              <span class="badge" id="notification-count">3</span>
            </button>

            <div class="user-info">
              <div class="user-avatar">
                <i class="fas fa-user"></i>
              </div>
              <div>
                <div>EL Jezi Ghassen</div>
                <div style="font-size: 0.8rem; color: var(--gray-color)">
                  Administrateur
                </div>
              </div>
            </div>
          </div>
        </header>

        <!-- NOTIFICATIONS PANEL -->
        <div class="notifications-panel" id="notificationsPanel">
          <div class="section-header" style="margin: 0; padding: 1rem">
            <h3 class="section-title">
              <i class="fas fa-bell"></i> Notifications
            </h3>
            <button class="btn btn-secondary" id="markAllRead">
              Tout marquer comme lu
            </button>
          </div>
          <div id="notifications-list">
            <!-- Notifications will be loaded here -->
          </div>
        </div>

        <!-- DASHBOARD TAB -->
        <div id="dashboard" class="tab-content active">
          <!-- COMPTEUR (CLOUEUR) -->
          <div class="counter-container">
            <div class="counter-header">
              <h3 class="counter-title">
                <i class="fas fa-chart-bar"></i> Compteur en Temps Réel
              </h3>
              <div style="color: var(--primary-color); font-weight: 600">
                <i class="fas fa-sync-alt"></i> Mise à jour:
                <span id="last-update">Maintenant</span>
              </div>
            </div>

            <div class="counter-stats">
              <div class="counter-stat">
                <div class="counter-number" id="today-orders">48</div>
                <div class="counter-label">Commandes Aujourd'hui</div>
              </div>
              <div class="counter-stat">
                <div class="counter-number" id="pending-orders">5</div>
                <div class="counter-label">En Attente</div>
              </div>
              <div class="counter-stat">
                <div class="counter-number" id="total-clients">189</div>
                <div class="counter-label">Clients Actifs</div>
              </div>
              <div class="counter-stat">
                <div class="counter-number" id="month-revenue">2.845</div>
                <div class="counter-label">Revenus (DT)</div>
              </div>
            </div>
          </div>

          <!-- STATS CARDS -->
          <div class="dashboard-cards">
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">Clients Actifs</h3>
                <div class="card-icon">
                  <i class="fas fa-users"></i>
                </div>
              </div>
              <div class="card-value">189</div>
              <div class="card-change">
                <i class="fas fa-arrow-up"></i> +15 ce mois
              </div>
              <div
                style="
                  color: var(--gray-color);
                  font-size: 0.9rem;
                  margin-top: 0.5rem;
                "
              >
                Clients tunisiens
              </div>
            </div>

            <div class="card">
              <div class="card-header">
                <h3 class="card-title">Commandes Aujourd'hui</h3>
                <div class="card-icon">
                  <i class="fas fa-shopping-cart"></i>
                </div>
              </div>
              <div class="card-value">48</div>
              <div class="card-change">
                <i class="fas fa-arrow-up"></i> +12% vs hier
              </div>
              <div
                style="
                  color: var(--gray-color);
                  font-size: 0.9rem;
                  margin-top: 0.5rem;
                "
              >
                Commandes traitées
              </div>
            </div>

            <div class="card">
              <div class="card-header">
                <h3 class="card-title">Chiffre d'Affaires</h3>
                <div class="card-icon">
                  <i class="fas fa-chart-line"></i>
                </div>
              </div>
              <div class="card-value">2.845 DT</div>
              <div class="progress-bar">
                <div class="progress-fill"></div>
              </div>
              <div class="card-change">
                <i class="fas fa-arrow-up"></i> +8.5% ce mois
              </div>
              <div
                style="
                  color: var(--gray-color);
                  font-size: 0.9rem;
                  margin-top: 0.5rem;
                "
              >
                Objectif: 3.800 DT
              </div>
            </div>
          </div>

          <!-- RECENT ACTIVITY -->
          <div class="section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-bolt"></i> Activité Récente
              </h3>
              <button class="btn btn-primary" onclick="location.reload()">
                <i class="fas fa-sync-alt"></i> Actualiser
              </button>
            </div>
            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>Client</th>
                    <th>Produit</th>
                    <th>Date</th>
                    <th>Montant</th>
                    <th>Statut</th>
                  </tr>
                </thead>
                <tbody id="recent-activity">
                  <!-- Recent activity will be loaded here -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- CLIENTS TAB -->
        <div id="clients" class="tab-content">
          <div class="section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-users"></i> Gestion des Clients
              </h3>
              <button class="btn btn-primary" id="addClientBtn">
                <i class="fas fa-plus"></i> Ajouter un client
              </button>
            </div>

            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Nom</th>
                    <th>Email</th>
                    <th>Téléphone</th>
                    <th>Ville</th>
                    <th>Commandes</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="clients-table">
                  <!-- Clients will be loaded here -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- PRODUCTS TAB -->
        <div id="products" class="tab-content">
          <div class="section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-box-open"></i> Gestion des Produits
              </h3>
              <button class="btn btn-primary" id="addProductBtn">
                <i class="fas fa-plus"></i> Ajouter un produit
              </button>
            </div>

            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>Image</th>
                    <th>Nom</th>
                    <th>Catégorie</th>
                    <th>Prix (DT)</th>
                    <th>Stock</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="products-table">
                  <!-- Products will be loaded here -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- ORDERS TAB (SIMPLIFIÉ) -->
        <div id="orders" class="tab-content">
          <div class="section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-shopping-cart"></i> Gestion des Commandes
              </h3>
              <button class="btn btn-primary" id="addOrderBtn">
                <i class="fas fa-plus"></i> Nouvelle commande
              </button>
            </div>

            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>N° Commande</th>
                    <th>Client</th>
                    <th>Date</th>
                    <th>Total (DT)</th>
                    <th>Statut</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="orders-table">
                  <!-- Orders will be loaded here -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- PAYMENT TAB (SIMPLIFIÉ) -->
        <div id="payment" class="tab-content">
          <!-- Section des moyens de paiement -->
          <div class="section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-credit-card"></i> Moyens de Paiement Acceptés
              </h3>
              <span style="color: var(--success-color); font-weight: 600">
                <i class="fas fa-check-circle"></i> Sécurisé & Rapide
              </span>
            </div>

            <div class="payment-methods-grid">
              <div class="payment-method-card">
                <div class="payment-icon">
                  <i class="fas fa-credit-card" style="color: var(--primary-color);"></i>
                </div>
                <div class="payment-name">Carte Bancaire</div>
                <div class="payment-desc">Visa, Mastercard, Carte Bleue</div>
                <div class="payment-method-status">
                  <span style="color: var(--success-color);">✓</span> 3D Secure
                </div>
              </div>

              <div class="payment-method-card">
                <div class="payment-icon">
                  <i class="fas fa-money-bill-wave" style="color: var(--success-color);"></i>
                </div>
                <div class="payment-name">Espèces</div>
                <div class="payment-desc">Paiement en main propre</div>
                <div class="payment-method-status">
                  <span style="color: var(--success-color);">✓</span> À la livraison
                </div>
              </div>

              <div class="payment-method-card">
                <div class="payment-icon">
                  <i class="fas fa-university" style="color: var(--info-color);"></i>
                </div>
                <div class="payment-name">Virement Bancaire</div>
                <div class="payment-desc">Transfert bancaire national</div>
                <div class="payment-method-status">
                  <span style="color: var(--success-color);">✓</span> Sous 48h
                </div>
              </div>

              <div class="payment-method-card">
                <div class="payment-icon">
                  <i class="fas fa-mobile-alt" style="color: var(--warning-color);"></i>
                </div>
                <div class="payment-name">Paiement Mobile</div>
                <div class="payment-desc">Via applications mobiles</div>
                <div class="payment-method-status">
                  <span style="color: var(--success-color);">✓</span> Instantané
                </div>
              </div>

              <div class="payment-method-card">
                <div class="payment-icon">
                  <i class="fas fa-file-invoice-dollar" style="color: var(--secondary-color);"></i>
                </div>
                <div class="payment-name">Chèque</div>
                <div class="payment-desc">Chèques bancaires tunisiens</div>
                <div class="payment-method-status">
                  <span style="color: var(--success-color);">✓</span> Encaissement 5 jours
                </div>
              </div>
            </div>

            <div style="margin-top: 2rem; padding: 1.5rem; background: var(--primary-light); border-radius: var(--radius);">
              <h4 style="color: var(--primary-color); margin-bottom: 1rem;">
                <i class="fas fa-info-circle"></i> Informations importantes
              </h4>
              <ul style="color: var(--text-color); padding-left: 1.5rem;">
                <li>Les paiements par carte sont sécurisés avec la technologie 3D Secure</li>
                <li>Les paiements en espèces sont acceptés uniquement à la livraison</li>
                <li>Les virements bancaires doivent être confirmés par email</li>
                <li>Les chèques doivent être émis à l'ordre de "PetFood TN"</li>
              </ul>
            </div>
          </div>

          <!-- Section simplifiée de création de facture -->
          <div class="section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-file-invoice"></i> Création de Facture
              </h3>
            </div>

            <div style="padding: 1rem; background: var(--primary-light); border-radius: var(--radius);">
              <div class="form-group">
                <label for="simpleInvoiceClient">Nom du Client *</label>
                <input type="text" id="simpleInvoiceClient" required placeholder="Saisir le nom du client" />
              </div>
              <div class="form-group">
                <label for="simpleInvoiceAmount">Montant (DT) *</label>
                <input type="number" id="simpleInvoiceAmount" step="0.01" min="0" required placeholder="0.00" />
              </div>
              <div class="form-group">
                <label for="simpleInvoiceDescription">Description</label>
                <textarea id="simpleInvoiceDescription" rows="2" placeholder="Description de la facture"></textarea>
              </div>
              <div style="display: flex; gap: 1rem; margin-top: 1.5rem">
                <button class="btn btn-primary" onclick="createSimpleInvoice()">
                  <i class="fas fa-check"></i> Valider
                </button>
                <button class="btn btn-secondary" onclick="clearSimpleInvoice()">
                  <i class="fas fa-times"></i> Annuler
                </button>
              </div>
            </div>
          </div>

          <!-- Section gestion des paiements (CRUD) -->
          <div class="section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-money-check-alt"></i> Gestion des Paiements
              </h3>
              <button class="btn btn-primary" id="addPaymentBtn">
                <i class="fas fa-plus"></i> Ajouter un paiement
              </button>
            </div>

            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Client</th>
                    <th>Montant (DT)</th>
                    <th>Méthode</th>
                    <th>Date</th>
                    <th>Statut</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="payments-table">
                  <!-- Payments will be loaded here -->
                </tbody>
              </table>
            </div>
          </div>

          <!-- Section gestion des factures (simplifiée) -->
          <div class="section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-history"></i> Historique des Factures
              </h3>
            </div>
            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>N° Facture</th>
                    <th>Date</th>
                    <th>Client</th>
                    <th>Montant (DT)</th>
                    <th>Description</th>
                    <th>Statut</th>
                  </tr>
                </thead>
                <tbody id="invoices-table">
                  <!-- Invoices will be loaded here -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- HISTORY TAB -->
        <div id="history" class="tab-content">
          <div class="section">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-history"></i> Historique des Activités
              </h3>
              <div>
                <button class="btn btn-secondary" id="filterToday">
                  <i class="fas fa-calendar-day"></i> Aujourd'hui
                </button>
                <button class="btn btn-secondary" id="filterWeek">
                  <i class="fas fa-calendar-week"></i> Cette semaine
                </button>
                <button class="btn btn-secondary" id="filterMonth">
                  <i class="fas fa-calendar-alt"></i> Ce mois
                </button>
              </div>
            </div>

            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>Date</th>
                    <th>Utilisateur</th>
                    <th>Action</th>
                    <th>Détails</th>
                  </tr>
                </thead>
                <tbody id="history-table">
                  <!-- History will be loaded here -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- FOOTER -->
    <footer class="footer">
      <div class="footer-content">
        <div class="footer-section">
          <h3><i class="fas fa-paw"></i> PetFood TN</h3>
          <p>
            Votre partenaire de confiance pour la nourriture fraîche de vos
            animaux de compagnie en Tunisie.
          </p>
          <p>Livraison rapide à domicile dans toutes les villes de Tunisie.</p>
          <div class="social-icons">
            <a href="#" class="social-icon" title="Facebook">
              <i class="fab fa-facebook-f"></i>
            </a>
            <a href="#" class="social-icon" title="Instagram">
              <i class="fab fa-instagram"></i>
            </a>
            <a href="#" class="social-icon" title="Twitter">
              <i class="fab fa-twitter"></i>
            </a>
            <a href="#" class="social-icon" title="WhatsApp">
              <i class="fab fa-whatsapp"></i>
            </a>
          </div>
        </div>

        <div class="footer-section">
          <h3><i class="fas fa-clock"></i> Horaires de Travail</h3>
          <ul class="working-hours">
            <li>
              <span>Lundi - Vendredi</span>
              <span>8:00 - 18:00</span>
            </li>
            <li>
              <span>Samedi</span>
              <span>9:00 - 16:00</span>
            </li>
            <li>
              <span>Dimanche</span>
              <span>10:00 - 14:00</span>
            </li>
            <li>
              <span>Livraisons</span>
              <span>7j/7 jusqu'à 20h</span>
            </li>
          </ul>
        </div>

        <div class="footer-section">
          <h3><i class="fas fa-map-marker-alt"></i> Informations</h3>
          <p>
            <i class="fas fa-calendar-alt"></i> Depuis: <strong>2015</strong>
          </p>
          <p>
            <i class="fas fa-user-check"></i> Clients satisfaits:
            <strong>2,500+</strong>
          </p>
          <p>
            <i class="fas fa-box"></i> Commandes livrées:
            <strong>15,000+</strong>
          </p>
          <p>
            <i class="fas fa-truck"></i> Zones de livraison:
            <strong>Toute la Tunisie</strong>
          </p>
        </div>

        <div class="footer-section">
          <h3><i class="fas fa-headset"></i> Contact & Support</h3>
          <p><i class="fas fa-phone"></i> +216 70 123 456</p>
          <p><i class="fas fa-envelope"></i> contact@petfoodtn.tn</p>
          <p><i class="fas fa-map-pin"></i> Rue de l'Agriculture, Tunis 1002</p>
          <p
            style="
              margin-top: 1rem;
              font-size: 0.9rem;
              color: rgba(255, 255, 255, 0.7);
            "
          >
            Service client disponible 7j/7 de 8h à 22h
          </p>
        </div>
      </div>

      <div class="footer-bottom">
        <p>
          &copy; 2024 PetFood TN. Tous droits réservés. |
          <a href="#" style="color: white; text-decoration: none"
            >Politique de confidentialité</a
          >
          |
          <a href="#" style="color: white; text-decoration: none"
            >Conditions d'utilisation</a
          >
        </p>
        <p style="margin-top: 0.5rem; font-size: 0.8rem">
          <i class="fas fa-shield-alt"></i> Paiements 100% sécurisés |
          <i class="fas fa-leaf"></i> Produits frais garantis |
          <i class="fas fa-heart"></i> Engagement qualité
        </p>
      </div>
    </footer>

    <!-- MODALS -->
    <!-- MODAL CLIENT -->
    <div class="modal" id="clientModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title" id="clientModalTitle">Ajouter un client</h3>
          <button class="close-modal">&times;</button>
        </div>
        <form id="clientForm">
          <input type="hidden" id="clientId" />
          <div class="form-group">
            <label for="clientName">Nom complet *</label>
            <input
              type="text"
              id="clientName"
              required
              placeholder="Ex: Ali Ben Salah"
            />
          </div>
          <div class="form-group">
            <label for="clientEmail">Email *</label>
            <input
              type="email"
              id="clientEmail"
              required
              placeholder="exemple@email.com"
            />
          </div>
          <div class="form-group">
            <label for="clientPhone">Téléphone *</label>
            <input
              type="tel"
              id="clientPhone"
              required
              placeholder="XX XXX XXX"
            />
          </div>
          <div class="form-group">
            <label for="clientAddress">Adresse</label>
            <textarea
              id="clientAddress"
              rows="2"
              placeholder="Adresse complète"
            ></textarea>
          </div>
          <div class="form-group">
            <label for="clientCity">Ville</label>
            <select id="clientCity">
              <option value="Tunis">Tunis</option>
              <option value="Sfax">Sfax</option>
              <option value="Sousse">Sousse</option>
              <option value="Gabès">Gabès</option>
              <option value="Nabeul">Nabeul</option>
              <option value="Bizerte">Bizerte</option>
              <option value="Monastir">Monastir</option>
            </select>
          </div>
          <div class="form-actions">
            <button type="button" class="btn btn-secondary close-modal">
              Annuler
            </button>
            <button type="submit" class="btn btn-primary">Enregistrer</button>
          </div>
        </form>
      </div>
    </div>

    <!-- MODAL PRODUIT -->
    <div class="modal" id="productModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title" id="productModalTitle">Ajouter un produit</h3>
          <button class="close-modal">&times;</button>
        </div>
        <form id="productForm">
          <input type="hidden" id="productId" />
          <div class="form-group">
            <label for="productName">Nom du produit *</label>
            <input
              type="text"
              id="productName"
              required
              placeholder="Ex: Croquettes Premium"
            />
          </div>
          <div class="form-group">
            <label for="productImage">Image URL</label>
            <input
              type="url"
              id="productImage"
              placeholder="URL de l'image"
              value="https://images.unsplash.com/photo-1592924357228-91a4daadcfea?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80"
            />
          </div>
          <div class="form-group">
            <label for="productCategory">Catégorie *</label>
            <select id="productCategory" required>
              <option value="">Sélectionner</option>
              <option value="Chien">Chien</option>
              <option value="Chat">Chat</option>
              <option value="Oiseau">Oiseau</option>
              <option value="Rongeur">Rongeur</option>
              <option value="Poisson">Poisson</option>
              <option value="Autre">Autre</option>
            </select>
          </div>
          <div class="form-group">
            <label for="productPrice">Prix (DT) *</label>
            <input
              type="number"
              id="productPrice"
              step="0.01"
              min="0"
              required
              placeholder="0.00"
            />
          </div>
          <div class="form-group">
            <label for="productStock">Stock *</label>
            <input
              type="number"
              id="productStock"
              min="0"
              required
              placeholder="Quantité en stock"
            />
          </div>
          <div class="form-group">
            <label for="productDescription">Description</label>
            <textarea
              id="productDescription"
              rows="3"
              placeholder="Description du produit..."
            ></textarea>
          </div>
          <div class="form-actions">
            <button type="button" class="btn btn-secondary close-modal">
              Annuler
            </button>
            <button type="submit" class="btn btn-primary">Enregistrer</button>
          </div>
        </form>
      </div>
    </div>

    <!-- MODAL DE COMMANDE -->
    <div class="modal" id="orderModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title" id="orderModalTitle">Nouvelle Commande</h3>
          <button class="close-modal">&times;</button>
        </div>
        <form id="orderForm">
          <input type="hidden" id="orderId" />
          <div class="form-group">
            <label for="orderClient">Client *</label>
            <select id="orderClient" required>
              <option value="">Sélectionner un client</option>
            </select>
          </div>
          <div class="form-group">
            <label for="orderDate">Date de Commande *</label>
            <input type="date" id="orderDate" required />
          </div>

          <h4 style="margin: 1.5rem 0 1rem; color: var(--primary-color)">
            Articles de la Commande
          </h4>
          <div class="order-items-container" id="orderItemsContainer">
            <!-- Les articles seront ajoutés dynamiquement -->
          </div>

          <button type="button" class="add-item-btn" onclick="addOrderItem()">
            <i class="fas fa-plus"></i> Ajouter un article
          </button>

          <div class="form-group" style="margin-top: 1.5rem">
            <label for="orderStatus">Statut de la Commande</label>
            <select id="orderStatus">
              <option value="pending">En attente</option>
              <option value="processing">En traitement</option>
              <option value="delivered">Livré</option>
              <option value="cancelled">Annulé</option>
            </select>
          </div>

          <div
            style="
              background: var(--primary-light);
              padding: 1rem;
              border-radius: var(--radius);
              margin-top: 1.5rem;
            "
          >
            <div
              style="
                display: flex;
                justify-content: space-between;
                font-weight: 600;
              "
            >
              <span>Total:</span>
              <span id="orderTotal">0.00 DT</span>
            </div>
          </div>

          <div class="form-actions">
            <button type="button" class="btn btn-secondary close-modal">
              Annuler
            </button>
            <button type="submit" class="btn btn-primary">
              Enregistrer la Commande
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- MODAL DE PAIEMENT -->
    <div class="modal" id="paymentModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title" id="paymentModalTitle">Ajouter un paiement</h3>
          <button class="close-modal">&times;</button>
        </div>
        <form id="paymentForm">
          <input type="hidden" id="paymentId" />
          <div class="form-group">
            <label for="paymentClient">Client *</label>
            <select id="paymentClient" required>
              <option value="">Sélectionner un client</option>
            </select>
          </div>
          <div class="form-group">
            <label for="paymentOrder">Commande associée</label>
            <select id="paymentOrder">
              <option value="">Sélectionner une commande (optionnel)</option>
            </select>
          </div>
          <div class="form-group">
            <label for="paymentAmount">Montant (DT) *</label>
            <input
              type="number"
              id="paymentAmount"
              step="0.01"
              min="0"
              required
              placeholder="0.00"
            />
          </div>
          <div class="form-group">
            <label for="paymentMethod">Méthode de paiement *</label>
            <select id="paymentMethod" required>
              <option value="">Sélectionner</option>
              <option value="Carte Bancaire">Carte Bancaire</option>
              <option value="Espèces">Espèces</option>
              <option value="Virement Bancaire">Virement Bancaire</option>
              <option value="Paiement Mobile">Paiement Mobile</option>
              <option value="Chèque">Chèque</option>
            </select>
          </div>
          <div class="form-group">
            <label for="paymentDate">Date du paiement *</label>
            <input type="date" id="paymentDate" required />
          </div>
          <div class="form-group">
            <label for="paymentStatus">Statut *</label>
            <select id="paymentStatus" required>
              <option value="completed">Complété</option>
              <option value="pending">En attente</option>
              <option value="failed">Échoué</option>
              <option value="refunded">Remboursé</option>
            </select>
          </div>
          <div class="form-group">
            <label for="paymentReference">Référence</label>
            <input
              type="text"
              id="paymentReference"
              placeholder="Référence du paiement"
            />
          </div>
          <div class="form-actions">
            <button type="button" class="btn btn-secondary close-modal">
              Annuler
            </button>
            <button type="submit" class="btn btn-primary">Enregistrer</button>
          </div>
        </form>
      </div>
    </div>

    <!-- MODAL DE DÉTAILS DE COMMANDE -->
    <div class="modal" id="orderDetailsModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title">
            Détails de la Commande #<span id="detailsOrderId"></span>
          </h3>
          <button class="close-modal">&times;</button>
        </div>
        <div style="margin-bottom: 1.5rem">
          <div
            style="
              display: grid;
              grid-template-columns: 1fr 1fr;
              gap: 1rem;
              margin-bottom: 1rem;
            "
          >
            <div><strong>Client:</strong> <span id="detailsClient"></span></div>
            <div><strong>Date:</strong> <span id="detailsDate"></span></div>
            <div><strong>Statut:</strong> <span id="detailsStatus"></span></div>
            <div>
              <strong>Total:</strong> <span id="detailsTotal"></span> DT
            </div>
          </div>

          <h4 style="margin: 1rem 0; color: var(--primary-color)">Articles</h4>
          <div id="detailsItems" style="max-height: 300px; overflow-y: auto">
            <!-- Les articles seront affichés ici -->
          </div>
        </div>

        <div class="form-actions">
          <button type="button" class="btn btn-secondary close-modal">
            Fermer
          </button>
        </div>
      </div>
    </div>

    <script>
      // ==================== DONNÉES INITIALES ====================
      let clients = [
        {
          id: 1,
          name: "Ali Ben Salah",
          email: "ali@example.com",
          phone: "12345678",
          address: "Rue Habib Bourguiba, Tunis",
          city: "Tunis",
          orders: 5,
          createdAt: "2024-01-10",
        },
        {
          id: 2,
          name: "Fatma Trabelsi",
          email: "fatma@example.com",
          phone: "98765432",
          address: "Avenue Habib Thameur, Sfax",
          city: "Sfax",
          orders: 3,
          createdAt: "2024-01-12",
        },
        {
          id: 3,
          name: "Mohamed Amri",
          email: "mohamed@example.com",
          phone: "55667788",
          address: "Rue de la République, Sousse",
          city: "Sousse",
          orders: 7,
          createdAt: "2024-01-15",
        },
      ];

      let products = [
        {
          id: 1,
          name: "Croquettes Premium Chien",
          category: "Chien",
          price: 45.5,
          stock: 120,
          image:
            "https://images.unsplash.com/photo-1592924357228-91a4daadcfea?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
          description: "Croquettes premium pour chiens adultes - 10kg",
          createdAt: "2024-01-01",
        },
        {
          id: 2,
          name: "Pâtée Chat Adulte",
          category: "Chat",
          price: 12.9,
          stock: 80,
          image:
            "https://images.unsplash.com/photo-1574158622682-e40e69881006?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
          description: "Pâtée savoureuse pour chats adultes - Boîte de 12",
          createdAt: "2024-01-02",
        },
        {
          id: 3,
          name: "Graines pour Oiseaux",
          category: "Oiseau",
          price: 8.5,
          stock: 200,
          image:
            "https://images.unsplash.com/photo-1551085254-e96b210db58a?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
          description: "Mélange de graines pour oiseaux exotiques - 2kg",
          createdAt: "2024-01-03",
        },
        {
          id: 4,
          name: "Foin pour Rongeurs",
          category: "Rongeur",
          price: 6.9,
          stock: 150,
          image:
            "https://images.unsplash.com/photo-1597145128500-8c8489798a42?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
          description: "Foin frais pour lapins et rongeurs - 1kg",
          createdAt: "2024-01-04",
        },
        {
          id: 5,
          name: "Nourriture pour Poissons",
          category: "Poisson",
          price: 5.5,
          stock: 100,
          image:
            "https://images.unsplash.com/photo-1544551763-46a013bb70d5?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
          description: "Flocons pour poissons tropicaux - 200g",
          createdAt: "2024-01-05",
        },
      ];

      let orders = [
        {
          id: 1001,
          clientId: 1,
          clientName: "Ali Ben Salah",
          date: "2024-01-15",
          total: 89.5,
          status: "delivered",
          items: [
            {
              productId: 1,
              productName: "Croquettes Premium Chien",
              quantity: 2,
              price: 45.5,
              subtotal: 91,
            },
          ],
          createdAt: "2024-01-15",
        },
        {
          id: 1002,
          clientId: 2,
          clientName: "Fatma Trabelsi",
          date: "2024-01-16",
          total: 34.8,
          status: "processing",
          items: [
            {
              productId: 2,
              productName: "Pâtée Chat Adulte",
              quantity: 2,
              price: 12.9,
              subtotal: 25.8,
            },
            {
              productId: 3,
              productName: "Graines pour Oiseaux",
              quantity: 1,
              price: 8.5,
              subtotal: 8.5,
            },
          ],
          createdAt: "2024-01-16",
        },
        {
          id: 1003,
          clientId: 3,
          clientName: "Mohamed Amri",
          date: "2024-01-17",
          total: 156.2,
          status: "pending",
          items: [
            {
              productId: 1,
              productName: "Croquettes Premium Chien",
              quantity: 3,
              price: 45.5,
              subtotal: 136.5,
            },
            {
              productId: 4,
              productName: "Foin pour Rongeurs",
              quantity: 2,
              price: 6.9,
              subtotal: 13.8,
            },
          ],
          createdAt: "2024-01-17",
        },
      ];

      let payments = [
        {
          id: 1,
          clientId: 1,
          clientName: "Ali Ben Salah",
          orderId: 1001,
          amount: 89.5,
          method: "Carte Bancaire",
          date: "2024-01-15",
          status: "completed",
          reference: "PAY-001",
          createdAt: "2024-01-15",
        },
        {
          id: 2,
          clientId: 2,
          clientName: "Fatma Trabelsi",
          orderId: 1002,
          amount: 34.8,
          method: "Espèces",
          date: "2024-01-16",
          status: "completed",
          reference: "PAY-002",
          createdAt: "2024-01-16",
        },
        {
          id: 3,
          clientId: 3,
          clientName: "Mohamed Amri",
          orderId: 1003,
          amount: 156.2,
          method: "Virement Bancaire",
          date: "2024-01-17",
          status: "pending",
          reference: "PAY-003",
          createdAt: "2024-01-17",
        },
      ];

      // Données simplifiées pour les factures
      let invoices = [
        {
          id: 1,
          date: "2024-01-15",
          client: "Ali Ben Salah",
          amount: 89.5,
          description: "Facture pour commande #1001",
          status: "payée",
        },
        {
          id: 2,
          date: "2024-01-16",
          client: "Fatma Trabelsi",
          amount: 34.8,
          description: "Facture pour commande #1002",
          status: "payée",
        },
      ];

      let history = [
        {
          date: "2024-01-17 10:30",
          user: "EL Jezi Ghassen",
          action: "Ajout client",
          details: "Nouveau client: Sami Khemiri",
        },
        {
          date: "2024-01-17 09:15",
          user: "EL Jezi Ghassen",
          action: "Commande",
          details: "Commande #1003 créée",
        },
        {
          date: "2024-01-16 16:45",
          user: "EL Jezi Ghassen",
          action: "Mise à jour produit",
          details: "Stock mis à jour pour Croquettes Premium",
        },
      ];

      let notifications = [
        {
          id: 1,
          type: "success",
          message: "Nouvelle commande reçue #1005",
          time: "Il y a 10 minutes",
          read: false,
        },
        {
          id: 2,
          type: "warning",
          message: "Stock faible pour Pâtée Chat (15 restants)",
          time: "Il y a 2 heures",
          read: false,
        },
        {
          id: 3,
          type: "info",
          message: "Nouveau client inscrit: Leila Mansour",
          time: "Il y a 5 heures",
          read: false,
        },
      ];

      let currentOrderItems = [];

      // ==================== FONCTIONS UTILITAIRES ====================
      function getStatusText(status) {
        const statusMap = {
          pending: "En attente",
          processing: "En traitement",
          delivered: "Livré",
          cancelled: "Annulé",
          completed: "Complété",
          failed: "Échoué",
          refunded: "Remboursé",
        };
        return statusMap[status] || status;
      }

      function getStatusClass(status) {
        const classMap = {
          pending: "status-pending",
          processing: "status-processing",
          delivered: "status-delivered",
          cancelled: "status-pending",
          completed: "status-delivered",
          failed: "status-pending",
          refunded: "status-processing",
        };
        return classMap[status] || "status-pending";
      }

      function getCategoryColor(category) {
        const colors = {
          Chien: "#3498db",
          Chat: "#e74c3c",
          Oiseau: "#f39c12",
          Rongeur: "#2ecc71",
          Poisson: "#9b59b6",
          Autre: "#95a5a6",
        };
        return colors[category] || "#3498db";
      }

      function getPaymentMethodColor(method) {
        const colors = {
          "Carte Bancaire": "#3498db",
          Espèces: "#2ecc71",
          "Virement Bancaire": "#9b59b6",
          "Paiement Mobile": "#f39c12",
          Chèque: "#e74c3c",
        };
        return colors[method] || "#3498db";
      }

      function formatDate(dateString) {
        const date = new Date(dateString);
        return date.toLocaleDateString("fr-FR");
      }

      function formatDateTime(dateTimeString) {
        const date = new Date(dateTimeString);
        return date.toLocaleString("fr-FR");
      }

      // ==================== CRUD CLIENTS ====================
      function loadClients() {
        const tbody = document.getElementById("clients-table");
        tbody.innerHTML = "";

        clients.forEach((client) => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${client.id}</td>
            <td><strong>${client.name}</strong></td>
            <td>${client.email}</td>
            <td>${client.phone}</td>
            <td><span style="background: var(--primary-light); padding: 0.3rem 0.6rem; border-radius: 20px;">${client.city}</span></td>
            <td><span style="color: var(--primary-color); font-weight: bold;">${client.orders}</span></td>
            <td>
                <button class="action-btn" onclick="editClient(${client.id})" title="Modifier">
                    <i class="fas fa-edit"></i>
                </button>
                <button class="action-btn" onclick="deleteClient(${client.id})" title="Supprimer">
                    <i class="fas fa-trash"></i>
                </button>
            </td>
          `;
          tbody.appendChild(row);
        });

        updateClientsBadge();
        updateDashboardStats();
      }

      function openClientModal(clientId = null) {
        const modal = document.getElementById("clientModal");
        const title = document.getElementById("clientModalTitle");
        const form = document.getElementById("clientForm");

        if (clientId) {
          title.textContent = "Modifier le client";
          const client = clients.find((c) => c.id == clientId);
          if (client) {
            document.getElementById("clientId").value = client.id;
            document.getElementById("clientName").value = client.name;
            document.getElementById("clientEmail").value = client.email;
            document.getElementById("clientPhone").value = client.phone;
            document.getElementById("clientAddress").value = client.address || "";
            document.getElementById("clientCity").value = client.city;
          }
        } else {
          title.textContent = "Ajouter un client";
          form.reset();
          document.getElementById("clientId").value = "";
          document.getElementById("clientCity").value = "Tunis";
        }

        modal.style.display = "flex";
      }

      function saveClient(e) {
        e.preventDefault();

        const id = document.getElementById("clientId").value;
        const name = document.getElementById("clientName").value;
        const email = document.getElementById("clientEmail").value;
        const phone = document.getElementById("clientPhone").value;
        const address = document.getElementById("clientAddress").value;
        const city = document.getElementById("clientCity").value;

        if (id) {
          // Mise à jour
          const index = clients.findIndex((c) => c.id == id);
          clients[index] = {
            ...clients[index],
            name,
            email,
            phone,
            address,
            city,
          };
          addToHistory("Modification client", `Client ${name} modifié`);
          showNotification("success", `Client ${name} modifié avec succès`);
        } else {
          // Ajout
          const newId =
            clients.length > 0 ? Math.max(...clients.map((c) => c.id)) + 1 : 1;
          clients.push({
            id: newId,
            name,
            email,
            phone,
            address,
            city,
            orders: 0,
            createdAt: new Date().toISOString().split("T")[0],
          });
          addToHistory("Ajout client", `Nouveau client: ${name}`);
          showNotification("success", `Client ${name} ajouté avec succès`);
        }

        loadClients();
        closeAllModals();
        populateClientSelects();
      }

      function editClient(id) {
        openClientModal(id);
      }

      function deleteClient(id) {
        if (confirm("Êtes-vous sûr de vouloir supprimer ce client ?")) {
          const client = clients.find((c) => c.id == id);
          clients = clients.filter((c) => c.id != id);
          loadClients();
          addToHistory("Suppression client", `Client ${client.name} supprimé`);
          showNotification("warning", `Client ${client.name} supprimé`);
        }
      }

      // ==================== CRUD PRODUITS ====================
      function loadProducts() {
        const tbody = document.getElementById("products-table");
        tbody.innerHTML = "";

        products.forEach((product) => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td>
                <img src="${product.image}" alt="${product.name}" class="product-image" 
                     onerror="this.src='https://images.unsplash.com/photo-1541364983171-a8ba01e95cfc?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80'">
            </td>
            <td>
                <div class="product-card">
                    <div>
                        <strong>${product.name}</strong>
                        <div style="font-size: 0.9rem; color: var(--gray-color); margin-top: 0.2rem;">${product.description || ""}</div>
                    </div>
                </div>
            </td>
            <td>
                <span style="background: ${getCategoryColor(product.category)}; color: white; padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.9rem;">
                    ${product.category}
                </span>
            </td>
            <td><strong style="color: var(--primary-color);">${product.price.toFixed(2)} DT</strong></td>
            <td>
                <span style="color: ${product.stock < 50 ? "var(--accent-color)" : "var(--success-color)"}; font-weight: bold;">
                    ${product.stock} unités
                </span>
            </td>
            <td>
                <button class="action-btn" onclick="editProduct(${product.id})" title="Modifier">
                    <i class="fas fa-edit"></i>
                </button>
                <button class="action-btn" onclick="deleteProduct(${product.id})" title="Supprimer">
                    <i class="fas fa-trash"></i>
                </button>
            </td>
          `;
          tbody.appendChild(row);
        });
      }

      function openProductModal(productId = null) {
        const modal = document.getElementById("productModal");
        const title = document.getElementById("productModalTitle");
        const form = document.getElementById("productForm");

        if (productId) {
          title.textContent = "Modifier le produit";
          const product = products.find((p) => p.id == productId);
          if (product) {
            document.getElementById("productId").value = product.id;
            document.getElementById("productName").value = product.name;
            document.getElementById("productImage").value = product.image;
            document.getElementById("productCategory").value = product.category;
            document.getElementById("productPrice").value = product.price;
            document.getElementById("productStock").value = product.stock;
            document.getElementById("productDescription").value =
              product.description || "";
          }
        } else {
          title.textContent = "Ajouter un produit";
          form.reset();
          document.getElementById("productId").value = "";
          document.getElementById("productCategory").value = "";
          document.getElementById("productImage").value =
            "https://images.unsplash.com/photo-1592924357228-91a4daadcfea?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80";
        }

        modal.style.display = "flex";
      }

      function saveProduct(e) {
        e.preventDefault();

        const id = document.getElementById("productId").value;
        const name = document.getElementById("productName").value;
        const image =
          document.getElementById("productImage").value ||
          "https://images.unsplash.com/photo-1541364983171-a8ba01e95cfc?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80";
        const category = document.getElementById("productCategory").value;
        const price = parseFloat(document.getElementById("productPrice").value);
        const stock = parseInt(document.getElementById("productStock").value);
        const description = document.getElementById("productDescription").value;

        if (id) {
          // Mise à jour
          const index = products.findIndex((p) => p.id == id);
          products[index] = {
            ...products[index],
            name,
            image,
            category,
            price,
            stock,
            description,
          };
          addToHistory("Modification produit", `Produit ${name} modifié`);
          showNotification("success", `Produit ${name} modifié avec succès`);
        } else {
          // Ajout
          const newId =
            products.length > 0
              ? Math.max(...products.map((p) => p.id)) + 1
              : 1;
          products.push({
            id: newId,
            name,
            image,
            category,
            price,
            stock,
            description,
            createdAt: new Date().toISOString().split("T")[0],
          });
          addToHistory("Ajout produit", `Nouveau produit: ${name}`);
          showNotification("success", `Produit ${name} ajouté avec succès`);
        }

        loadProducts();
        closeAllModals();
      }

      function editProduct(id) {
        openProductModal(id);
      }

      function deleteProduct(id) {
        if (confirm("Êtes-vous sûr de vouloir supprimer ce produit ?")) {
          const product = products.find((p) => p.id == id);
          products = products.filter((p) => p.id != id);
          loadProducts();
          addToHistory("Suppression produit", `Produit ${product.name} supprimé`);
          showNotification("warning", `Produit ${product.name} supprimé`);
        }
      }

      // ==================== CRUD COMMANDES ====================
      function loadOrders() {
        const tbody = document.getElementById("orders-table");
        tbody.innerHTML = "";

        orders.forEach((order) => {
          const statusClass = getStatusClass(order.status);
          const statusText = getStatusText(order.status);

          const row = document.createElement("tr");
          row.innerHTML = `
            <td><strong style="color: var(--primary-color);">#${order.id}</strong></td>
            <td><strong>${order.clientName}</strong></td>
            <td>${formatDate(order.date)}</td>
            <td><strong style="color: var(--success-color);">${order.total.toFixed(2)} DT</strong></td>
            <td><span class="status ${statusClass}">${statusText}</span></td>
            <td>
                <button class="action-btn" onclick="viewOrderDetails(${order.id})" title="Voir détails">
                    <i class="fas fa-eye"></i>
                </button>
                <button class="action-btn" onclick="editOrder(${order.id})" title="Modifier">
                    <i class="fas fa-edit"></i>
                </button>
                <button class="action-btn" onclick="deleteOrder(${order.id})" title="Supprimer">
                    <i class="fas fa-trash"></i>
                </button>
            </td>
          `;
          tbody.appendChild(row);
        });

        updateOrdersBadge();
        updateDashboardStats();
      }

      function openOrderModal(orderId = null) {
        const modal = document.getElementById("orderModal");
        const title = document.getElementById("orderModalTitle");
        const form = document.getElementById("orderForm");

        // Remplir la liste des clients
        const clientSelect = document.getElementById("orderClient");
        clientSelect.innerHTML = '<option value="">Sélectionner un client</option>';
        clients.forEach((client) => {
          const option = document.createElement("option");
          option.value = client.id;
          option.textContent = client.name;
          clientSelect.appendChild(option);
        });

        if (orderId) {
          title.textContent = "Modifier la commande";
          const order = orders.find((o) => o.id == orderId);
          if (order) {
            document.getElementById("orderId").value = order.id;
            document.getElementById("orderClient").value = order.clientId;
            document.getElementById("orderDate").value = order.date;
            document.getElementById("orderStatus").value = order.status;

            currentOrderItems = [...order.items];
            renderOrderItems();
            updateOrderTotal();
          }
        } else {
          title.textContent = "Nouvelle commande";
          form.reset();
          document.getElementById("orderId").value = "";
          document.getElementById("orderDate").value = new Date()
            .toISOString()
            .split("T")[0];
          document.getElementById("orderStatus").value = "pending";

          currentOrderItems = [];
          document.getElementById("orderItemsContainer").innerHTML = "";
          document.getElementById("orderTotal").textContent = "0.00 DT";
        }

        modal.style.display = "flex";
      }

      function addOrderItem() {
        const item = {
          id: Date.now(),
          productId: "",
          productName: "",
          quantity: 1,
          price: 0,
          subtotal: 0,
        };

        currentOrderItems.push(item);
        renderOrderItems();
        updateOrderTotal();
      }

      function removeOrderItem(itemId) {
        currentOrderItems = currentOrderItems.filter(
          (item) => item.id !== itemId,
        );
        renderOrderItems();
        updateOrderTotal();
      }

      function updateOrderItem(itemId, field, value) {
        const item = currentOrderItems.find((item) => item.id === itemId);
        if (item) {
          item[field] = value;

          if (field === "productId") {
            const product = products.find((p) => p.id == value);
            if (product) {
              item.productName = product.name;
              item.price = product.price;
              item.subtotal = item.quantity * product.price;
            }
          } else if (field === "quantity") {
            item.quantity = parseInt(value) || 1;
            item.subtotal = item.quantity * item.price;
          }

          updateOrderTotal();
        }
      }

      function renderOrderItems() {
        const container = document.getElementById("orderItemsContainer");
        container.innerHTML = "";

        currentOrderItems.forEach((item) => {
          const itemDiv = document.createElement("div");
          itemDiv.className = "order-item";
          itemDiv.innerHTML = `
            <div style="flex: 1;">
                <select onchange="updateOrderItem(${item.id}, 'productId', this.value)" style="width: 100%;">
                    <option value="">Sélectionner un produit</option>
                    ${products
                      .map(
                        (p) => `
                        <option value="${p.id}" ${p.id == item.productId ? "selected" : ""}>
                            ${p.name} - ${p.price.toFixed(2)} DT
                        </option>
                    `,
                      )
                      .join("")}
                </select>
            </div>
            <div class="item-controls">
                <input type="number" 
                       class="item-quantity" 
                       value="${item.quantity}" 
                       min="1" 
                       onchange="updateOrderItem(${item.id}, 'quantity', this.value)">
                <span>${item.subtotal.toFixed(2)} DT</span>
                <button class="action-btn" onclick="removeOrderItem(${item.id})" title="Supprimer">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
          `;
          container.appendChild(itemDiv);
        });
      }

      function updateOrderTotal() {
        const total = currentOrderItems.reduce(
          (sum, item) => sum + item.subtotal,
          0,
        );
        document.getElementById("orderTotal").textContent =
          total.toFixed(2) + " DT";
      }

      function saveOrder(e) {
        e.preventDefault();

        const orderId = document.getElementById("orderId").value;
        const clientId = document.getElementById("orderClient").value;
        const date = document.getElementById("orderDate").value;
        const status = document.getElementById("orderStatus").value;

        if (!clientId) {
          alert("Veuillez sélectionner un client");
          return;
        }

        if (currentOrderItems.length === 0) {
          alert("Veuillez ajouter au moins un article à la commande");
          return;
        }

        const client = clients.find((c) => c.id == clientId);
        const total = currentOrderItems.reduce(
          (sum, item) => sum + item.subtotal,
          0,
        );

        if (orderId) {
          // Mise à jour
          const index = orders.findIndex((o) => o.id == orderId);
          orders[index] = {
            ...orders[index],
            clientId,
            clientName: client.name,
            date,
            total,
            status,
            items: [...currentOrderItems],
          };
          addToHistory(
            "Modification commande",
            `Commande #${orderId} modifiée`,
          );
          showNotification("success", `Commande #${orderId} modifiée avec succès`);
        } else {
          // Ajout
          const newId =
            orders.length > 0 ? Math.max(...orders.map((o) => o.id)) + 1 : 1001;
          orders.push({
            id: newId,
            clientId,
            clientName: client.name,
            date,
            total,
            status,
            items: [...currentOrderItems],
            createdAt: new Date().toISOString().split("T")[0],
          });
          addToHistory("Ajout commande", `Nouvelle commande #${newId} créée`);
          showNotification("success", `Commande #${newId} créée avec succès`);
        }

        loadOrders();
        loadRecentActivity();
        closeAllModals();
        updateDashboardStats();
      }

      function editOrder(orderId) {
        openOrderModal(orderId);
      }

      function deleteOrder(orderId) {
        if (confirm("Êtes-vous sûr de vouloir supprimer cette commande ?")) {
          const order = orders.find((o) => o.id == orderId);
          orders = orders.filter((o) => o.id != orderId);
          loadOrders();
          addToHistory(
            "Suppression commande",
            `Commande #${orderId} supprimée`,
          );
          showNotification("warning", `Commande #${orderId} supprimée`);
        }
      }

      function viewOrderDetails(orderId) {
        const order = orders.find((o) => o.id == orderId);
        if (!order) return;

        document.getElementById("detailsOrderId").textContent = order.id;
        document.getElementById("detailsClient").textContent = order.clientName;
        document.getElementById("detailsDate").textContent = formatDate(
          order.date,
        );
        document.getElementById("detailsStatus").innerHTML =
          `<span class="status ${getStatusClass(order.status)}">${getStatusText(order.status)}</span>`;
        document.getElementById("detailsTotal").textContent =
          order.total.toFixed(2);

        const itemsContainer = document.getElementById("detailsItems");
        itemsContainer.innerHTML = "";

        order.items.forEach((item) => {
          const itemDiv = document.createElement("div");
          itemDiv.className = "order-item";
          itemDiv.innerHTML = `
            <div style="flex: 1;">
                <strong>${item.productName}</strong>
            </div>
            <div>
                ${item.quantity} × ${item.price.toFixed(2)} DT = ${item.subtotal.toFixed(2)} DT
            </div>
          `;
          itemsContainer.appendChild(itemDiv);
        });

        document.getElementById("orderDetailsModal").style.display = "flex";
      }

      // ==================== CRUD PAIEMENTS ====================
      function loadPayments() {
        const tbody = document.getElementById("payments-table");
        tbody.innerHTML = "";

        payments.forEach((payment) => {
          const statusClass = getStatusClass(payment.status);
          const statusText = getStatusText(payment.status);

          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${payment.id}</td>
            <td><strong>${payment.clientName}</strong></td>
            <td><strong style="color: var(--primary-color);">${payment.amount.toFixed(2)} DT</strong></td>
            <td>
                <span style="background: ${getPaymentMethodColor(payment.method)}; color: white; padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.9rem;">
                    ${payment.method}
                </span>
            </td>
            <td>${formatDate(payment.date)}</td>
            <td><span class="status ${statusClass}">${statusText}</span></td>
            <td>
                <button class="action-btn" onclick="editPayment(${payment.id})" title="Modifier">
                    <i class="fas fa-edit"></i>
                </button>
                <button class="action-btn" onclick="deletePayment(${payment.id})" title="Supprimer">
                    <i class="fas fa-trash"></i>
                </button>
            </td>
          `;
          tbody.appendChild(row);
        });
      }

      function openPaymentModal(paymentId = null) {
        const modal = document.getElementById("paymentModal");
        const title = document.getElementById("paymentModalTitle");
        const form = document.getElementById("paymentForm");

        // Remplir la liste des clients
        const clientSelect = document.getElementById("paymentClient");
        clientSelect.innerHTML = '<option value="">Sélectionner un client</option>';
        clients.forEach((client) => {
          const option = document.createElement("option");
          option.value = client.id;
          option.textContent = client.name;
          clientSelect.appendChild(option);
        });

        // Remplir la liste des commandes
        const orderSelect = document.getElementById("paymentOrder");
        orderSelect.innerHTML =
          '<option value="">Sélectionner une commande (optionnel)</option>';
        orders.forEach((order) => {
          const option = document.createElement("option");
          option.value = order.id;
          option.textContent = `Commande #${order.id} - ${order.clientName} - ${order.total.toFixed(2)} DT`;
          orderSelect.appendChild(option);
        });

        if (paymentId) {
          title.textContent = "Modifier le paiement";
          const payment = payments.find((p) => p.id == paymentId);
          if (payment) {
            document.getElementById("paymentId").value = payment.id;
            document.getElementById("paymentClient").value = payment.clientId;
            document.getElementById("paymentOrder").value = payment.orderId || "";
            document.getElementById("paymentAmount").value = payment.amount;
            document.getElementById("paymentMethod").value = payment.method;
            document.getElementById("paymentDate").value = payment.date;
            document.getElementById("paymentStatus").value = payment.status;
            document.getElementById("paymentReference").value =
              payment.reference || "";
          }
        } else {
          title.textContent = "Ajouter un paiement";
          form.reset();
          document.getElementById("paymentId").value = "";
          document.getElementById("paymentDate").value = new Date()
            .toISOString()
            .split("T")[0];
          document.getElementById("paymentStatus").value = "completed";
          document.getElementById("paymentMethod").value = "";
        }

        modal.style.display = "flex";
      }

      function savePayment(e) {
        e.preventDefault();

        const id = document.getElementById("paymentId").value;
        const clientId = document.getElementById("paymentClient").value;
        const orderId = document.getElementById("paymentOrder").value;
        const amount = parseFloat(document.getElementById("paymentAmount").value);
        const method = document.getElementById("paymentMethod").value;
        const date = document.getElementById("paymentDate").value;
        const status = document.getElementById("paymentStatus").value;
        const reference = document.getElementById("paymentReference").value;

        if (!clientId) {
          alert("Veuillez sélectionner un client");
          return;
        }

        const client = clients.find((c) => c.id == clientId);

        if (id) {
          // Mise à jour
          const index = payments.findIndex((p) => p.id == id);
          payments[index] = {
            ...payments[index],
            clientId,
            clientName: client.name,
            orderId: orderId || null,
            amount,
            method,
            date,
            status,
            reference,
          };
          addToHistory("Modification paiement", `Paiement #${id} modifié`);
          showNotification("success", `Paiement #${id} modifié avec succès`);
        } else {
          // Ajout
          const newId =
            payments.length > 0
              ? Math.max(...payments.map((p) => p.id)) + 1
              : 1;
          payments.push({
            id: newId,
            clientId,
            clientName: client.name,
            orderId: orderId || null,
            amount,
            method,
            date,
            status,
            reference: reference || `PAY-${newId.toString().padStart(3, "0")}`,
            createdAt: new Date().toISOString().split("T")[0],
          });
          addToHistory("Ajout paiement", `Nouveau paiement #${newId}`);
          showNotification("success", `Paiement #${newId} ajouté avec succès`);
        }

        loadPayments();
        closeAllModals();
      }

      function editPayment(id) {
        openPaymentModal(id);
      }

      function deletePayment(id) {
        if (confirm("Êtes-vous sûr de vouloir supprimer ce paiement ?")) {
          const payment = payments.find((p) => p.id == id);
          payments = payments.filter((p) => p.id != id);
          loadPayments();
          addToHistory("Suppression paiement", `Paiement #${id} supprimé`);
          showNotification("warning", `Paiement #${id} supprimé`);
        }
      }

      // ==================== FONCTIONS SIMPLIFIÉES POUR LES FACTURES ====================
      function loadInvoices() {
        const tbody = document.getElementById("invoices-table");
        tbody.innerHTML = "";

        invoices.forEach((invoice) => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td>#${invoice.id}</td>
            <td>${invoice.date}</td>
            <td><strong>${invoice.client}</strong></td>
            <td><strong style="color: var(--primary-color);">${invoice.amount.toFixed(2)} DT</strong></td>
            <td>${invoice.description || "-"}</td>
            <td><span style="color: var(--success-color); font-weight: 600;">${invoice.status}</span></td>
          `;
          tbody.appendChild(row);
        });
      }

      function createSimpleInvoice() {
        const client = document.getElementById("simpleInvoiceClient").value;
        const amount = document.getElementById("simpleInvoiceAmount").value;
        const description = document.getElementById("simpleInvoiceDescription").value;

        if (!client || !amount) {
          alert("Veuillez saisir le nom du client et le montant");
          return;
        }

        const newId = invoices.length > 0 ? Math.max(...invoices.map(i => i.id)) + 1 : 1;
        
        invoices.unshift({
          id: newId,
          date: new Date().toISOString().split('T')[0],
          client,
          amount: parseFloat(amount),
          description: description || "Facture simple",
          status: "créée"
        });

        loadInvoices();
        
        // Afficher une notification
        showNotification("success", `Facture #${newId} créée pour ${client}`);
        
        // Réinitialiser le formulaire
        clearSimpleInvoice();
        
        // Ajouter à l'historique
        addToHistory("Création facture", `Facture #${newId} pour ${client}`);
      }

      function clearSimpleInvoice() {
        document.getElementById("simpleInvoiceClient").value = "";
        document.getElementById("simpleInvoiceAmount").value = "";
        document.getElementById("simpleInvoiceDescription").value = "";
      }

      // ==================== FONCTIONS AUTRES ====================
      function populateClientSelects() {
        const selects = document.querySelectorAll("select[id*='Client']");
        selects.forEach((select) => {
          if (select.id !== "paymentClient" && select.id !== "orderClient")
            return;
          const currentValue = select.value;
          select.innerHTML = '<option value="">Sélectionner un client</option>';
          clients.forEach((client) => {
            const option = document.createElement("option");
            option.value = client.id;
            option.textContent = client.name;
            select.appendChild(option);
          });
          select.value = currentValue;
        });
      }

      function loadRecentActivity() {
        const tbody = document.getElementById("recent-activity");
        tbody.innerHTML = "";

        const recentOrders = orders.slice(0, 5);

        recentOrders.forEach((order) => {
          const statusClass = getStatusClass(order.status);
          const statusText = getStatusText(order.status);
          const firstItem =
            order.items.length > 0 ? order.items[0].productName : "N/A";

          const row = document.createElement("tr");
          row.innerHTML = `
            <td><strong>${order.clientName}</strong></td>
            <td>${firstItem}</td>
            <td>${formatDate(order.date)}</td>
            <td><strong style="color: var(--primary-color);">${order.total.toFixed(2)} DT</strong></td>
            <td><span class="status ${statusClass}">${statusText}</span></td>
          `;
          tbody.appendChild(row);
        });
      }

      function loadHistory() {
        const tbody = document.getElementById("history-table");
        tbody.innerHTML = "";

        history.forEach((item) => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td><span style="color: var(--primary-color);">${item.date}</span></td>
            <td><strong>${item.user}</strong></td>
            <td><span style="background: var(--primary-light); padding: 0.3rem 0.8rem; border-radius: 20px;">${item.action}</span></td>
            <td>${item.details}</td>
          `;
          tbody.appendChild(row);
        });
      }

      function updateDashboardStats() {
        const todayOrders = orders.filter(
          (o) => o.date === new Date().toISOString().split("T")[0],
        ).length;
        const pendingOrders = orders.filter(
          (o) => o.status === "pending",
        ).length;
        const totalClients = clients.length;
        const monthRevenue = orders
          .filter((o) => {
            const orderDate = new Date(o.date);
            const now = new Date();
            return (
              orderDate.getMonth() === now.getMonth() &&
              orderDate.getFullYear() === now.getFullYear()
            );
          })
          .reduce((sum, o) => sum + o.total, 0);

        document.getElementById("today-orders").textContent = todayOrders;
        document.getElementById("pending-orders").textContent = pendingOrders;
        document.getElementById("total-clients").textContent = totalClients;
        document.getElementById("month-revenue").textContent =
          monthRevenue.toFixed(1);

        // Mettre à jour les cartes du dashboard
        document.querySelector(".card:nth-child(1) .card-value").textContent =
          totalClients;
        document.querySelector(".card:nth-child(2) .card-value").textContent =
          todayOrders;
        document.querySelector(".card:nth-child(3) .card-value").textContent =
          monthRevenue.toFixed(1) + " DT";
      }

      function updateClientsBadge() {
        const newClients = clients.filter(
          (c) =>
            new Date(c.createdAt).toDateString() ===
            new Date().toDateString(),
        ).length;
        document.getElementById("clients-badge").textContent = newClients;
        document.getElementById("clients-badge").style.display =
          newClients > 0 ? "flex" : "none";
      }

      function updateOrdersBadge() {
        const pendingOrders = orders.filter(
          (o) => o.status === "pending",
        ).length;
        document.getElementById("orders-badge").textContent = pendingOrders;
        document.getElementById("orders-badge").style.display =
          pendingOrders > 0 ? "flex" : "none";
      }

      function addToHistory(action, details) {
        const now = new Date();
        const date = now.toISOString().split("T")[0];
        const time = now.toLocaleTimeString("fr-FR", {
          hour: "2-digit",
          minute: "2-digit",
        });

        history.unshift({
          date: `${date} ${time}`,
          user: "EL Jezi Ghassen",
          action,
          details,
        });

        loadHistory();
      }

      function showNotification(type, message) {
        const now = new Date();
        const time = now.toLocaleTimeString("fr-FR", {
          hour: "2-digit",
          minute: "2-digit",
        });

        notifications.unshift({
          id: notifications.length + 1,
          type,
          message,
          time: `À ${time}`,
          read: false,
        });

        updateNotificationCount();
      }

      function updateNotificationCount() {
        const unreadCount = notifications.filter((n) => !n.read).length;
        const badge = document.getElementById("notification-count");
        badge.textContent = unreadCount;
        badge.style.display = unreadCount > 0 ? "flex" : "none";
      }

      // ==================== INITIALISATION ====================
      document.addEventListener("DOMContentLoaded", function () {
        // Initialiser les données
        loadClients();
        loadProducts();
        loadOrders();
        loadPayments();
        loadInvoices();
        loadHistory();
        loadRecentActivity();
        updateDashboardStats();
        populateClientSelects();

        // Navigation
        document.querySelectorAll(".nav-link").forEach((link) => {
          link.addEventListener("click", function (e) {
            e.preventDefault();
            const tabId = this.getAttribute("data-tab");

            document
              .querySelectorAll(".nav-link")
              .forEach((l) => l.classList.remove("active"));
            this.classList.add("active");

            document.querySelectorAll(".tab-content").forEach((tab) => {
              tab.classList.remove("active");
            });
            document.getElementById(tabId).classList.add("active");
          });
        });

        // Boutons d'ajout
        document
          .getElementById("addClientBtn")
          .addEventListener("click", () => openClientModal());
        document
          .getElementById("addProductBtn")
          .addEventListener("click", () => openProductModal());
        document
          .getElementById("addOrderBtn")
          .addEventListener("click", () => openOrderModal());
        document
          .getElementById("addPaymentBtn")
          .addEventListener("click", () => openPaymentModal());

        // Fermer les modales
        document.querySelectorAll(".close-modal").forEach((btn) => {
          btn.addEventListener("click", closeAllModals);
        });

        // Fermer modales en cliquant à l'extérieur
        document.querySelectorAll(".modal").forEach((modal) => {
          modal.addEventListener("click", function (e) {
            if (e.target === this) closeAllModals();
          });
        });

        // Gestion des formulaires
        document
          .getElementById("clientForm")
          .addEventListener("submit", saveClient);
        document
          .getElementById("productForm")
          .addEventListener("submit", saveProduct);
        document
          .getElementById("orderForm")
          .addEventListener("submit", saveOrder);
        document
          .getElementById("paymentForm")
          .addEventListener("submit", savePayment);

        // Initialiser la date du jour dans les formulaires
        const today = new Date().toISOString().split("T")[0];
        document.getElementById("orderDate").value = today;
        document.getElementById("paymentDate").value = today;

        // Dark mode toggle
        const darkModeToggle = document.getElementById("darkModeToggle");
        if (darkModeToggle) {
          darkModeToggle.addEventListener("click", toggleDarkMode);
        }
      });

      function closeAllModals() {
        document.querySelectorAll(".modal").forEach((modal) => {
          modal.style.display = "none";
        });

        document.querySelectorAll("form").forEach((form) => form.reset());
        currentOrderItems = [];
      }

      function toggleDarkMode() {
        document.body.classList.toggle("dark-mode");
        localStorage.setItem(
          "theme",
          document.body.classList.contains("dark-mode") ? "dark" : "light",
        );
      }

      // Initialiser le dark mode
      if (localStorage.getItem("theme") === "dark") {
        document.body.classList.add("dark-mode");
      }

      // ==================== FONCTIONS GLOBALES ====================
      window.editClient = editClient;
      window.deleteClient = deleteClient;
      window.editProduct = editProduct;
      window.deleteProduct = deleteProduct;
      window.editOrder = editOrder;
      window.deleteOrder = deleteOrder;
      window.viewOrderDetails = viewOrderDetails;
      window.addOrderItem = addOrderItem;
      window.removeOrderItem = removeOrderItem;
      window.updateOrderItem = updateOrderItem;
      window.editPayment = editPayment;
      window.deletePayment = deletePayment;
      window.toggleDarkMode = toggleDarkMode;
      window.createSimpleInvoice = createSimpleInvoice;
      window.clearSimpleInvoice = clearSimpleInvoice;
    </script>
  </body>
</html>
